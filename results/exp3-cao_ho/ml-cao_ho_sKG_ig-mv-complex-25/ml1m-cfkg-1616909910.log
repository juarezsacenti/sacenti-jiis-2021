2021-03-28 02:38:30,009 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 97600,
    "embedding_size": 100,
    "eval_interval_steps": 19520,
    "eval_only_mode": false,
    "experiment_name": "ml1m-cfkg-1616909910",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.005,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/ml1m-bprmf-pretrained.ckpt:/home/juarez/git/results/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "cfkg",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 0,
    "share_embeddings": true,
    "topn": 10,
    "training_steps": 1952000,
    "use_st_gumbel": true,
    "visualization_port": 8097
}
2021-03-28 02:38:31,728 - root - INFO - Totally 701669 train ratings, 103239,193631 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/cao-format/ml1m/test.dat!
2021-03-28 02:38:31,736 - root - INFO - successfully load 6040 users and 3260 items!
2021-03-28 02:38:33,440 - root - INFO - Totally 217086 train triples, 30987,61963 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/cao-format/ml1m/kg/test.dat!
2021-03-28 02:38:33,448 - root - INFO - successfully load 7979 entities and 20 relations!
2021-03-28 02:38:33,661 - root - INFO - Find 2932 aligned items and entities!
2021-03-28 02:38:33,661 - root - INFO - Building model.
2021-03-28 02:38:35,157 - root - INFO - Architecture: CFKG(
  (user_embeddings): Embedding(6040, 100)
  (ent_embeddings): Embedding(8307, 100)
  (rel_embeddings): Embedding(21, 100)
  (item_embeddings): Embedding(8307, 100)
)
2021-03-28 02:38:35,157 - root - INFO - Total params: 1436800.0
2021-03-28 02:38:35,157 - root - INFO - One epoch is 5482 steps.
2021-03-28 02:38:35,158 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-28 02:38:35,231 - root - INFO - Restored 7979 entities from checkpoint.
2021-03-28 02:38:35,259 - root - INFO - Restored 3260 items from checkpoint.
2021-03-28 02:38:35,260 - root - INFO - Load Embeddings of user_embeddings.weight, item_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/ml1m-bprmf-pretrained.ckpt.
2021-03-28 02:38:35,260 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-28 02:38:35,265 - root - INFO - Restored 20 relations from checkpoint.
2021-03-28 02:38:35,333 - root - INFO - Restored 7979 entities from checkpoint.
2021-03-28 02:38:35,360 - root - INFO - Restored 3260 items from checkpoint.
2021-03-28 02:38:35,361 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp3/ml-cao_ho_sKG_ig-mv-complex-25/ml1m-transe-pretrained.ckpt.
2021-03-28 02:38:35,361 - root - INFO - Training.
2021-03-28 02:38:35,361 - root - INFO - rec train loss:0.0000, kg train loss:0.0000!
2021-03-28 02:38:43,628 - root - INFO - f1:0.0033, p:0.0060, r:0.0029, hit:0.0575, ndcg:0.0296, topn:10.
2021-03-28 02:38:53,095 - root - INFO - f1:0.0034, p:0.0103, r:0.0026, hit:0.0924, ndcg:0.0495, topn:10.
2021-03-28 02:39:31,039 - root - INFO - head hit:0.0099, head mean rank:3106.6086, topn:10.
2021-03-28 02:39:31,039 - root - INFO - tail hit:0.0435, tail mean rank:2355.8030, topn:10.
2021-03-28 02:39:31,039 - root - INFO - avg hit:0.0267, avg mean rank:2731.2058, topn:10.
2021-03-28 02:40:23,054 - root - INFO - head hit:0.0096, head mean rank:3119.9049, topn:10.
2021-03-28 02:40:23,055 - root - INFO - tail hit:0.0428, tail mean rank:2349.8430, topn:10.
2021-03-28 02:40:23,055 - root - INFO - avg hit:0.0262, avg mean rank:2734.8740, topn:10.
2021-03-28 02:42:54,228 - root - INFO - rec train loss:34.9724, kg train loss:139.5094!
2021-03-28 02:43:03,463 - root - INFO - f1:0.0386, p:0.0619, r:0.0385, hit:0.3861, ndcg:0.2156, topn:10.
2021-03-28 02:43:12,104 - root - INFO - f1:0.0451, p:0.1054, r:0.0378, hit:0.5233, ndcg:0.2974, topn:10.
2021-03-28 02:43:49,148 - root - INFO - head hit:0.0153, head mean rank:1722.1134, topn:10.
2021-03-28 02:43:49,148 - root - INFO - tail hit:0.0392, tail mean rank:1449.1271, topn:10.
2021-03-28 02:43:49,148 - root - INFO - avg hit:0.0272, avg mean rank:1585.6202, topn:10.
2021-03-28 02:44:39,809 - root - INFO - head hit:0.0162, head mean rank:1729.7785, topn:10.
2021-03-28 02:44:39,809 - root - INFO - tail hit:0.0398, tail mean rank:1454.4887, topn:10.
2021-03-28 02:44:39,810 - root - INFO - avg hit:0.0280, avg mean rank:1592.1336, topn:10.
2021-03-28 02:44:39,836 - root - INFO - Checkpointing ...
2021-03-28 02:47:09,895 - root - INFO - rec train loss:34.7272, kg train loss:138.6947!
2021-03-28 02:47:18,669 - root - INFO - f1:0.0445, p:0.0699, r:0.0454, hit:0.4182, ndcg:0.2348, topn:10.
2021-03-28 02:47:28,836 - root - INFO - f1:0.0520, p:0.1182, r:0.0444, hit:0.5629, ndcg:0.3280, topn:10.
2021-03-28 02:48:05,628 - root - INFO - head hit:0.0185, head mean rank:1778.7422, topn:10.
2021-03-28 02:48:05,629 - root - INFO - tail hit:0.0456, tail mean rank:1431.4362, topn:10.
2021-03-28 02:48:05,629 - root - INFO - avg hit:0.0320, avg mean rank:1605.0892, topn:10.
2021-03-28 02:48:57,553 - root - INFO - head hit:0.0182, head mean rank:1770.1966, topn:10.
2021-03-28 02:48:57,553 - root - INFO - tail hit:0.0455, tail mean rank:1448.9769, topn:10.
2021-03-28 02:48:57,553 - root - INFO - avg hit:0.0318, avg mean rank:1609.5867, topn:10.
2021-03-28 02:48:57,583 - root - INFO - Checkpointing ...
2021-03-28 02:51:26,934 - root - INFO - rec train loss:34.5186, kg train loss:138.3668!
2021-03-28 02:51:36,819 - root - INFO - f1:0.0519, p:0.0787, r:0.0537, hit:0.4591, ndcg:0.2636, topn:10.
2021-03-28 02:51:45,602 - root - INFO - f1:0.0587, p:0.1296, r:0.0510, hit:0.5959, ndcg:0.3545, topn:10.
2021-03-28 02:52:23,649 - root - INFO - head hit:0.0171, head mean rank:1754.9674, topn:10.
2021-03-28 02:52:23,650 - root - INFO - tail hit:0.0448, tail mean rank:1412.4636, topn:10.
2021-03-28 02:52:23,650 - root - INFO - avg hit:0.0309, avg mean rank:1583.7155, topn:10.
2021-03-28 02:53:15,226 - root - INFO - head hit:0.0174, head mean rank:1756.6614, topn:10.
2021-03-28 02:53:15,226 - root - INFO - tail hit:0.0442, tail mean rank:1423.4829, topn:10.
2021-03-28 02:53:15,226 - root - INFO - avg hit:0.0308, avg mean rank:1590.0722, topn:10.
2021-03-28 02:53:15,257 - root - INFO - Checkpointing ...
2021-03-28 02:55:43,401 - root - INFO - rec train loss:34.6208, kg train loss:138.3500!
2021-03-28 02:55:52,361 - root - INFO - f1:0.0522, p:0.0830, r:0.0528, hit:0.4647, ndcg:0.2744, topn:10.
2021-03-28 02:56:01,420 - root - INFO - f1:0.0592, p:0.1347, r:0.0506, hit:0.6045, ndcg:0.3718, topn:10.
2021-03-28 02:56:38,282 - root - INFO - head hit:0.0168, head mean rank:1748.1569, topn:10.
2021-03-28 02:56:38,282 - root - INFO - tail hit:0.0406, tail mean rank:1473.2616, topn:10.
2021-03-28 02:56:38,283 - root - INFO - avg hit:0.0287, avg mean rank:1610.7093, topn:10.
2021-03-28 02:57:30,976 - root - INFO - head hit:0.0167, head mean rank:1731.7921, topn:10.
2021-03-28 02:57:30,976 - root - INFO - tail hit:0.0409, tail mean rank:1477.5548, topn:10.
2021-03-28 02:57:30,976 - root - INFO - avg hit:0.0288, avg mean rank:1604.6735, topn:10.
2021-03-28 02:57:31,007 - root - INFO - Checkpointing ...
2021-03-28 03:00:03,617 - root - INFO - rec train loss:34.5400, kg train loss:138.1518!
2021-03-28 03:00:12,106 - root - INFO - f1:0.0509, p:0.0796, r:0.0522, hit:0.4609, ndcg:0.2593, topn:10.
2021-03-28 03:00:21,499 - root - INFO - f1:0.0573, p:0.1307, r:0.0489, hit:0.5916, ndcg:0.3475, topn:10.
2021-03-28 03:00:58,461 - root - INFO - head hit:0.0190, head mean rank:1744.8657, topn:10.
2021-03-28 03:00:58,461 - root - INFO - tail hit:0.0408, tail mean rank:1493.1181, topn:10.
2021-03-28 03:00:58,461 - root - INFO - avg hit:0.0299, avg mean rank:1618.9919, topn:10.
2021-03-28 03:01:50,659 - root - INFO - head hit:0.0186, head mean rank:1730.4180, topn:10.
2021-03-28 03:01:50,660 - root - INFO - tail hit:0.0409, tail mean rank:1479.2814, topn:10.
2021-03-28 03:01:50,660 - root - INFO - avg hit:0.0298, avg mean rank:1604.8497, topn:10.
2021-03-28 03:01:50,694 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 03:04:23,623 - root - INFO - rec train loss:16.2916, kg train loss:64.3327!
2021-03-28 03:04:33,155 - root - INFO - f1:0.0659, p:0.1043, r:0.0664, hit:0.5286, ndcg:0.3229, topn:10.
2021-03-28 03:04:41,832 - root - INFO - f1:0.0741, p:0.1675, r:0.0634, hit:0.6657, ndcg:0.4230, topn:10.
2021-03-28 03:05:17,402 - root - INFO - head hit:0.0410, head mean rank:1083.5652, topn:10.
2021-03-28 03:05:17,402 - root - INFO - tail hit:0.0919, tail mean rank:847.7412, topn:10.
2021-03-28 03:05:17,402 - root - INFO - avg hit:0.0665, avg mean rank:965.6532, topn:10.
2021-03-28 03:06:08,461 - root - INFO - head hit:0.0408, head mean rank:1077.9598, topn:10.
2021-03-28 03:06:08,461 - root - INFO - tail hit:0.0895, tail mean rank:844.2030, topn:10.
2021-03-28 03:06:08,461 - root - INFO - avg hit:0.0652, avg mean rank:961.0814, topn:10.
2021-03-28 03:06:08,494 - root - INFO - Checkpointing ...
2021-03-28 03:08:41,567 - root - INFO - rec train loss:15.2730, kg train loss:60.7700!
2021-03-28 03:08:50,184 - root - INFO - f1:0.0703, p:0.1107, r:0.0713, hit:0.5558, ndcg:0.3502, topn:10.
2021-03-28 03:08:59,752 - root - INFO - f1:0.0770, p:0.1742, r:0.0662, hit:0.6725, ndcg:0.4322, topn:10.
2021-03-28 03:09:35,124 - root - INFO - head hit:0.0404, head mean rank:1097.0142, topn:10.
2021-03-28 03:09:35,125 - root - INFO - tail hit:0.0826, tail mean rank:838.0875, topn:10.
2021-03-28 03:09:35,125 - root - INFO - avg hit:0.0615, avg mean rank:967.5508, topn:10.
2021-03-28 03:10:24,818 - root - INFO - head hit:0.0403, head mean rank:1098.8144, topn:10.
2021-03-28 03:10:24,818 - root - INFO - tail hit:0.0830, tail mean rank:840.9368, topn:10.
2021-03-28 03:10:24,819 - root - INFO - avg hit:0.0617, avg mean rank:969.8756, topn:10.
2021-03-28 03:10:24,850 - root - INFO - Checkpointing ...
2021-03-28 03:12:56,683 - root - INFO - rec train loss:15.2869, kg train loss:60.5906!
2021-03-28 03:13:06,158 - root - INFO - f1:0.0644, p:0.1019, r:0.0654, hit:0.5267, ndcg:0.3255, topn:10.
2021-03-28 03:13:15,052 - root - INFO - f1:0.0711, p:0.1635, r:0.0604, hit:0.6510, ndcg:0.4156, topn:10.
2021-03-28 03:13:51,879 - root - INFO - head hit:0.0412, head mean rank:1072.1193, topn:10.
2021-03-28 03:13:51,880 - root - INFO - tail hit:0.0863, tail mean rank:856.4301, topn:10.
2021-03-28 03:13:51,880 - root - INFO - avg hit:0.0637, avg mean rank:964.2747, topn:10.
2021-03-28 03:14:41,658 - root - INFO - head hit:0.0422, head mean rank:1076.3665, topn:10.
2021-03-28 03:14:41,658 - root - INFO - tail hit:0.0865, tail mean rank:851.0196, topn:10.
2021-03-28 03:14:41,659 - root - INFO - avg hit:0.0643, avg mean rank:963.6931, topn:10.
2021-03-28 03:14:41,690 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 03:17:14,673 - root - INFO - rec train loss:8.0017, kg train loss:31.0773!
2021-03-28 03:17:23,336 - root - INFO - f1:0.0777, p:0.1230, r:0.0786, hit:0.5710, ndcg:0.3607, topn:10.
2021-03-28 03:17:32,275 - root - INFO - f1:0.0858, p:0.1944, r:0.0736, hit:0.6917, ndcg:0.4626, topn:10.
2021-03-28 03:18:06,655 - root - INFO - head hit:0.0712, head mean rank:749.3762, topn:10.
2021-03-28 03:18:06,655 - root - INFO - tail hit:0.1356, tail mean rank:586.9300, topn:10.
2021-03-28 03:18:06,655 - root - INFO - avg hit:0.1034, avg mean rank:668.1531, topn:10.
2021-03-28 03:18:56,001 - root - INFO - head hit:0.0691, head mean rank:743.4496, topn:10.
2021-03-28 03:18:56,001 - root - INFO - tail hit:0.1383, tail mean rank:585.8075, topn:10.
2021-03-28 03:18:56,001 - root - INFO - avg hit:0.1037, avg mean rank:664.6285, topn:10.
2021-03-28 03:18:56,031 - root - INFO - Checkpointing ...
2021-03-28 03:21:28,833 - root - INFO - rec train loss:7.0895, kg train loss:27.5862!
2021-03-28 03:21:38,110 - root - INFO - f1:0.0818, p:0.1270, r:0.0836, hit:0.5881, ndcg:0.3771, topn:10.
2021-03-28 03:21:46,953 - root - INFO - f1:0.0922, p:0.2032, r:0.0799, hit:0.7157, ndcg:0.4775, topn:10.
2021-03-28 03:22:21,049 - root - INFO - head hit:0.0732, head mean rank:726.1268, topn:10.
2021-03-28 03:22:21,049 - root - INFO - tail hit:0.1493, tail mean rank:575.9046, topn:10.
2021-03-28 03:22:21,049 - root - INFO - avg hit:0.1113, avg mean rank:651.0157, topn:10.
2021-03-28 03:23:09,712 - root - INFO - head hit:0.0699, head mean rank:733.3328, topn:10.
2021-03-28 03:23:09,713 - root - INFO - tail hit:0.1481, tail mean rank:586.2425, topn:10.
2021-03-28 03:23:09,713 - root - INFO - avg hit:0.1090, avg mean rank:659.7877, topn:10.
2021-03-28 03:23:09,741 - root - INFO - Checkpointing ...
2021-03-28 03:25:43,254 - root - INFO - rec train loss:6.9161, kg train loss:27.0124!
2021-03-28 03:25:52,148 - root - INFO - f1:0.0783, p:0.1231, r:0.0790, hit:0.5735, ndcg:0.3655, topn:10.
2021-03-28 03:26:00,712 - root - INFO - f1:0.0867, p:0.1946, r:0.0744, hit:0.6995, ndcg:0.4656, topn:10.
2021-03-28 03:26:35,472 - root - INFO - head hit:0.0722, head mean rank:735.3046, topn:10.
2021-03-28 03:26:35,473 - root - INFO - tail hit:0.1505, tail mean rank:561.2041, topn:10.
2021-03-28 03:26:35,473 - root - INFO - avg hit:0.1114, avg mean rank:648.2543, topn:10.
2021-03-28 03:27:24,894 - root - INFO - head hit:0.0716, head mean rank:731.3882, topn:10.
2021-03-28 03:27:24,894 - root - INFO - tail hit:0.1516, tail mean rank:571.9709, topn:10.
2021-03-28 03:27:24,894 - root - INFO - avg hit:0.1116, avg mean rank:651.6796, topn:10.
2021-03-28 03:27:24,926 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 03:29:55,449 - root - INFO - rec train loss:4.1544, kg train loss:15.9201!
2021-03-28 03:30:04,046 - root - INFO - f1:0.0868, p:0.1339, r:0.0887, hit:0.6050, ndcg:0.3896, topn:10.
2021-03-28 03:30:13,519 - root - INFO - f1:0.0963, p:0.2112, r:0.0830, hit:0.7253, ndcg:0.4894, topn:10.
2021-03-28 03:30:48,221 - root - INFO - head hit:0.1034, head mean rank:577.0945, topn:10.
2021-03-28 03:30:48,221 - root - INFO - tail hit:0.1980, tail mean rank:448.4267, topn:10.
2021-03-28 03:30:48,221 - root - INFO - avg hit:0.1507, avg mean rank:512.7606, topn:10.
2021-03-28 03:31:35,949 - root - INFO - head hit:0.1019, head mean rank:571.6395, topn:10.
2021-03-28 03:31:35,949 - root - INFO - tail hit:0.1994, tail mean rank:457.3104, topn:10.
2021-03-28 03:31:35,949 - root - INFO - avg hit:0.1507, avg mean rank:514.4750, topn:10.
2021-03-28 03:31:35,980 - root - INFO - Checkpointing ...
2021-03-28 03:34:09,314 - root - INFO - rec train loss:3.6030, kg train loss:13.6229!
2021-03-28 03:34:18,332 - root - INFO - f1:0.0873, p:0.1345, r:0.0897, hit:0.6089, ndcg:0.3923, topn:10.
2021-03-28 03:34:27,104 - root - INFO - f1:0.0977, p:0.2129, r:0.0849, hit:0.7306, ndcg:0.4942, topn:10.
2021-03-28 03:35:01,447 - root - INFO - head hit:0.1090, head mean rank:572.8490, topn:10.
2021-03-28 03:35:01,447 - root - INFO - tail hit:0.2068, tail mean rank:448.5598, topn:10.
2021-03-28 03:35:01,447 - root - INFO - avg hit:0.1579, avg mean rank:510.7044, topn:10.
2021-03-28 03:35:50,861 - root - INFO - head hit:0.1061, head mean rank:576.3695, topn:10.
2021-03-28 03:35:50,861 - root - INFO - tail hit:0.2049, tail mean rank:457.1329, topn:10.
2021-03-28 03:35:50,861 - root - INFO - avg hit:0.1555, avg mean rank:516.7512, topn:10.
2021-03-28 03:35:50,888 - root - INFO - Checkpointing ...
2021-03-28 03:38:21,450 - root - INFO - rec train loss:3.4302, kg train loss:12.9407!
2021-03-28 03:38:30,081 - root - INFO - f1:0.0868, p:0.1350, r:0.0884, hit:0.6089, ndcg:0.3917, topn:10.
2021-03-28 03:38:39,633 - root - INFO - f1:0.0956, p:0.2119, r:0.0819, hit:0.7257, ndcg:0.4890, topn:10.
2021-03-28 03:39:14,140 - root - INFO - head hit:0.1105, head mean rank:567.7464, topn:10.
2021-03-28 03:39:14,140 - root - INFO - tail hit:0.2035, tail mean rank:457.5667, topn:10.
2021-03-28 03:39:14,140 - root - INFO - avg hit:0.1570, avg mean rank:512.6565, topn:10.
2021-03-28 03:40:02,483 - root - INFO - head hit:0.1085, head mean rank:570.0709, topn:10.
2021-03-28 03:40:02,484 - root - INFO - tail hit:0.2046, tail mean rank:464.5517, topn:10.
2021-03-28 03:40:02,484 - root - INFO - avg hit:0.1565, avg mean rank:517.3113, topn:10.
2021-03-28 03:40:02,515 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 03:42:37,264 - root - INFO - rec train loss:2.4429, kg train loss:9.0873!
2021-03-28 03:42:46,733 - root - INFO - f1:0.0913, p:0.1407, r:0.0936, hit:0.6250, ndcg:0.4095, topn:10.
2021-03-28 03:42:55,592 - root - INFO - f1:0.1017, p:0.2216, r:0.0882, hit:0.7414, ndcg:0.5074, topn:10.
2021-03-28 03:43:29,411 - root - INFO - head hit:0.1306, head mean rank:498.1699, topn:10.
2021-03-28 03:43:29,411 - root - INFO - tail hit:0.2392, tail mean rank:401.9859, topn:10.
2021-03-28 03:43:29,411 - root - INFO - avg hit:0.1849, avg mean rank:450.0779, topn:10.
2021-03-28 03:44:18,002 - root - INFO - head hit:0.1296, head mean rank:503.0531, topn:10.
2021-03-28 03:44:18,003 - root - INFO - tail hit:0.2397, tail mean rank:409.7524, topn:10.
2021-03-28 03:44:18,003 - root - INFO - avg hit:0.1846, avg mean rank:456.4028, topn:10.
2021-03-28 03:44:18,034 - root - INFO - Checkpointing ...
2021-03-28 03:46:51,416 - root - INFO - rec train loss:2.1285, kg train loss:7.8504!
2021-03-28 03:47:00,189 - root - INFO - f1:0.0925, p:0.1413, r:0.0956, hit:0.6320, ndcg:0.4128, topn:10.
2021-03-28 03:47:09,928 - root - INFO - f1:0.1030, p:0.2233, r:0.0897, hit:0.7502, ndcg:0.5122, topn:10.
2021-03-28 03:47:43,934 - root - INFO - head hit:0.1351, head mean rank:498.9671, topn:10.
2021-03-28 03:47:43,934 - root - INFO - tail hit:0.2458, tail mean rank:401.2461, topn:10.
2021-03-28 03:47:43,934 - root - INFO - avg hit:0.1904, avg mean rank:450.1066, topn:10.
2021-03-28 03:48:31,675 - root - INFO - head hit:0.1334, head mean rank:501.8430, topn:10.
2021-03-28 03:48:31,675 - root - INFO - tail hit:0.2449, tail mean rank:410.1628, topn:10.
2021-03-28 03:48:31,675 - root - INFO - avg hit:0.1891, avg mean rank:456.0029, topn:10.
2021-03-28 03:48:31,706 - root - INFO - Checkpointing ...
2021-03-28 03:50:56,521 - root - INFO - rec train loss:2.0591, kg train loss:7.4202!
2021-03-28 03:51:05,830 - root - INFO - f1:0.0918, p:0.1411, r:0.0942, hit:0.6233, ndcg:0.4107, topn:10.
2021-03-28 03:51:14,825 - root - INFO - f1:0.1024, p:0.2226, r:0.0890, hit:0.7450, ndcg:0.5121, topn:10.
2021-03-28 03:51:49,201 - root - INFO - head hit:0.1370, head mean rank:499.4359, topn:10.
2021-03-28 03:51:49,202 - root - INFO - tail hit:0.2475, tail mean rank:404.4347, topn:10.
2021-03-28 03:51:49,202 - root - INFO - avg hit:0.1922, avg mean rank:451.9353, topn:10.
2021-03-28 03:52:36,776 - root - INFO - head hit:0.1357, head mean rank:506.0984, topn:10.
2021-03-28 03:52:36,776 - root - INFO - tail hit:0.2465, tail mean rank:414.0421, topn:10.
2021-03-28 03:52:36,776 - root - INFO - avg hit:0.1911, avg mean rank:460.0702, topn:10.
2021-03-28 03:52:36,807 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 03:55:01,132 - root - INFO - rec train loss:1.6705, kg train loss:5.9923!
2021-03-28 03:55:10,594 - root - INFO - f1:0.0948, p:0.1448, r:0.0976, hit:0.6377, ndcg:0.4188, topn:10.
2021-03-28 03:55:19,448 - root - INFO - f1:0.1048, p:0.2274, r:0.0908, hit:0.7566, ndcg:0.5200, topn:10.
2021-03-28 03:55:53,625 - root - INFO - head hit:0.1529, head mean rank:470.5732, topn:10.
2021-03-28 03:55:53,625 - root - INFO - tail hit:0.2654, tail mean rank:382.5457, topn:10.
2021-03-28 03:55:53,626 - root - INFO - avg hit:0.2091, avg mean rank:426.5595, topn:10.
2021-03-28 03:56:42,155 - root - INFO - head hit:0.1525, head mean rank:475.6783, topn:10.
2021-03-28 03:56:42,155 - root - INFO - tail hit:0.2650, tail mean rank:390.5878, topn:10.
2021-03-28 03:56:42,155 - root - INFO - avg hit:0.2087, avg mean rank:433.1330, topn:10.
2021-03-28 03:56:42,185 - root - INFO - Checkpointing ...
2021-03-28 03:59:06,145 - root - INFO - rec train loss:1.5311, kg train loss:5.3925!
2021-03-28 03:59:14,911 - root - INFO - f1:0.0940, p:0.1441, r:0.0965, hit:0.6310, ndcg:0.4159, topn:10.
2021-03-28 03:59:24,503 - root - INFO - f1:0.1048, p:0.2268, r:0.0910, hit:0.7490, ndcg:0.5153, topn:10.
2021-03-28 03:59:58,494 - root - INFO - head hit:0.1597, head mean rank:470.3510, topn:10.
2021-03-28 03:59:58,494 - root - INFO - tail hit:0.2692, tail mean rank:381.8860, topn:10.
2021-03-28 03:59:58,494 - root - INFO - avg hit:0.2145, avg mean rank:426.1185, topn:10.
2021-03-28 04:00:47,136 - root - INFO - head hit:0.1584, head mean rank:475.3825, topn:10.
2021-03-28 04:00:47,137 - root - INFO - tail hit:0.2685, tail mean rank:391.6208, topn:10.
2021-03-28 04:00:47,137 - root - INFO - avg hit:0.2134, avg mean rank:433.5017, topn:10.
2021-03-28 04:00:47,167 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:03:12,730 - root - INFO - rec train loss:1.3734, kg train loss:4.7862!
2021-03-28 04:03:22,146 - root - INFO - f1:0.0959, p:0.1467, r:0.0986, hit:0.6386, ndcg:0.4211, topn:10.
2021-03-28 04:03:31,105 - root - INFO - f1:0.1066, p:0.2299, r:0.0931, hit:0.7601, ndcg:0.5225, topn:10.
2021-03-28 04:04:05,538 - root - INFO - head hit:0.1654, head mean rank:456.1341, topn:10.
2021-03-28 04:04:05,538 - root - INFO - tail hit:0.2776, tail mean rank:375.1272, topn:10.
2021-03-28 04:04:05,539 - root - INFO - avg hit:0.2215, avg mean rank:415.6307, topn:10.
2021-03-28 04:04:54,529 - root - INFO - head hit:0.1649, head mean rank:463.3156, topn:10.
2021-03-28 04:04:54,530 - root - INFO - tail hit:0.2763, tail mean rank:383.4799, topn:10.
2021-03-28 04:04:54,530 - root - INFO - avg hit:0.2206, avg mean rank:423.3977, topn:10.
2021-03-28 04:04:54,558 - root - INFO - Checkpointing ...
2021-03-28 04:07:20,083 - root - INFO - rec train loss:1.2803, kg train loss:4.4819!
2021-03-28 04:07:28,857 - root - INFO - f1:0.0953, p:0.1462, r:0.0979, hit:0.6369, ndcg:0.4186, topn:10.
2021-03-28 04:07:38,714 - root - INFO - f1:0.1056, p:0.2279, r:0.0921, hit:0.7576, ndcg:0.5211, topn:10.
2021-03-28 04:08:12,534 - root - INFO - head hit:0.1702, head mean rank:455.7698, topn:10.
2021-03-28 04:08:12,534 - root - INFO - tail hit:0.2850, tail mean rank:374.3871, topn:10.
2021-03-28 04:08:12,534 - root - INFO - avg hit:0.2276, avg mean rank:415.0784, topn:10.
2021-03-28 04:09:00,174 - root - INFO - head hit:0.1670, head mean rank:462.7204, topn:10.
2021-03-28 04:09:00,174 - root - INFO - tail hit:0.2794, tail mean rank:382.8864, topn:10.
2021-03-28 04:09:00,174 - root - INFO - avg hit:0.2232, avg mean rank:422.8034, topn:10.
2021-03-28 04:09:00,204 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:11:25,608 - root - INFO - rec train loss:1.2163, kg train loss:4.1586!
2021-03-28 04:11:35,390 - root - INFO - f1:0.0959, p:0.1472, r:0.0985, hit:0.6384, ndcg:0.4209, topn:10.
2021-03-28 04:11:44,243 - root - INFO - f1:0.1063, p:0.2296, r:0.0925, hit:0.7589, ndcg:0.5208, topn:10.
2021-03-28 04:12:18,546 - root - INFO - head hit:0.1740, head mean rank:450.7891, topn:10.
2021-03-28 04:12:18,546 - root - INFO - tail hit:0.2872, tail mean rank:370.4219, topn:10.
2021-03-28 04:12:18,546 - root - INFO - avg hit:0.2306, avg mean rank:410.6055, topn:10.
2021-03-28 04:13:06,531 - root - INFO - head hit:0.1728, head mean rank:457.1467, topn:10.
2021-03-28 04:13:06,532 - root - INFO - tail hit:0.2834, tail mean rank:378.6904, topn:10.
2021-03-28 04:13:06,532 - root - INFO - avg hit:0.2281, avg mean rank:417.9185, topn:10.
2021-03-28 04:13:06,563 - root - INFO - Checkpointing ...
2021-03-28 04:15:30,692 - root - INFO - rec train loss:1.1797, kg train loss:3.9782!
2021-03-28 04:15:39,836 - root - INFO - f1:0.0960, p:0.1474, r:0.0985, hit:0.6379, ndcg:0.4204, topn:10.
2021-03-28 04:15:48,439 - root - INFO - f1:0.1065, p:0.2301, r:0.0928, hit:0.7573, ndcg:0.5211, topn:10.
2021-03-28 04:16:22,257 - root - INFO - head hit:0.1755, head mean rank:449.0309, topn:10.
2021-03-28 04:16:22,257 - root - INFO - tail hit:0.2894, tail mean rank:369.7700, topn:10.
2021-03-28 04:16:22,257 - root - INFO - avg hit:0.2324, avg mean rank:409.4004, topn:10.
2021-03-28 04:17:10,613 - root - INFO - head hit:0.1739, head mean rank:456.4144, topn:10.
2021-03-28 04:17:10,613 - root - INFO - tail hit:0.2848, tail mean rank:378.6167, topn:10.
2021-03-28 04:17:10,613 - root - INFO - avg hit:0.2293, avg mean rank:417.5155, topn:10.
2021-03-28 04:17:10,643 - root - INFO - Checkpointing ...
2021-03-28 04:19:43,834 - root - INFO - rec train loss:1.1368, kg train loss:3.8954!
2021-03-28 04:19:52,427 - root - INFO - f1:0.0958, p:0.1474, r:0.0980, hit:0.6373, ndcg:0.4212, topn:10.
2021-03-28 04:20:02,315 - root - INFO - f1:0.1065, p:0.2300, r:0.0927, hit:0.7573, ndcg:0.5218, topn:10.
2021-03-28 04:20:35,549 - root - INFO - head hit:0.1768, head mean rank:449.3102, topn:10.
2021-03-28 04:20:35,549 - root - INFO - tail hit:0.2916, tail mean rank:369.8350, topn:10.
2021-03-28 04:20:35,549 - root - INFO - avg hit:0.2342, avg mean rank:409.5726, topn:10.
2021-03-28 04:21:24,316 - root - INFO - head hit:0.1749, head mean rank:455.9663, topn:10.
2021-03-28 04:21:24,316 - root - INFO - tail hit:0.2873, tail mean rank:378.7773, topn:10.
2021-03-28 04:21:24,316 - root - INFO - avg hit:0.2311, avg mean rank:417.3718, topn:10.
2021-03-28 04:21:24,347 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:23:57,794 - root - INFO - rec train loss:1.1218, kg train loss:3.7516!
2021-03-28 04:24:07,359 - root - INFO - f1:0.0961, p:0.1475, r:0.0985, hit:0.6401, ndcg:0.4225, topn:10.
2021-03-28 04:24:16,233 - root - INFO - f1:0.1072, p:0.2307, r:0.0935, hit:0.7581, ndcg:0.5212, topn:10.
2021-03-28 04:24:50,410 - root - INFO - head hit:0.1796, head mean rank:447.0240, topn:10.
2021-03-28 04:24:50,410 - root - INFO - tail hit:0.2924, tail mean rank:368.7982, topn:10.
2021-03-28 04:24:50,410 - root - INFO - avg hit:0.2360, avg mean rank:407.9111, topn:10.
2021-03-28 04:25:37,879 - root - INFO - head hit:0.1783, head mean rank:454.1123, topn:10.
2021-03-28 04:25:37,880 - root - INFO - tail hit:0.2887, tail mean rank:377.9053, topn:10.
2021-03-28 04:25:37,880 - root - INFO - avg hit:0.2335, avg mean rank:416.0088, topn:10.
2021-03-28 04:25:37,910 - root - INFO - Checkpointing ...
2021-03-28 04:28:10,175 - root - INFO - rec train loss:1.0950, kg train loss:3.7308!
2021-03-28 04:28:18,954 - root - INFO - f1:0.0960, p:0.1475, r:0.0983, hit:0.6399, ndcg:0.4218, topn:10.
2021-03-28 04:28:28,337 - root - INFO - f1:0.1073, p:0.2311, r:0.0937, hit:0.7608, ndcg:0.5225, topn:10.
2021-03-28 04:29:02,222 - root - INFO - head hit:0.1809, head mean rank:446.5542, topn:10.
2021-03-28 04:29:02,222 - root - INFO - tail hit:0.2924, tail mean rank:368.3563, topn:10.
2021-03-28 04:29:02,222 - root - INFO - avg hit:0.2366, avg mean rank:407.4553, topn:10.
2021-03-28 04:29:49,813 - root - INFO - head hit:0.1812, head mean rank:453.1287, topn:10.
2021-03-28 04:29:49,814 - root - INFO - tail hit:0.2900, tail mean rank:377.7067, topn:10.
2021-03-28 04:29:49,814 - root - INFO - avg hit:0.2356, avg mean rank:415.4177, topn:10.
2021-03-28 04:29:49,843 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:32:22,827 - root - INFO - rec train loss:1.0867, kg train loss:3.6339!
2021-03-28 04:32:32,319 - root - INFO - f1:0.0960, p:0.1474, r:0.0984, hit:0.6389, ndcg:0.4221, topn:10.
2021-03-28 04:32:41,098 - root - INFO - f1:0.1072, p:0.2308, r:0.0935, hit:0.7601, ndcg:0.5228, topn:10.
2021-03-28 04:33:15,045 - root - INFO - head hit:0.1825, head mean rank:445.5366, topn:10.
2021-03-28 04:33:15,046 - root - INFO - tail hit:0.2935, tail mean rank:367.5527, topn:10.
2021-03-28 04:33:15,046 - root - INFO - avg hit:0.2380, avg mean rank:406.5447, topn:10.
2021-03-28 04:34:03,581 - root - INFO - head hit:0.1812, head mean rank:452.6924, topn:10.
2021-03-28 04:34:03,581 - root - INFO - tail hit:0.2907, tail mean rank:377.0862, topn:10.
2021-03-28 04:34:03,581 - root - INFO - avg hit:0.2359, avg mean rank:414.8893, topn:10.
2021-03-28 04:34:03,610 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:36:34,065 - root - INFO - rec train loss:1.0699, kg train loss:3.6156!
2021-03-28 04:36:42,942 - root - INFO - f1:0.0963, p:0.1477, r:0.0987, hit:0.6394, ndcg:0.4223, topn:10.
2021-03-28 04:36:52,395 - root - INFO - f1:0.1076, p:0.2314, r:0.0939, hit:0.7613, ndcg:0.5231, topn:10.
2021-03-28 04:37:26,089 - root - INFO - head hit:0.1832, head mean rank:445.1118, topn:10.
2021-03-28 04:37:26,090 - root - INFO - tail hit:0.2936, tail mean rank:367.3958, topn:10.
2021-03-28 04:37:26,090 - root - INFO - avg hit:0.2384, avg mean rank:406.2538, topn:10.
2021-03-28 04:38:15,153 - root - INFO - head hit:0.1812, head mean rank:452.3637, topn:10.
2021-03-28 04:38:15,153 - root - INFO - tail hit:0.2905, tail mean rank:376.9504, topn:10.
2021-03-28 04:38:15,153 - root - INFO - avg hit:0.2358, avg mean rank:414.6571, topn:10.
2021-03-28 04:38:15,184 - root - INFO - Checkpointing ...
2021-03-28 04:40:47,723 - root - INFO - rec train loss:1.0788, kg train loss:3.5663!
2021-03-28 04:40:56,329 - root - INFO - f1:0.0963, p:0.1477, r:0.0987, hit:0.6397, ndcg:0.4232, topn:10.
2021-03-28 04:41:05,483 - root - INFO - f1:0.1075, p:0.2311, r:0.0938, hit:0.7609, ndcg:0.5232, topn:10.
2021-03-28 04:41:39,735 - root - INFO - head hit:0.1831, head mean rank:444.7670, topn:10.
2021-03-28 04:41:39,736 - root - INFO - tail hit:0.2940, tail mean rank:367.1374, topn:10.
2021-03-28 04:41:39,744 - root - INFO - avg hit:0.2386, avg mean rank:405.9522, topn:10.
2021-03-28 04:42:27,878 - root - INFO - head hit:0.1817, head mean rank:452.1785, topn:10.
2021-03-28 04:42:27,878 - root - INFO - tail hit:0.2908, tail mean rank:376.8057, topn:10.
2021-03-28 04:42:27,879 - root - INFO - avg hit:0.2363, avg mean rank:414.4921, topn:10.
2021-03-28 04:42:27,929 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:45:01,185 - root - INFO - rec train loss:1.0779, kg train loss:3.5226!
2021-03-28 04:45:10,710 - root - INFO - f1:0.0963, p:0.1478, r:0.0986, hit:0.6389, ndcg:0.4223, topn:10.
2021-03-28 04:45:19,351 - root - INFO - f1:0.1075, p:0.2312, r:0.0938, hit:0.7613, ndcg:0.5241, topn:10.
2021-03-28 04:45:53,493 - root - INFO - head hit:0.1824, head mean rank:444.5173, topn:10.
2021-03-28 04:45:53,493 - root - INFO - tail hit:0.2940, tail mean rank:367.0658, topn:10.
2021-03-28 04:45:53,494 - root - INFO - avg hit:0.2382, avg mean rank:405.7915, topn:10.
2021-03-28 04:46:41,384 - root - INFO - head hit:0.1816, head mean rank:451.8758, topn:10.
2021-03-28 04:46:41,385 - root - INFO - tail hit:0.2908, tail mean rank:376.7529, topn:10.
2021-03-28 04:46:41,385 - root - INFO - avg hit:0.2362, avg mean rank:414.3143, topn:10.
2021-03-28 04:46:41,417 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:49:11,014 - root - INFO - rec train loss:1.0627, kg train loss:3.5162!
2021-03-28 04:49:19,753 - root - INFO - f1:0.0963, p:0.1478, r:0.0985, hit:0.6384, ndcg:0.4225, topn:10.
2021-03-28 04:49:29,355 - root - INFO - f1:0.1075, p:0.2311, r:0.0937, hit:0.7611, ndcg:0.5238, topn:10.
2021-03-28 04:50:03,202 - root - INFO - head hit:0.1830, head mean rank:444.4281, topn:10.
2021-03-28 04:50:03,202 - root - INFO - tail hit:0.2944, tail mean rank:366.9899, topn:10.
2021-03-28 04:50:03,202 - root - INFO - avg hit:0.2387, avg mean rank:405.7090, topn:10.
2021-03-28 04:50:50,206 - root - INFO - head hit:0.1816, head mean rank:451.8273, topn:10.
2021-03-28 04:50:50,206 - root - INFO - tail hit:0.2909, tail mean rank:376.6998, topn:10.
2021-03-28 04:50:50,206 - root - INFO - avg hit:0.2362, avg mean rank:414.2635, topn:10.
2021-03-28 04:50:50,237 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:53:20,052 - root - INFO - rec train loss:1.0627, kg train loss:3.5756!
2021-03-28 04:53:29,400 - root - INFO - f1:0.0962, p:0.1477, r:0.0984, hit:0.6376, ndcg:0.4219, topn:10.
2021-03-28 04:53:38,315 - root - INFO - f1:0.1075, p:0.2312, r:0.0937, hit:0.7616, ndcg:0.5241, topn:10.
2021-03-28 04:54:13,432 - root - INFO - head hit:0.1827, head mean rank:444.3918, topn:10.
2021-03-28 04:54:13,433 - root - INFO - tail hit:0.2942, tail mean rank:366.9344, topn:10.
2021-03-28 04:54:13,433 - root - INFO - avg hit:0.2384, avg mean rank:405.6631, topn:10.
2021-03-28 04:55:01,490 - root - INFO - head hit:0.1815, head mean rank:451.7871, topn:10.
2021-03-28 04:55:01,490 - root - INFO - tail hit:0.2910, tail mean rank:376.6347, topn:10.
2021-03-28 04:55:01,491 - root - INFO - avg hit:0.2362, avg mean rank:414.2109, topn:10.
2021-03-28 04:55:01,520 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:57:34,895 - root - INFO - rec train loss:1.0502, kg train loss:3.5292!
2021-03-28 04:57:43,827 - root - INFO - f1:0.0962, p:0.1477, r:0.0985, hit:0.6376, ndcg:0.4220, topn:10.
2021-03-28 04:57:52,943 - root - INFO - f1:0.1075, p:0.2312, r:0.0937, hit:0.7614, ndcg:0.5240, topn:10.
2021-03-28 04:58:26,367 - root - INFO - head hit:0.1827, head mean rank:444.3823, topn:10.
2021-03-28 04:58:26,368 - root - INFO - tail hit:0.2943, tail mean rank:366.9076, topn:10.
2021-03-28 04:58:26,368 - root - INFO - avg hit:0.2385, avg mean rank:405.6449, topn:10.
2021-03-28 04:59:14,531 - root - INFO - head hit:0.1816, head mean rank:451.7679, topn:10.
2021-03-28 04:59:14,531 - root - INFO - tail hit:0.2909, tail mean rank:376.6127, topn:10.
2021-03-28 04:59:14,531 - root - INFO - avg hit:0.2363, avg mean rank:414.1903, topn:10.
2021-03-28 04:59:14,562 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-28 04:59:14,581 - root - INFO - No improvement after 97600 steps. Stopping training.
2021-03-28 04:59:26,195 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.147715, 'RECALL@10': 0.098481, 'NDCG@10': 0.421971, 'MAP@10': 0.319965, 'MAP': 0.319965}.
