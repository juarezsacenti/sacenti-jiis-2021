2021-03-02 15:53:13,932 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614711193",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-02 15:53:13,945 - root - INFO - Totally 2971 train triples, 347,694 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/cao-format/ml1m/kg/test.dat!
2021-03-02 15:53:13,947 - root - INFO - successfully load 1581 entities and 3 relations!
2021-03-02 15:53:13,952 - root - INFO - Building model.
2021-03-02 15:53:15,227 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(1581, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-02 15:53:15,227 - root - INFO - Total params: 158700.0
2021-03-02 15:53:15,227 - root - INFO - One epoch is 12 steps.
2021-03-02 15:53:15,228 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-02 15:53:15,230 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/ml1m-transe-pretrained.ckpt.
2021-03-02 15:53:15,230 - root - INFO - Training.
2021-03-02 15:53:15,230 - root - INFO - train loss:0.0000!
2021-03-02 15:53:16,073 - root - INFO - head hit:0.2334, head mean rank:334.1037, topn:10.
2021-03-02 15:53:16,073 - root - INFO - tail hit:0.7637, tail mean rank:12.2939, topn:10.
2021-03-02 15:53:16,073 - root - INFO - avg hit:0.4986, avg mean rank:173.1988, topn:10.
2021-03-02 15:53:16,923 - root - INFO - head hit:0.2651, head mean rank:333.8905, topn:10.
2021-03-02 15:53:16,923 - root - INFO - tail hit:0.7738, tail mean rank:12.8934, topn:10.
2021-03-02 15:53:16,923 - root - INFO - avg hit:0.5195, avg mean rank:173.3919, topn:10.
2021-03-02 15:53:56,353 - root - INFO - train loss:0.0155!
2021-03-02 15:53:56,996 - root - INFO - head hit:0.2536, head mean rank:320.1239, topn:10.
2021-03-02 15:53:56,997 - root - INFO - tail hit:0.7061, tail mean rank:19.5360, topn:10.
2021-03-02 15:53:56,997 - root - INFO - avg hit:0.4798, avg mean rank:169.8300, topn:10.
2021-03-02 15:53:57,901 - root - INFO - head hit:0.2392, head mean rank:329.7363, topn:10.
2021-03-02 15:53:57,902 - root - INFO - tail hit:0.7061, tail mean rank:19.3862, topn:10.
2021-03-02 15:53:57,902 - root - INFO - avg hit:0.4726, avg mean rank:174.5612, topn:10.
2021-03-02 15:53:57,903 - root - INFO - Checkpointing ...
2021-03-02 15:54:37,483 - root - INFO - train loss:0.0218!
2021-03-02 15:54:38,152 - root - INFO - head hit:0.2190, head mean rank:316.4380, topn:10.
2021-03-02 15:54:38,152 - root - INFO - tail hit:0.6974, tail mean rank:19.2622, topn:10.
2021-03-02 15:54:38,152 - root - INFO - avg hit:0.4582, avg mean rank:167.8501, topn:10.
2021-03-02 15:54:39,059 - root - INFO - head hit:0.2363, head mean rank:318.2190, topn:10.
2021-03-02 15:54:39,060 - root - INFO - tail hit:0.6830, tail mean rank:19.6081, topn:10.
2021-03-02 15:54:39,060 - root - INFO - avg hit:0.4597, avg mean rank:168.9135, topn:10.
2021-03-02 15:54:39,061 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 15:55:15,662 - root - INFO - train loss:0.0042!
2021-03-02 15:55:16,300 - root - INFO - head hit:0.2392, head mean rank:317.1671, topn:10.
2021-03-02 15:55:16,300 - root - INFO - tail hit:0.7435, tail mean rank:15.8300, topn:10.
2021-03-02 15:55:16,300 - root - INFO - avg hit:0.4914, avg mean rank:166.4986, topn:10.
2021-03-02 15:55:17,197 - root - INFO - head hit:0.2478, head mean rank:318.4568, topn:10.
2021-03-02 15:55:17,198 - root - INFO - tail hit:0.7320, tail mean rank:16.4496, topn:10.
2021-03-02 15:55:17,198 - root - INFO - avg hit:0.4899, avg mean rank:167.4532, topn:10.
2021-03-02 15:55:17,199 - root - INFO - Checkpointing ...
2021-03-02 15:55:56,035 - root - INFO - train loss:0.0028!
2021-03-02 15:55:56,632 - root - INFO - head hit:0.2767, head mean rank:316.8242, topn:10.
2021-03-02 15:55:56,633 - root - INFO - tail hit:0.7579, tail mean rank:13.7233, topn:10.
2021-03-02 15:55:56,633 - root - INFO - avg hit:0.5173, avg mean rank:165.2738, topn:10.
2021-03-02 15:55:57,546 - root - INFO - head hit:0.2738, head mean rank:318.5043, topn:10.
2021-03-02 15:55:57,546 - root - INFO - tail hit:0.7522, tail mean rank:13.9553, topn:10.
2021-03-02 15:55:57,546 - root - INFO - avg hit:0.5130, avg mean rank:166.2298, topn:10.
2021-03-02 15:55:57,547 - root - INFO - Checkpointing ...
2021-03-02 15:56:35,675 - root - INFO - train loss:0.0011!
2021-03-02 15:56:36,295 - root - INFO - head hit:0.2824, head mean rank:302.8271, topn:10.
2021-03-02 15:56:36,295 - root - INFO - tail hit:0.7752, tail mean rank:14.4813, topn:10.
2021-03-02 15:56:36,295 - root - INFO - avg hit:0.5288, avg mean rank:158.6542, topn:10.
2021-03-02 15:56:37,215 - root - INFO - head hit:0.2709, head mean rank:309.0504, topn:10.
2021-03-02 15:56:37,216 - root - INFO - tail hit:0.7392, tail mean rank:17.9294, topn:10.
2021-03-02 15:56:37,216 - root - INFO - avg hit:0.5050, avg mean rank:163.4899, topn:10.
2021-03-02 15:56:37,216 - root - INFO - Checkpointing ...
2021-03-02 15:57:14,541 - root - INFO - train loss:0.0010!
2021-03-02 15:57:15,155 - root - INFO - head hit:0.2565, head mean rank:302.5216, topn:10.
2021-03-02 15:57:15,155 - root - INFO - tail hit:0.8127, tail mean rank:11.9942, topn:10.
2021-03-02 15:57:15,156 - root - INFO - avg hit:0.5346, avg mean rank:157.2579, topn:10.
2021-03-02 15:57:16,067 - root - INFO - head hit:0.2767, head mean rank:308.1542, topn:10.
2021-03-02 15:57:16,068 - root - INFO - tail hit:0.7896, tail mean rank:13.9438, topn:10.
2021-03-02 15:57:16,068 - root - INFO - avg hit:0.5331, avg mean rank:161.0490, topn:10.
2021-03-02 15:57:16,068 - root - INFO - Checkpointing ...
2021-03-02 15:57:51,820 - root - INFO - train loss:0.0008!
2021-03-02 15:57:52,455 - root - INFO - head hit:0.2594, head mean rank:305.0922, topn:10.
2021-03-02 15:57:52,455 - root - INFO - tail hit:0.7954, tail mean rank:13.0663, topn:10.
2021-03-02 15:57:52,455 - root - INFO - avg hit:0.5274, avg mean rank:159.0793, topn:10.
2021-03-02 15:57:53,317 - root - INFO - head hit:0.2781, head mean rank:305.6441, topn:10.
2021-03-02 15:57:53,317 - root - INFO - tail hit:0.7752, tail mean rank:12.4280, topn:10.
2021-03-02 15:57:53,317 - root - INFO - avg hit:0.5267, avg mean rank:159.0360, topn:10.
2021-03-02 15:57:53,318 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 15:58:31,279 - root - INFO - train loss:0.0005!
2021-03-02 15:58:31,867 - root - INFO - head hit:0.2651, head mean rank:303.0231, topn:10.
2021-03-02 15:58:31,867 - root - INFO - tail hit:0.7954, tail mean rank:13.1671, topn:10.
2021-03-02 15:58:31,867 - root - INFO - avg hit:0.5303, avg mean rank:158.0951, topn:10.
2021-03-02 15:58:32,780 - root - INFO - head hit:0.2839, head mean rank:304.5101, topn:10.
2021-03-02 15:58:32,780 - root - INFO - tail hit:0.7896, tail mean rank:12.8199, topn:10.
2021-03-02 15:58:32,781 - root - INFO - avg hit:0.5367, avg mean rank:158.6650, topn:10.
2021-03-02 15:58:32,781 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 15:59:12,111 - root - INFO - train loss:0.0001!
2021-03-02 15:59:12,752 - root - INFO - head hit:0.2824, head mean rank:303.2507, topn:10.
2021-03-02 15:59:12,753 - root - INFO - tail hit:0.8040, tail mean rank:12.5533, topn:10.
2021-03-02 15:59:12,753 - root - INFO - avg hit:0.5432, avg mean rank:157.9020, topn:10.
2021-03-02 15:59:13,680 - root - INFO - head hit:0.2839, head mean rank:304.4625, topn:10.
2021-03-02 15:59:13,681 - root - INFO - tail hit:0.7954, tail mean rank:11.9870, topn:10.
2021-03-02 15:59:13,681 - root - INFO - avg hit:0.5396, avg mean rank:158.2248, topn:10.
2021-03-02 15:59:13,681 - root - INFO - Checkpointing ...
2021-03-02 15:59:49,850 - root - INFO - train loss:0.0000!
2021-03-02 15:59:50,483 - root - INFO - head hit:0.2795, head mean rank:302.7896, topn:10.
2021-03-02 15:59:50,484 - root - INFO - tail hit:0.8127, tail mean rank:12.2392, topn:10.
2021-03-02 15:59:50,484 - root - INFO - avg hit:0.5461, avg mean rank:157.5144, topn:10.
2021-03-02 15:59:51,374 - root - INFO - head hit:0.2795, head mean rank:304.1210, topn:10.
2021-03-02 15:59:51,374 - root - INFO - tail hit:0.7997, tail mean rank:11.5274, topn:10.
2021-03-02 15:59:51,374 - root - INFO - avg hit:0.5396, avg mean rank:157.8242, topn:10.
2021-03-02 15:59:51,375 - root - INFO - Checkpointing ...
2021-03-02 16:00:30,620 - root - INFO - train loss:0.0000!
2021-03-02 16:00:31,285 - root - INFO - head hit:0.2795, head mean rank:304.0202, topn:10.
2021-03-02 16:00:31,285 - root - INFO - tail hit:0.8213, tail mean rank:12.0317, topn:10.
2021-03-02 16:00:31,286 - root - INFO - avg hit:0.5504, avg mean rank:158.0259, topn:10.
2021-03-02 16:00:32,157 - root - INFO - head hit:0.2853, head mean rank:304.5375, topn:10.
2021-03-02 16:00:32,157 - root - INFO - tail hit:0.8026, tail mean rank:11.2363, topn:10.
2021-03-02 16:00:32,158 - root - INFO - avg hit:0.5439, avg mean rank:157.8869, topn:10.
2021-03-02 16:00:32,158 - root - INFO - Checkpointing ...
2021-03-02 16:01:09,928 - root - INFO - train loss:0.0000!
2021-03-02 16:01:10,587 - root - INFO - head hit:0.2795, head mean rank:304.1816, topn:10.
2021-03-02 16:01:10,587 - root - INFO - tail hit:0.8213, tail mean rank:12.0375, topn:10.
2021-03-02 16:01:10,588 - root - INFO - avg hit:0.5504, avg mean rank:158.1095, topn:10.
2021-03-02 16:01:11,517 - root - INFO - head hit:0.2867, head mean rank:304.2435, topn:10.
2021-03-02 16:01:11,517 - root - INFO - tail hit:0.7983, tail mean rank:11.3069, topn:10.
2021-03-02 16:01:11,517 - root - INFO - avg hit:0.5425, avg mean rank:157.7752, topn:10.
2021-03-02 16:01:11,518 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:01:49,463 - root - INFO - train loss:0.0001!
2021-03-02 16:01:50,138 - root - INFO - head hit:0.2824, head mean rank:304.6916, topn:10.
2021-03-02 16:01:50,138 - root - INFO - tail hit:0.8213, tail mean rank:11.8329, topn:10.
2021-03-02 16:01:50,139 - root - INFO - avg hit:0.5519, avg mean rank:158.2622, topn:10.
2021-03-02 16:01:51,048 - root - INFO - head hit:0.2896, head mean rank:304.5389, topn:10.
2021-03-02 16:01:51,049 - root - INFO - tail hit:0.8012, tail mean rank:11.0562, topn:10.
2021-03-02 16:01:51,049 - root - INFO - avg hit:0.5454, avg mean rank:157.7976, topn:10.
2021-03-02 16:01:51,049 - root - INFO - Checkpointing ...
2021-03-02 16:02:29,633 - root - INFO - train loss:0.0001!
2021-03-02 16:02:30,229 - root - INFO - head hit:0.2853, head mean rank:304.2594, topn:10.
2021-03-02 16:02:30,230 - root - INFO - tail hit:0.8242, tail mean rank:11.7752, topn:10.
2021-03-02 16:02:30,230 - root - INFO - avg hit:0.5548, avg mean rank:158.0173, topn:10.
2021-03-02 16:02:31,101 - root - INFO - head hit:0.2954, head mean rank:304.6354, topn:10.
2021-03-02 16:02:31,102 - root - INFO - tail hit:0.8012, tail mean rank:11.1686, topn:10.
2021-03-02 16:02:31,102 - root - INFO - avg hit:0.5483, avg mean rank:157.9020, topn:10.
2021-03-02 16:02:31,103 - root - INFO - Checkpointing ...
2021-03-02 16:03:07,362 - root - INFO - train loss:0.0000!
2021-03-02 16:03:07,974 - root - INFO - head hit:0.2853, head mean rank:304.2536, topn:10.
2021-03-02 16:03:07,974 - root - INFO - tail hit:0.8242, tail mean rank:11.7752, topn:10.
2021-03-02 16:03:07,974 - root - INFO - avg hit:0.5548, avg mean rank:158.0144, topn:10.
2021-03-02 16:03:08,901 - root - INFO - head hit:0.2939, head mean rank:304.6369, topn:10.
2021-03-02 16:03:08,902 - root - INFO - tail hit:0.8012, tail mean rank:11.1671, topn:10.
2021-03-02 16:03:08,902 - root - INFO - avg hit:0.5476, avg mean rank:157.9020, topn:10.
2021-03-02 16:03:08,903 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:03:48,461 - root - INFO - train loss:0.0000!
2021-03-02 16:03:49,035 - root - INFO - head hit:0.2882, head mean rank:303.7061, topn:10.
2021-03-02 16:03:49,035 - root - INFO - tail hit:0.8213, tail mean rank:11.7550, topn:10.
2021-03-02 16:03:49,035 - root - INFO - avg hit:0.5548, avg mean rank:157.7305, topn:10.
2021-03-02 16:03:49,819 - root - INFO - head hit:0.2954, head mean rank:304.5274, topn:10.
2021-03-02 16:03:49,820 - root - INFO - tail hit:0.8026, tail mean rank:11.0519, topn:10.
2021-03-02 16:03:49,820 - root - INFO - avg hit:0.5490, avg mean rank:157.7896, topn:10.
2021-03-02 16:03:49,821 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:04:27,003 - root - INFO - train loss:0.0000!
2021-03-02 16:04:27,599 - root - INFO - head hit:0.2882, head mean rank:303.7695, topn:10.
2021-03-02 16:04:27,600 - root - INFO - tail hit:0.8213, tail mean rank:11.7752, topn:10.
2021-03-02 16:04:27,600 - root - INFO - avg hit:0.5548, avg mean rank:157.7723, topn:10.
2021-03-02 16:04:28,551 - root - INFO - head hit:0.2954, head mean rank:304.5274, topn:10.
2021-03-02 16:04:28,551 - root - INFO - tail hit:0.8026, tail mean rank:11.0620, topn:10.
2021-03-02 16:04:28,551 - root - INFO - avg hit:0.5490, avg mean rank:157.7947, topn:10.
2021-03-02 16:04:28,552 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:05:06,363 - root - INFO - train loss:0.0000!
2021-03-02 16:05:07,005 - root - INFO - head hit:0.2882, head mean rank:303.7695, topn:10.
2021-03-02 16:05:07,006 - root - INFO - tail hit:0.8213, tail mean rank:11.7752, topn:10.
2021-03-02 16:05:07,006 - root - INFO - avg hit:0.5548, avg mean rank:157.7723, topn:10.
2021-03-02 16:05:07,845 - root - INFO - head hit:0.2954, head mean rank:304.5259, topn:10.
2021-03-02 16:05:07,845 - root - INFO - tail hit:0.8026, tail mean rank:11.0620, topn:10.
2021-03-02 16:05:07,846 - root - INFO - avg hit:0.5490, avg mean rank:157.7939, topn:10.
2021-03-02 16:05:07,846 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:05:45,247 - root - INFO - No improvement after 24363 steps. Stopping training.
