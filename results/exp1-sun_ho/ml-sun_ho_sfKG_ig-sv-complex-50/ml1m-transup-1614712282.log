2021-03-02 16:11:22,290 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 13317,
    "embedding_size": 100,
    "eval_interval_steps": 2663,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transup-1614712282",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": null,
    "l2_lambda": 1e-05,
    "learning_rate": 0.005,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/ml1m-bprmf-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transup",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 3,
    "num_processes": 4,
    "optimizer_type": "Adagrad",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 266300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-02 16:11:22,526 - root - INFO - Totally 69982 train ratings, 9998,19995 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/cao-format/ml1m/test.dat!
2021-03-02 16:11:22,529 - root - INFO - successfully load 943 users and 1675 items!
2021-03-02 16:11:22,609 - root - INFO - Building model.
2021-03-02 16:11:23,667 - root - INFO - Architecture: TransUPModel(
  (user_embeddings): Embedding(943, 100)
  (item_embeddings): Embedding(1675, 100)
  (pref_embeddings): Embedding(3, 100)
  (pref_norm_embeddings): Embedding(3, 100)
)
2021-03-02 16:11:23,667 - root - INFO - Total params: 262400.0
2021-03-02 16:11:23,667 - root - INFO - One epoch is 274 steps.
2021-03-02 16:11:23,668 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-02 16:11:23,670 - root - INFO - Load Embeddings of user_embeddings.weight, item_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-50/ml1m-bprmf-pretrained.ckpt.
2021-03-02 16:11:23,671 - root - INFO - Training.
2021-03-02 16:11:23,671 - root - INFO - train loss:0.0000!
2021-03-02 16:11:25,063 - root - INFO - f1:0.0711, p:0.0968, r:0.0749, hit:0.4443, ndcg:0.2685, topn:10.
2021-03-02 16:11:26,339 - root - INFO - f1:0.0777, p:0.1604, r:0.0624, hit:0.5716, ndcg:0.3622, topn:10.
2021-03-02 16:11:50,275 - root - INFO - train loss:77.9071!
2021-03-02 16:11:51,538 - root - INFO - f1:0.1433, p:0.1664, r:0.1788, hit:0.7137, ndcg:0.4464, topn:10.
2021-03-02 16:11:52,771 - root - INFO - f1:0.1702, p:0.2748, r:0.1625, hit:0.8547, ndcg:0.5747, topn:10.
2021-03-02 16:11:52,776 - root - INFO - Checkpointing ...
2021-03-02 16:12:15,477 - root - INFO - train loss:0.1732!
2021-03-02 16:12:16,747 - root - INFO - f1:0.1489, p:0.1732, r:0.1848, hit:0.7328, ndcg:0.4643, topn:10.
2021-03-02 16:12:18,120 - root - INFO - f1:0.1773, p:0.2862, r:0.1691, hit:0.8664, ndcg:0.5874, topn:10.
2021-03-02 16:12:18,125 - root - INFO - Checkpointing ...
2021-03-02 16:12:40,366 - root - INFO - train loss:0.1616!
2021-03-02 16:12:41,604 - root - INFO - f1:0.1506, p:0.1761, r:0.1850, hit:0.7349, ndcg:0.4729, topn:10.
2021-03-02 16:12:42,918 - root - INFO - f1:0.1818, p:0.2930, r:0.1734, hit:0.8738, ndcg:0.6000, topn:10.
2021-03-02 16:12:42,923 - root - INFO - Checkpointing ...
2021-03-02 16:13:05,826 - root - INFO - train loss:0.1557!
2021-03-02 16:13:07,127 - root - INFO - f1:0.1552, p:0.1809, r:0.1925, hit:0.7423, ndcg:0.4796, topn:10.
2021-03-02 16:13:08,470 - root - INFO - f1:0.1864, p:0.2998, r:0.1783, hit:0.8823, ndcg:0.6076, topn:10.
2021-03-02 16:13:08,477 - root - INFO - Checkpointing ...
2021-03-02 16:13:30,622 - root - INFO - train loss:0.1509!
2021-03-02 16:13:31,886 - root - INFO - f1:0.1579, p:0.1835, r:0.1958, hit:0.7497, ndcg:0.4884, topn:10.
2021-03-02 16:13:33,209 - root - INFO - f1:0.1893, p:0.3040, r:0.1809, hit:0.8823, ndcg:0.6116, topn:10.
2021-03-02 16:13:33,213 - root - INFO - Checkpointing ...
2021-03-02 16:13:56,319 - root - INFO - train loss:0.1470!
2021-03-02 16:13:57,573 - root - INFO - f1:0.1604, p:0.1861, r:0.1987, hit:0.7550, ndcg:0.4913, topn:10.
2021-03-02 16:13:58,898 - root - INFO - f1:0.1928, p:0.3084, r:0.1849, hit:0.8887, ndcg:0.6181, topn:10.
2021-03-02 16:13:58,902 - root - INFO - Checkpointing ...
2021-03-02 16:14:19,113 - root - INFO - train loss:0.1441!
2021-03-02 16:14:20,645 - root - INFO - f1:0.1617, p:0.1879, r:0.2002, hit:0.7550, ndcg:0.4943, topn:10.
2021-03-02 16:14:21,934 - root - INFO - f1:0.1957, p:0.3125, r:0.1880, hit:0.8918, ndcg:0.6235, topn:10.
2021-03-02 16:14:21,941 - root - INFO - Checkpointing ...
2021-03-02 16:14:42,491 - root - INFO - train loss:0.1412!
2021-03-02 16:14:43,762 - root - INFO - f1:0.1639, p:0.1900, r:0.2040, hit:0.7614, ndcg:0.5012, topn:10.
2021-03-02 16:14:45,140 - root - INFO - f1:0.1984, p:0.3164, r:0.1908, hit:0.8897, ndcg:0.6245, topn:10.
2021-03-02 16:14:45,144 - root - INFO - Checkpointing ...
2021-03-02 16:15:07,730 - root - INFO - train loss:0.1389!
2021-03-02 16:15:08,983 - root - INFO - f1:0.1652, p:0.1916, r:0.2046, hit:0.7614, ndcg:0.5028, topn:10.
2021-03-02 16:15:10,255 - root - INFO - f1:0.2017, p:0.3208, r:0.1940, hit:0.8961, ndcg:0.6283, topn:10.
2021-03-02 16:15:10,258 - root - INFO - Checkpointing ...
2021-03-02 16:15:31,052 - root - INFO - train loss:0.1368!
2021-03-02 16:15:32,371 - root - INFO - f1:0.1674, p:0.1942, r:0.2074, hit:0.7667, ndcg:0.5070, topn:10.
2021-03-02 16:15:33,678 - root - INFO - f1:0.2024, p:0.3214, r:0.1955, hit:0.8993, ndcg:0.6326, topn:10.
2021-03-02 16:15:33,683 - root - INFO - Checkpointing ...
2021-03-02 16:15:56,070 - root - INFO - train loss:0.1348!
2021-03-02 16:15:57,368 - root - INFO - f1:0.1694, p:0.1960, r:0.2102, hit:0.7731, ndcg:0.5102, topn:10.
2021-03-02 16:15:58,699 - root - INFO - f1:0.2047, p:0.3246, r:0.1974, hit:0.8993, ndcg:0.6346, topn:10.
2021-03-02 16:15:58,704 - root - INFO - Checkpointing ...
2021-03-02 16:16:19,775 - root - INFO - train loss:0.1337!
2021-03-02 16:16:21,003 - root - INFO - f1:0.1698, p:0.1971, r:0.2104, hit:0.7688, ndcg:0.5128, topn:10.
2021-03-02 16:16:22,341 - root - INFO - f1:0.2069, p:0.3273, r:0.1997, hit:0.8993, ndcg:0.6384, topn:10.
2021-03-02 16:16:22,346 - root - INFO - Checkpointing ...
2021-03-02 16:16:45,593 - root - INFO - train loss:0.1322!
2021-03-02 16:16:46,905 - root - INFO - f1:0.1710, p:0.1983, r:0.2143, hit:0.7709, ndcg:0.5158, topn:10.
2021-03-02 16:16:48,152 - root - INFO - f1:0.2074, p:0.3293, r:0.1998, hit:0.8982, ndcg:0.6405, topn:10.
2021-03-02 16:16:48,156 - root - INFO - Checkpointing ...
2021-03-02 16:17:09,994 - root - INFO - train loss:0.1305!
2021-03-02 16:17:11,219 - root - INFO - f1:0.1713, p:0.1988, r:0.2144, hit:0.7688, ndcg:0.5176, topn:10.
2021-03-02 16:17:12,552 - root - INFO - f1:0.2097, p:0.3322, r:0.2031, hit:0.9014, ndcg:0.6430, topn:10.
2021-03-02 16:17:12,556 - root - INFO - Checkpointing ...
2021-03-02 16:17:35,997 - root - INFO - train loss:0.1292!
2021-03-02 16:17:37,139 - root - INFO - f1:0.1729, p:0.2005, r:0.2165, hit:0.7699, ndcg:0.5198, topn:10.
2021-03-02 16:17:38,393 - root - INFO - f1:0.2102, p:0.3334, r:0.2027, hit:0.8971, ndcg:0.6442, topn:10.
2021-03-02 16:17:38,397 - root - INFO - Checkpointing ...
2021-03-02 16:18:00,684 - root - INFO - train loss:0.1280!
2021-03-02 16:18:02,021 - root - INFO - f1:0.1740, p:0.2018, r:0.2174, hit:0.7699, ndcg:0.5224, topn:10.
2021-03-02 16:18:03,360 - root - INFO - f1:0.2110, p:0.3346, r:0.2033, hit:0.9003, ndcg:0.6474, topn:10.
2021-03-02 16:18:03,365 - root - INFO - Checkpointing ...
2021-03-02 16:18:23,499 - root - INFO - train loss:0.1272!
2021-03-02 16:18:24,874 - root - INFO - f1:0.1771, p:0.2048, r:0.2219, hit:0.7784, ndcg:0.5254, topn:10.
2021-03-02 16:18:26,161 - root - INFO - f1:0.2121, p:0.3366, r:0.2040, hit:0.8982, ndcg:0.6493, topn:10.
2021-03-02 16:18:26,166 - root - INFO - Checkpointing ...
2021-03-02 16:18:50,329 - root - INFO - train loss:0.1262!
2021-03-02 16:18:51,644 - root - INFO - f1:0.1771, p:0.2052, r:0.2206, hit:0.7784, ndcg:0.5263, topn:10.
2021-03-02 16:18:52,874 - root - INFO - f1:0.2134, p:0.3376, r:0.2054, hit:0.9024, ndcg:0.6521, topn:10.
2021-03-02 16:18:52,878 - root - INFO - Checkpointing ...
2021-03-02 16:19:13,980 - root - INFO - train loss:0.1254!
2021-03-02 16:19:15,302 - root - INFO - f1:0.1796, p:0.2076, r:0.2246, hit:0.7837, ndcg:0.5278, topn:10.
2021-03-02 16:19:16,605 - root - INFO - f1:0.2140, p:0.3387, r:0.2060, hit:0.9014, ndcg:0.6539, topn:10.
2021-03-02 16:19:16,609 - root - INFO - Checkpointing ...
2021-03-02 16:19:38,033 - root - INFO - train loss:0.1242!
2021-03-02 16:19:39,592 - root - INFO - f1:0.1795, p:0.2071, r:0.2249, hit:0.7847, ndcg:0.5298, topn:10.
2021-03-02 16:19:40,858 - root - INFO - f1:0.2151, p:0.3407, r:0.2069, hit:0.9014, ndcg:0.6554, topn:10.
2021-03-02 16:19:40,863 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:20:03,929 - root - INFO - train loss:0.1276!
2021-03-02 16:20:05,199 - root - INFO - f1:0.1863, p:0.2147, r:0.2338, hit:0.7869, ndcg:0.5385, topn:10.
2021-03-02 16:20:06,576 - root - INFO - f1:0.2212, p:0.3505, r:0.2127, hit:0.9024, ndcg:0.6698, topn:10.
2021-03-02 16:20:06,580 - root - INFO - Checkpointing ...
2021-03-02 16:20:28,215 - root - INFO - train loss:0.1209!
2021-03-02 16:20:29,560 - root - INFO - f1:0.1894, p:0.2182, r:0.2392, hit:0.7996, ndcg:0.5496, topn:10.
2021-03-02 16:20:30,788 - root - INFO - f1:0.2270, p:0.3583, r:0.2184, hit:0.9077, ndcg:0.6788, topn:10.
2021-03-02 16:20:30,791 - root - INFO - Checkpointing ...
2021-03-02 16:20:51,626 - root - INFO - train loss:0.1177!
2021-03-02 16:20:52,940 - root - INFO - f1:0.1931, p:0.2216, r:0.2442, hit:0.8049, ndcg:0.5549, topn:10.
2021-03-02 16:20:54,203 - root - INFO - f1:0.2281, p:0.3615, r:0.2185, hit:0.9046, ndcg:0.6808, topn:10.
2021-03-02 16:20:54,207 - root - INFO - Checkpointing ...
2021-03-02 16:21:16,726 - root - INFO - train loss:0.1164!
2021-03-02 16:21:18,039 - root - INFO - f1:0.1957, p:0.2241, r:0.2481, hit:0.8081, ndcg:0.5573, topn:10.
2021-03-02 16:21:19,391 - root - INFO - f1:0.2290, p:0.3629, r:0.2195, hit:0.9067, ndcg:0.6860, topn:10.
2021-03-02 16:21:19,395 - root - INFO - Checkpointing ...
2021-03-02 16:21:40,760 - root - INFO - train loss:0.1145!
2021-03-02 16:21:42,116 - root - INFO - f1:0.1956, p:0.2243, r:0.2466, hit:0.8070, ndcg:0.5587, topn:10.
2021-03-02 16:21:43,355 - root - INFO - f1:0.2303, p:0.3649, r:0.2204, hit:0.9056, ndcg:0.6887, topn:10.
2021-03-02 16:21:43,360 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:22:04,585 - root - INFO - train loss:0.1162!
2021-03-02 16:22:05,946 - root - INFO - f1:0.1947, p:0.2242, r:0.2445, hit:0.7964, ndcg:0.5618, topn:10.
2021-03-02 16:22:07,236 - root - INFO - f1:0.2309, p:0.3653, r:0.2207, hit:0.9088, ndcg:0.6954, topn:10.
2021-03-02 16:22:07,239 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:22:27,515 - root - INFO - train loss:0.1138!
2021-03-02 16:22:28,822 - root - INFO - f1:0.1937, p:0.2235, r:0.2433, hit:0.7953, ndcg:0.5649, topn:10.
2021-03-02 16:22:30,119 - root - INFO - f1:0.2326, p:0.3678, r:0.2227, hit:0.9120, ndcg:0.6982, topn:10.
2021-03-02 16:22:30,123 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:22:51,685 - root - INFO - train loss:0.1126!
2021-03-02 16:22:52,948 - root - INFO - f1:0.1952, p:0.2249, r:0.2451, hit:0.8017, ndcg:0.5675, topn:10.
2021-03-02 16:22:54,251 - root - INFO - f1:0.2328, p:0.3684, r:0.2225, hit:0.9120, ndcg:0.7001, topn:10.
2021-03-02 16:22:54,256 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:23:16,657 - root - INFO - train loss:0.1119!
2021-03-02 16:23:17,951 - root - INFO - f1:0.1939, p:0.2240, r:0.2431, hit:0.7975, ndcg:0.5690, topn:10.
2021-03-02 16:23:19,179 - root - INFO - f1:0.2332, p:0.3689, r:0.2232, hit:0.9120, ndcg:0.7005, topn:10.
2021-03-02 16:23:19,182 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 16:23:19,226 - root - INFO - No improvement after 13317 steps. Stopping training.
2021-03-02 16:23:20,908 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.22386, 'RECALL@10': 0.243174, 'NDCG@10': 0.56816, 'MAP@10': 0.456775, 'MAP': 0.456775}.
2021-03-02 16:23:21,178 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.473224, 'GENRE_REDUNDANCY@10': 0.428432, 'ILD_GENRE@10': 0.810102}.
2021-03-02 16:23:22,951 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.368505, 'RECALL@10': 0.222639, 'NDCG@10': 0.700775, 'MAP@10': 0.597313, 'MAP': 0.597313}.
2021-03-02 16:23:23,145 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.469733, 'GENRE_REDUNDANCY@10': 0.424187, 'ILD_GENRE@10': 0.809208}.
