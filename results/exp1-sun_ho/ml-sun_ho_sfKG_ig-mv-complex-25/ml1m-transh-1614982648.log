2021-03-05 19:17:28,463 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-25/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-25/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614982648",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-25/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-25/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-05 19:17:28,477 - root - INFO - Totally 3145 train triples, 389,765 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-25/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-25/cao-format/ml1m/kg/test.dat!
2021-03-05 19:17:28,479 - root - INFO - successfully load 1654 entities and 3 relations!
2021-03-05 19:17:28,484 - root - INFO - Building model.
2021-03-05 19:17:29,749 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(1654, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-05 19:17:29,749 - root - INFO - Total params: 166000.0
2021-03-05 19:17:29,749 - root - INFO - One epoch is 13 steps.
2021-03-05 19:17:29,749 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-05 19:17:29,752 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-25/ml1m-transe-pretrained.ckpt.
2021-03-05 19:17:29,752 - root - INFO - Training.
2021-03-05 19:17:29,752 - root - INFO - train loss:0.0000!
2021-03-05 19:17:30,429 - root - INFO - head hit:0.2905, head mean rank:355.2982, topn:10.
2021-03-05 19:17:30,430 - root - INFO - tail hit:0.7918, tail mean rank:15.7352, topn:10.
2021-03-05 19:17:30,430 - root - INFO - avg hit:0.5411, avg mean rank:185.5167, topn:10.
2021-03-05 19:17:31,302 - root - INFO - head hit:0.2993, head mean rank:325.7176, topn:10.
2021-03-05 19:17:31,303 - root - INFO - tail hit:0.7869, tail mean rank:14.7778, topn:10.
2021-03-05 19:17:31,303 - root - INFO - avg hit:0.5431, avg mean rank:170.2477, topn:10.
2021-03-05 19:18:10,386 - root - INFO - train loss:0.0239!
2021-03-05 19:18:11,004 - root - INFO - head hit:0.2931, head mean rank:346.2802, topn:10.
2021-03-05 19:18:11,004 - root - INFO - tail hit:0.7069, tail mean rank:20.4730, topn:10.
2021-03-05 19:18:11,004 - root - INFO - avg hit:0.5000, avg mean rank:183.3766, topn:10.
2021-03-05 19:18:11,994 - root - INFO - head hit:0.3137, head mean rank:322.9150, topn:10.
2021-03-05 19:18:11,994 - root - INFO - tail hit:0.7229, tail mean rank:21.4680, topn:10.
2021-03-05 19:18:11,994 - root - INFO - avg hit:0.5183, avg mean rank:172.1915, topn:10.
2021-03-05 19:18:11,995 - root - INFO - Checkpointing ...
2021-03-05 19:18:47,794 - root - INFO - train loss:0.0315!
2021-03-05 19:18:48,373 - root - INFO - head hit:0.2596, head mean rank:351.6581, topn:10.
2021-03-05 19:18:48,373 - root - INFO - tail hit:0.6941, tail mean rank:27.9614, topn:10.
2021-03-05 19:18:48,374 - root - INFO - avg hit:0.4769, avg mean rank:189.8098, topn:10.
2021-03-05 19:18:49,280 - root - INFO - head hit:0.2732, head mean rank:328.9712, topn:10.
2021-03-05 19:18:49,280 - root - INFO - tail hit:0.6928, tail mean rank:27.2405, topn:10.
2021-03-05 19:18:49,280 - root - INFO - avg hit:0.4830, avg mean rank:178.1059, topn:10.
2021-03-05 19:18:49,281 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 19:19:25,351 - root - INFO - train loss:0.0074!
2021-03-05 19:19:26,003 - root - INFO - head hit:0.2982, head mean rank:347.9049, topn:10.
2021-03-05 19:19:26,003 - root - INFO - tail hit:0.7404, tail mean rank:21.6118, topn:10.
2021-03-05 19:19:26,003 - root - INFO - avg hit:0.5193, avg mean rank:184.7584, topn:10.
2021-03-05 19:19:26,962 - root - INFO - head hit:0.3124, head mean rank:332.7451, topn:10.
2021-03-05 19:19:26,962 - root - INFO - tail hit:0.7346, tail mean rank:20.8013, topn:10.
2021-03-05 19:19:26,962 - root - INFO - avg hit:0.5235, avg mean rank:176.7732, topn:10.
2021-03-05 19:19:26,963 - root - INFO - Checkpointing ...
2021-03-05 19:20:06,382 - root - INFO - train loss:0.0028!
2021-03-05 19:20:07,014 - root - INFO - head hit:0.3162, head mean rank:336.2519, topn:10.
2021-03-05 19:20:07,015 - root - INFO - tail hit:0.7481, tail mean rank:21.2802, topn:10.
2021-03-05 19:20:07,015 - root - INFO - avg hit:0.5321, avg mean rank:178.7661, topn:10.
2021-03-05 19:20:07,952 - root - INFO - head hit:0.3307, head mean rank:325.2092, topn:10.
2021-03-05 19:20:07,953 - root - INFO - tail hit:0.7255, tail mean rank:20.5974, topn:10.
2021-03-05 19:20:07,953 - root - INFO - avg hit:0.5281, avg mean rank:172.9033, topn:10.
2021-03-05 19:20:07,954 - root - INFO - Checkpointing ...
2021-03-05 19:20:42,675 - root - INFO - train loss:0.0022!
2021-03-05 19:20:43,333 - root - INFO - head hit:0.3008, head mean rank:344.6812, topn:10.
2021-03-05 19:20:43,333 - root - INFO - tail hit:0.7224, tail mean rank:17.4679, topn:10.
2021-03-05 19:20:43,333 - root - INFO - avg hit:0.5116, avg mean rank:181.0746, topn:10.
2021-03-05 19:20:44,162 - root - INFO - head hit:0.3333, head mean rank:322.4039, topn:10.
2021-03-05 19:20:44,163 - root - INFO - tail hit:0.7268, tail mean rank:17.1725, topn:10.
2021-03-05 19:20:44,163 - root - INFO - avg hit:0.5301, avg mean rank:169.7882, topn:10.
2021-03-05 19:20:44,164 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 19:21:20,409 - root - INFO - train loss:0.0009!
2021-03-05 19:21:21,063 - root - INFO - head hit:0.3111, head mean rank:344.9049, topn:10.
2021-03-05 19:21:21,064 - root - INFO - tail hit:0.7429, tail mean rank:15.9306, topn:10.
2021-03-05 19:21:21,064 - root - INFO - avg hit:0.5270, avg mean rank:180.4177, topn:10.
2021-03-05 19:21:22,003 - root - INFO - head hit:0.3268, head mean rank:319.5203, topn:10.
2021-03-05 19:21:22,003 - root - INFO - tail hit:0.7595, tail mean rank:15.6680, topn:10.
2021-03-05 19:21:22,004 - root - INFO - avg hit:0.5431, avg mean rank:167.5941, topn:10.
2021-03-05 19:21:22,004 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 19:21:58,337 - root - INFO - train loss:0.0005!
2021-03-05 19:21:58,883 - root - INFO - head hit:0.3136, head mean rank:344.3419, topn:10.
2021-03-05 19:21:58,883 - root - INFO - tail hit:0.7558, tail mean rank:15.9254, topn:10.
2021-03-05 19:21:58,883 - root - INFO - avg hit:0.5347, avg mean rank:180.1337, topn:10.
2021-03-05 19:21:59,834 - root - INFO - head hit:0.3320, head mean rank:319.2026, topn:10.
2021-03-05 19:21:59,835 - root - INFO - tail hit:0.7634, tail mean rank:15.5922, topn:10.
2021-03-05 19:21:59,835 - root - INFO - avg hit:0.5477, avg mean rank:167.3974, topn:10.
2021-03-05 19:21:59,836 - root - INFO - Checkpointing ...
2021-03-05 19:22:37,614 - root - INFO - train loss:0.0002!
2021-03-05 19:22:38,271 - root - INFO - head hit:0.3290, head mean rank:343.3830, topn:10.
2021-03-05 19:22:38,272 - root - INFO - tail hit:0.7609, tail mean rank:15.8869, topn:10.
2021-03-05 19:22:38,272 - root - INFO - avg hit:0.5450, avg mean rank:179.6350, topn:10.
2021-03-05 19:22:39,200 - root - INFO - head hit:0.3477, head mean rank:317.8876, topn:10.
2021-03-05 19:22:39,200 - root - INFO - tail hit:0.7608, tail mean rank:15.5203, topn:10.
2021-03-05 19:22:39,200 - root - INFO - avg hit:0.5542, avg mean rank:166.7039, topn:10.
2021-03-05 19:22:39,201 - root - INFO - Checkpointing ...
2021-03-05 19:23:15,766 - root - INFO - train loss:0.0001!
2021-03-05 19:23:16,407 - root - INFO - head hit:0.3316, head mean rank:344.4267, topn:10.
2021-03-05 19:23:16,408 - root - INFO - tail hit:0.7635, tail mean rank:15.2725, topn:10.
2021-03-05 19:23:16,408 - root - INFO - avg hit:0.5476, avg mean rank:179.8496, topn:10.
2021-03-05 19:23:17,349 - root - INFO - head hit:0.3477, head mean rank:317.9346, topn:10.
2021-03-05 19:23:17,353 - root - INFO - tail hit:0.7621, tail mean rank:15.3712, topn:10.
2021-03-05 19:23:17,353 - root - INFO - avg hit:0.5549, avg mean rank:166.6529, topn:10.
2021-03-05 19:23:17,354 - root - INFO - Checkpointing ...
2021-03-05 19:23:52,558 - root - INFO - train loss:0.0001!
2021-03-05 19:23:53,159 - root - INFO - head hit:0.3316, head mean rank:343.7044, topn:10.
2021-03-05 19:23:53,160 - root - INFO - tail hit:0.7558, tail mean rank:15.4833, topn:10.
2021-03-05 19:23:53,160 - root - INFO - avg hit:0.5437, avg mean rank:179.5938, topn:10.
2021-03-05 19:23:54,053 - root - INFO - head hit:0.3490, head mean rank:317.8523, topn:10.
2021-03-05 19:23:54,053 - root - INFO - tail hit:0.7634, tail mean rank:15.4261, topn:10.
2021-03-05 19:23:54,053 - root - INFO - avg hit:0.5562, avg mean rank:166.6392, topn:10.
2021-03-05 19:23:54,054 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 19:24:29,485 - root - INFO - train loss:0.0000!
2021-03-05 19:24:30,148 - root - INFO - head hit:0.3316, head mean rank:343.7995, topn:10.
2021-03-05 19:24:30,148 - root - INFO - tail hit:0.7532, tail mean rank:15.5604, topn:10.
2021-03-05 19:24:30,148 - root - INFO - avg hit:0.5424, avg mean rank:179.6799, topn:10.
2021-03-05 19:24:31,074 - root - INFO - head hit:0.3490, head mean rank:317.5922, topn:10.
2021-03-05 19:24:31,075 - root - INFO - tail hit:0.7634, tail mean rank:15.5150, topn:10.
2021-03-05 19:24:31,075 - root - INFO - avg hit:0.5562, avg mean rank:166.5536, topn:10.
2021-03-05 19:24:31,076 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 19:25:08,597 - root - INFO - train loss:0.0001!
2021-03-05 19:25:09,192 - root - INFO - head hit:0.3290, head mean rank:343.6350, topn:10.
2021-03-05 19:25:09,192 - root - INFO - tail hit:0.7609, tail mean rank:15.5064, topn:10.
2021-03-05 19:25:09,193 - root - INFO - avg hit:0.5450, avg mean rank:179.5707, topn:10.
2021-03-05 19:25:10,166 - root - INFO - head hit:0.3490, head mean rank:317.6575, topn:10.
2021-03-05 19:25:10,166 - root - INFO - tail hit:0.7634, tail mean rank:15.5739, topn:10.
2021-03-05 19:25:10,166 - root - INFO - avg hit:0.5562, avg mean rank:166.6157, topn:10.
2021-03-05 19:25:10,167 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 19:25:47,640 - root - INFO - train loss:0.0000!
2021-03-05 19:25:48,289 - root - INFO - head hit:0.3290, head mean rank:343.5733, topn:10.
2021-03-05 19:25:48,290 - root - INFO - tail hit:0.7609, tail mean rank:15.5064, topn:10.
2021-03-05 19:25:48,290 - root - INFO - avg hit:0.5450, avg mean rank:179.5398, topn:10.
2021-03-05 19:25:49,190 - root - INFO - head hit:0.3490, head mean rank:317.6719, topn:10.
2021-03-05 19:25:49,190 - root - INFO - tail hit:0.7634, tail mean rank:15.5961, topn:10.
2021-03-05 19:25:49,190 - root - INFO - avg hit:0.5562, avg mean rank:166.6340, topn:10.
2021-03-05 19:25:49,191 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 19:26:27,272 - root - INFO - No improvement after 24363 steps. Stopping training.
