2021-03-06 01:49:44,953 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-75/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-75/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1615006184",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-75/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-75/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-06 01:49:44,966 - root - INFO - Totally 2962 train triples, 332,699 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-75/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-75/cao-format/ml1m/kg/test.dat!
2021-03-06 01:49:44,968 - root - INFO - successfully load 1575 entities and 3 relations!
2021-03-06 01:49:44,972 - root - INFO - Building model.
2021-03-06 01:49:46,244 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(1575, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-06 01:49:46,244 - root - INFO - Total params: 158100.0
2021-03-06 01:49:46,245 - root - INFO - One epoch is 12 steps.
2021-03-06 01:49:46,245 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-06 01:49:46,247 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-75/ml1m-transe-pretrained.ckpt.
2021-03-06 01:49:46,247 - root - INFO - Training.
2021-03-06 01:49:46,247 - root - INFO - train loss:0.0000!
2021-03-06 01:49:46,998 - root - INFO - head hit:0.2922, head mean rank:380.8946, topn:10.
2021-03-06 01:49:46,999 - root - INFO - tail hit:0.7741, tail mean rank:10.1355, topn:10.
2021-03-06 01:49:46,999 - root - INFO - avg hit:0.5331, avg mean rank:195.5151, topn:10.
2021-03-06 01:49:47,922 - root - INFO - head hit:0.2489, head mean rank:375.2489, topn:10.
2021-03-06 01:49:47,923 - root - INFO - tail hit:0.7711, tail mean rank:11.8569, topn:10.
2021-03-06 01:49:47,923 - root - INFO - avg hit:0.5100, avg mean rank:193.5529, topn:10.
2021-03-06 01:50:27,420 - root - INFO - train loss:0.0231!
2021-03-06 01:50:27,966 - root - INFO - head hit:0.2470, head mean rank:377.9337, topn:10.
2021-03-06 01:50:27,966 - root - INFO - tail hit:0.6988, tail mean rank:15.9217, topn:10.
2021-03-06 01:50:27,966 - root - INFO - avg hit:0.4729, avg mean rank:196.9277, topn:10.
2021-03-06 01:50:28,828 - root - INFO - head hit:0.2103, head mean rank:381.4449, topn:10.
2021-03-06 01:50:28,828 - root - INFO - tail hit:0.6938, tail mean rank:18.2275, topn:10.
2021-03-06 01:50:28,828 - root - INFO - avg hit:0.4521, avg mean rank:199.8362, topn:10.
2021-03-06 01:50:28,829 - root - INFO - Checkpointing ...
2021-03-06 01:51:06,719 - root - INFO - train loss:0.0375!
2021-03-06 01:51:07,335 - root - INFO - head hit:0.2169, head mean rank:397.4337, topn:10.
2021-03-06 01:51:07,336 - root - INFO - tail hit:0.7470, tail mean rank:13.4488, topn:10.
2021-03-06 01:51:07,336 - root - INFO - avg hit:0.4819, avg mean rank:205.4413, topn:10.
2021-03-06 01:51:08,236 - root - INFO - head hit:0.2046, head mean rank:377.9986, topn:10.
2021-03-06 01:51:08,236 - root - INFO - tail hit:0.7368, tail mean rank:16.4936, topn:10.
2021-03-06 01:51:08,236 - root - INFO - avg hit:0.4707, avg mean rank:197.2461, topn:10.
2021-03-06 01:51:08,237 - root - INFO - Checkpointing ...
2021-03-06 01:51:46,058 - root - INFO - train loss:0.0235!
2021-03-06 01:51:46,678 - root - INFO - head hit:0.2319, head mean rank:381.8072, topn:10.
2021-03-06 01:51:46,679 - root - INFO - tail hit:0.7410, tail mean rank:14.4669, topn:10.
2021-03-06 01:51:46,679 - root - INFO - avg hit:0.4864, avg mean rank:198.1370, topn:10.
2021-03-06 01:51:47,493 - root - INFO - head hit:0.2146, head mean rank:368.4220, topn:10.
2021-03-06 01:51:47,494 - root - INFO - tail hit:0.7010, tail mean rank:18.8999, topn:10.
2021-03-06 01:51:47,494 - root - INFO - avg hit:0.4578, avg mean rank:193.6609, topn:10.
2021-03-06 01:51:47,494 - root - INFO - Checkpointing ...
2021-03-06 01:52:25,553 - root - INFO - train loss:0.0206!
2021-03-06 01:52:26,044 - root - INFO - head hit:0.2349, head mean rank:362.7651, topn:10.
2021-03-06 01:52:26,044 - root - INFO - tail hit:0.7108, tail mean rank:17.9819, topn:10.
2021-03-06 01:52:26,044 - root - INFO - avg hit:0.4729, avg mean rank:190.3735, topn:10.
2021-03-06 01:52:26,936 - root - INFO - head hit:0.2403, head mean rank:351.1516, topn:10.
2021-03-06 01:52:26,936 - root - INFO - tail hit:0.6681, tail mean rank:23.3848, topn:10.
2021-03-06 01:52:26,937 - root - INFO - avg hit:0.4542, avg mean rank:187.2682, topn:10.
2021-03-06 01:52:26,937 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-06 01:53:05,329 - root - INFO - train loss:0.0046!
2021-03-06 01:53:05,813 - root - INFO - head hit:0.2681, head mean rank:372.0633, topn:10.
2021-03-06 01:53:05,814 - root - INFO - tail hit:0.7199, tail mean rank:12.8584, topn:10.
2021-03-06 01:53:05,814 - root - INFO - avg hit:0.4940, avg mean rank:192.4608, topn:10.
2021-03-06 01:53:06,744 - root - INFO - head hit:0.2632, head mean rank:355.5250, topn:10.
2021-03-06 01:53:06,745 - root - INFO - tail hit:0.7167, tail mean rank:15.8641, topn:10.
2021-03-06 01:53:06,745 - root - INFO - avg hit:0.4900, avg mean rank:185.6946, topn:10.
2021-03-06 01:53:06,745 - root - INFO - Checkpointing ...
2021-03-06 01:53:41,661 - root - INFO - train loss:0.0021!
2021-03-06 01:53:42,232 - root - INFO - head hit:0.2741, head mean rank:375.9789, topn:10.
2021-03-06 01:53:42,233 - root - INFO - tail hit:0.7169, tail mean rank:12.3614, topn:10.
2021-03-06 01:53:42,233 - root - INFO - avg hit:0.4955, avg mean rank:194.1702, topn:10.
2021-03-06 01:53:43,084 - root - INFO - head hit:0.2690, head mean rank:353.8255, topn:10.
2021-03-06 01:53:43,085 - root - INFO - tail hit:0.7382, tail mean rank:13.7754, topn:10.
2021-03-06 01:53:43,085 - root - INFO - avg hit:0.5036, avg mean rank:183.8004, topn:10.
2021-03-06 01:53:43,085 - root - INFO - Checkpointing ...
2021-03-06 01:54:18,894 - root - INFO - train loss:0.0012!
2021-03-06 01:54:19,439 - root - INFO - head hit:0.2651, head mean rank:370.0392, topn:10.
2021-03-06 01:54:19,440 - root - INFO - tail hit:0.7199, tail mean rank:14.5873, topn:10.
2021-03-06 01:54:19,440 - root - INFO - avg hit:0.4925, avg mean rank:192.3133, topn:10.
2021-03-06 01:54:20,231 - root - INFO - head hit:0.2504, head mean rank:347.6338, topn:10.
2021-03-06 01:54:20,231 - root - INFO - tail hit:0.7468, tail mean rank:15.4449, topn:10.
2021-03-06 01:54:20,232 - root - INFO - avg hit:0.4986, avg mean rank:181.5393, topn:10.
2021-03-06 01:54:20,232 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-06 01:54:57,268 - root - INFO - train loss:0.0006!
2021-03-06 01:54:57,798 - root - INFO - head hit:0.2952, head mean rank:371.1807, topn:10.
2021-03-06 01:54:57,799 - root - INFO - tail hit:0.7229, tail mean rank:15.1265, topn:10.
2021-03-06 01:54:57,799 - root - INFO - avg hit:0.5090, avg mean rank:193.1536, topn:10.
2021-03-06 01:54:58,707 - root - INFO - head hit:0.2833, head mean rank:345.0329, topn:10.
2021-03-06 01:54:58,707 - root - INFO - tail hit:0.7496, tail mean rank:16.8927, topn:10.
2021-03-06 01:54:58,708 - root - INFO - avg hit:0.5165, avg mean rank:180.9628, topn:10.
2021-03-06 01:54:58,708 - root - INFO - Checkpointing ...
2021-03-06 01:55:36,231 - root - INFO - train loss:0.0002!
2021-03-06 01:55:36,867 - root - INFO - head hit:0.3102, head mean rank:373.2169, topn:10.
2021-03-06 01:55:36,867 - root - INFO - tail hit:0.7410, tail mean rank:13.3373, topn:10.
2021-03-06 01:55:36,867 - root - INFO - avg hit:0.5256, avg mean rank:193.2771, topn:10.
2021-03-06 01:55:37,767 - root - INFO - head hit:0.2890, head mean rank:345.3991, topn:10.
2021-03-06 01:55:37,768 - root - INFO - tail hit:0.7468, tail mean rank:14.7268, topn:10.
2021-03-06 01:55:37,768 - root - INFO - avg hit:0.5179, avg mean rank:180.0629, topn:10.
2021-03-06 01:55:37,768 - root - INFO - Checkpointing ...
2021-03-06 01:56:13,200 - root - INFO - train loss:0.0001!
2021-03-06 01:56:13,817 - root - INFO - head hit:0.2952, head mean rank:375.7289, topn:10.
2021-03-06 01:56:13,818 - root - INFO - tail hit:0.7530, tail mean rank:12.8705, topn:10.
2021-03-06 01:56:13,818 - root - INFO - avg hit:0.5241, avg mean rank:194.2997, topn:10.
2021-03-06 01:56:14,731 - root - INFO - head hit:0.2747, head mean rank:346.4807, topn:10.
2021-03-06 01:56:14,731 - root - INFO - tail hit:0.7539, tail mean rank:13.9213, topn:10.
2021-03-06 01:56:14,731 - root - INFO - avg hit:0.5143, avg mean rank:180.2010, topn:10.
2021-03-06 01:56:14,732 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-06 01:56:48,710 - root - INFO - train loss:0.0001!
2021-03-06 01:56:49,300 - root - INFO - head hit:0.2861, head mean rank:375.3795, topn:10.
2021-03-06 01:56:49,300 - root - INFO - tail hit:0.7681, tail mean rank:12.9970, topn:10.
2021-03-06 01:56:49,300 - root - INFO - avg hit:0.5271, avg mean rank:194.1883, topn:10.
2021-03-06 01:56:50,165 - root - INFO - head hit:0.2847, head mean rank:347.2718, topn:10.
2021-03-06 01:56:50,165 - root - INFO - tail hit:0.7568, tail mean rank:13.9557, topn:10.
2021-03-06 01:56:50,165 - root - INFO - avg hit:0.5207, avg mean rank:180.6137, topn:10.
2021-03-06 01:56:50,165 - root - INFO - Checkpointing ...
2021-03-06 01:57:27,510 - root - INFO - train loss:0.0001!
2021-03-06 01:57:28,094 - root - INFO - head hit:0.2711, head mean rank:375.8765, topn:10.
2021-03-06 01:57:28,094 - root - INFO - tail hit:0.7560, tail mean rank:12.7199, topn:10.
2021-03-06 01:57:28,094 - root - INFO - avg hit:0.5136, avg mean rank:194.2982, topn:10.
2021-03-06 01:57:28,972 - root - INFO - head hit:0.2690, head mean rank:348.2346, topn:10.
2021-03-06 01:57:28,972 - root - INFO - tail hit:0.7539, tail mean rank:13.9413, topn:10.
2021-03-06 01:57:28,972 - root - INFO - avg hit:0.5114, avg mean rank:181.0880, topn:10.
2021-03-06 01:57:28,973 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-06 01:58:05,833 - root - INFO - train loss:0.0001!
2021-03-06 01:58:06,398 - root - INFO - head hit:0.2711, head mean rank:375.9006, topn:10.
2021-03-06 01:58:06,398 - root - INFO - tail hit:0.7590, tail mean rank:12.3825, topn:10.
2021-03-06 01:58:06,398 - root - INFO - avg hit:0.5151, avg mean rank:194.1416, topn:10.
2021-03-06 01:58:07,249 - root - INFO - head hit:0.2690, head mean rank:347.6896, topn:10.
2021-03-06 01:58:07,249 - root - INFO - tail hit:0.7568, tail mean rank:13.5680, topn:10.
2021-03-06 01:58:07,250 - root - INFO - avg hit:0.5129, avg mean rank:180.6288, topn:10.
2021-03-06 01:58:07,250 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-06 01:58:43,885 - root - INFO - train loss:0.0000!
2021-03-06 01:58:44,497 - root - INFO - head hit:0.2801, head mean rank:376.3373, topn:10.
2021-03-06 01:58:44,498 - root - INFO - tail hit:0.7560, tail mean rank:12.3614, topn:10.
2021-03-06 01:58:44,498 - root - INFO - avg hit:0.5181, avg mean rank:194.3494, topn:10.
2021-03-06 01:58:45,353 - root - INFO - head hit:0.2718, head mean rank:347.7468, topn:10.
2021-03-06 01:58:45,354 - root - INFO - tail hit:0.7582, tail mean rank:13.5808, topn:10.
2021-03-06 01:58:45,354 - root - INFO - avg hit:0.5150, avg mean rank:180.6638, topn:10.
2021-03-06 01:58:45,354 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-06 01:59:23,353 - root - INFO - train loss:0.0000!
2021-03-06 01:59:23,853 - root - INFO - head hit:0.2801, head mean rank:376.2048, topn:10.
2021-03-06 01:59:23,853 - root - INFO - tail hit:0.7560, tail mean rank:12.3675, topn:10.
2021-03-06 01:59:23,853 - root - INFO - avg hit:0.5181, avg mean rank:194.2861, topn:10.
2021-03-06 01:59:24,726 - root - INFO - head hit:0.2704, head mean rank:347.6166, topn:10.
2021-03-06 01:59:24,726 - root - INFO - tail hit:0.7582, tail mean rank:13.6066, topn:10.
2021-03-06 01:59:24,726 - root - INFO - avg hit:0.5143, avg mean rank:180.6116, topn:10.
2021-03-06 01:59:24,727 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-06 02:00:00,858 - root - INFO - No improvement after 24363 steps. Stopping training.
