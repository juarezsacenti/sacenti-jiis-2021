2021-03-04 22:20:02,198 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-75/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-75/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614907202",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-75/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-75/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-04 22:20:02,240 - root - INFO - Totally 7762 train triples, 804,1636 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-75/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-75/cao-format/ml1m/kg/test.dat!
2021-03-04 22:20:02,244 - root - INFO - successfully load 4730 entities and 3 relations!
2021-03-04 22:20:02,253 - root - INFO - Building model.
2021-03-04 22:20:03,639 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(4730, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-04 22:20:03,639 - root - INFO - Total params: 473600.0
2021-03-04 22:20:03,639 - root - INFO - One epoch is 31 steps.
2021-03-04 22:20:03,639 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-04 22:20:03,644 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-75/ml1m-transe-pretrained.ckpt.
2021-03-04 22:20:03,644 - root - INFO - Training.
2021-03-04 22:20:03,644 - root - INFO - train loss:0.0000!
2021-03-04 22:20:05,188 - root - INFO - head hit:0.1517, head mean rank:799.4005, topn:10.
2021-03-04 22:20:05,189 - root - INFO - tail hit:0.3955, tail mean rank:445.0012, topn:10.
2021-03-04 22:20:05,189 - root - INFO - avg hit:0.2736, avg mean rank:622.2009, topn:10.
2021-03-04 22:20:08,200 - root - INFO - head hit:0.1608, head mean rank:735.7683, topn:10.
2021-03-04 22:20:08,201 - root - INFO - tail hit:0.4132, tail mean rank:435.2488, topn:10.
2021-03-04 22:20:08,201 - root - INFO - avg hit:0.2870, avg mean rank:585.5086, topn:10.
2021-03-04 22:20:43,175 - root - INFO - train loss:0.0238!
2021-03-04 22:20:44,828 - root - INFO - head hit:0.1194, head mean rank:775.7774, topn:10.
2021-03-04 22:20:44,828 - root - INFO - tail hit:0.3147, tail mean rank:494.1169, topn:10.
2021-03-04 22:20:44,828 - root - INFO - avg hit:0.2170, avg mean rank:634.9471, topn:10.
2021-03-04 22:20:47,827 - root - INFO - head hit:0.1106, head mean rank:743.9688, topn:10.
2021-03-04 22:20:47,827 - root - INFO - tail hit:0.3142, tail mean rank:472.2164, topn:10.
2021-03-04 22:20:47,828 - root - INFO - avg hit:0.2124, avg mean rank:608.0926, topn:10.
2021-03-04 22:20:47,829 - root - INFO - Checkpointing ...
2021-03-04 22:21:23,839 - root - INFO - train loss:0.0588!
2021-03-04 22:21:25,545 - root - INFO - head hit:0.1144, head mean rank:800.6580, topn:10.
2021-03-04 22:21:25,545 - root - INFO - tail hit:0.3184, tail mean rank:484.8731, topn:10.
2021-03-04 22:21:25,545 - root - INFO - avg hit:0.2164, avg mean rank:642.7655, topn:10.
2021-03-04 22:21:28,634 - root - INFO - head hit:0.1112, head mean rank:773.3227, topn:10.
2021-03-04 22:21:28,634 - root - INFO - tail hit:0.3429, tail mean rank:476.5214, topn:10.
2021-03-04 22:21:28,634 - root - INFO - avg hit:0.2271, avg mean rank:624.9221, topn:10.
2021-03-04 22:21:28,636 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 22:22:00,813 - root - INFO - train loss:0.0276!
2021-03-04 22:22:02,560 - root - INFO - head hit:0.1294, head mean rank:795.1791, topn:10.
2021-03-04 22:22:02,561 - root - INFO - tail hit:0.3346, tail mean rank:454.6654, topn:10.
2021-03-04 22:22:02,561 - root - INFO - avg hit:0.2320, avg mean rank:624.9223, topn:10.
2021-03-04 22:22:05,549 - root - INFO - head hit:0.1210, head mean rank:753.2457, topn:10.
2021-03-04 22:22:05,549 - root - INFO - tail hit:0.3539, tail mean rank:454.5293, topn:10.
2021-03-04 22:22:05,550 - root - INFO - avg hit:0.2375, avg mean rank:603.8875, topn:10.
2021-03-04 22:22:05,551 - root - INFO - Checkpointing ...
2021-03-04 22:22:37,064 - root - INFO - train loss:0.0166!
2021-03-04 22:22:38,795 - root - INFO - head hit:0.1418, head mean rank:791.0721, topn:10.
2021-03-04 22:22:38,795 - root - INFO - tail hit:0.3470, tail mean rank:447.1965, topn:10.
2021-03-04 22:22:38,795 - root - INFO - avg hit:0.2444, avg mean rank:619.1343, topn:10.
2021-03-04 22:22:41,705 - root - INFO - head hit:0.1351, head mean rank:729.5801, topn:10.
2021-03-04 22:22:41,705 - root - INFO - tail hit:0.3619, tail mean rank:446.4658, topn:10.
2021-03-04 22:22:41,706 - root - INFO - avg hit:0.2485, avg mean rank:588.0229, topn:10.
2021-03-04 22:22:41,706 - root - INFO - Checkpointing ...
2021-03-04 22:23:12,989 - root - INFO - train loss:0.0127!
2021-03-04 22:23:14,659 - root - INFO - head hit:0.1405, head mean rank:813.5585, topn:10.
2021-03-04 22:23:14,660 - root - INFO - tail hit:0.3234, tail mean rank:443.9577, topn:10.
2021-03-04 22:23:14,660 - root - INFO - avg hit:0.2320, avg mean rank:628.7581, topn:10.
2021-03-04 22:23:17,675 - root - INFO - head hit:0.1369, head mean rank:735.9114, topn:10.
2021-03-04 22:23:17,675 - root - INFO - tail hit:0.3631, tail mean rank:440.3698, topn:10.
2021-03-04 22:23:17,675 - root - INFO - avg hit:0.2500, avg mean rank:588.1406, topn:10.
2021-03-04 22:23:17,677 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 22:23:52,686 - root - INFO - train loss:0.0076!
2021-03-04 22:23:54,338 - root - INFO - head hit:0.1493, head mean rank:791.6082, topn:10.
2021-03-04 22:23:54,338 - root - INFO - tail hit:0.3570, tail mean rank:434.5187, topn:10.
2021-03-04 22:23:54,338 - root - INFO - avg hit:0.2531, avg mean rank:613.0634, topn:10.
2021-03-04 22:23:57,152 - root - INFO - head hit:0.1430, head mean rank:717.1504, topn:10.
2021-03-04 22:23:57,152 - root - INFO - tail hit:0.3894, tail mean rank:433.1565, topn:10.
2021-03-04 22:23:57,152 - root - INFO - avg hit:0.2662, avg mean rank:575.1534, topn:10.
2021-03-04 22:23:57,154 - root - INFO - Checkpointing ...
2021-03-04 22:24:32,104 - root - INFO - train loss:0.0060!
2021-03-04 22:24:33,788 - root - INFO - head hit:0.1555, head mean rank:785.4129, topn:10.
2021-03-04 22:24:33,788 - root - INFO - tail hit:0.3520, tail mean rank:439.5659, topn:10.
2021-03-04 22:24:33,789 - root - INFO - avg hit:0.2537, avg mean rank:612.4894, topn:10.
2021-03-04 22:24:36,792 - root - INFO - head hit:0.1491, head mean rank:711.1901, topn:10.
2021-03-04 22:24:36,792 - root - INFO - tail hit:0.3845, tail mean rank:437.2213, topn:10.
2021-03-04 22:24:36,792 - root - INFO - avg hit:0.2668, avg mean rank:574.2057, topn:10.
2021-03-04 22:24:36,793 - root - INFO - Checkpointing ...
2021-03-04 22:25:11,402 - root - INFO - train loss:0.0034!
2021-03-04 22:25:13,060 - root - INFO - head hit:0.1517, head mean rank:782.1095, topn:10.
2021-03-04 22:25:13,060 - root - INFO - tail hit:0.3731, tail mean rank:441.0622, topn:10.
2021-03-04 22:25:13,061 - root - INFO - avg hit:0.2624, avg mean rank:611.5858, topn:10.
2021-03-04 22:25:16,138 - root - INFO - head hit:0.1504, head mean rank:712.1571, topn:10.
2021-03-04 22:25:16,138 - root - INFO - tail hit:0.4010, tail mean rank:436.2359, topn:10.
2021-03-04 22:25:16,139 - root - INFO - avg hit:0.2757, avg mean rank:574.1965, topn:10.
2021-03-04 22:25:16,140 - root - INFO - Checkpointing ...
2021-03-04 22:25:50,421 - root - INFO - train loss:0.0024!
2021-03-04 22:25:52,141 - root - INFO - head hit:0.1592, head mean rank:769.3868, topn:10.
2021-03-04 22:25:52,142 - root - INFO - tail hit:0.3582, tail mean rank:442.8607, topn:10.
2021-03-04 22:25:52,142 - root - INFO - avg hit:0.2587, avg mean rank:606.1238, topn:10.
2021-03-04 22:25:55,213 - root - INFO - head hit:0.1546, head mean rank:698.0874, topn:10.
2021-03-04 22:25:55,213 - root - INFO - tail hit:0.4004, tail mean rank:435.1210, topn:10.
2021-03-04 22:25:55,213 - root - INFO - avg hit:0.2775, avg mean rank:566.6042, topn:10.
2021-03-04 22:25:55,214 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 22:26:27,314 - root - INFO - train loss:0.0024!
2021-03-04 22:26:29,050 - root - INFO - head hit:0.1604, head mean rank:779.1256, topn:10.
2021-03-04 22:26:29,051 - root - INFO - tail hit:0.3657, tail mean rank:441.8557, topn:10.
2021-03-04 22:26:29,051 - root - INFO - avg hit:0.2631, avg mean rank:610.4907, topn:10.
2021-03-04 22:26:32,067 - root - INFO - head hit:0.1522, head mean rank:701.4523, topn:10.
2021-03-04 22:26:32,067 - root - INFO - tail hit:0.3973, tail mean rank:433.7598, topn:10.
2021-03-04 22:26:32,067 - root - INFO - avg hit:0.2748, avg mean rank:567.6061, topn:10.
2021-03-04 22:26:32,069 - root - INFO - Checkpointing ...
2021-03-04 22:27:04,270 - root - INFO - train loss:0.0017!
2021-03-04 22:27:05,987 - root - INFO - head hit:0.1530, head mean rank:799.8060, topn:10.
2021-03-04 22:27:05,988 - root - INFO - tail hit:0.3781, tail mean rank:436.8657, topn:10.
2021-03-04 22:27:05,988 - root - INFO - avg hit:0.2655, avg mean rank:618.3358, topn:10.
2021-03-04 22:27:09,058 - root - INFO - head hit:0.1479, head mean rank:719.4040, topn:10.
2021-03-04 22:27:09,058 - root - INFO - tail hit:0.4077, tail mean rank:433.8533, topn:10.
2021-03-04 22:27:09,058 - root - INFO - avg hit:0.2778, avg mean rank:576.6287, topn:10.
2021-03-04 22:27:09,060 - root - INFO - Checkpointing ...
2021-03-04 22:27:42,642 - root - INFO - train loss:0.0015!
2021-03-04 22:27:44,328 - root - INFO - head hit:0.1604, head mean rank:798.9303, topn:10.
2021-03-04 22:27:44,328 - root - INFO - tail hit:0.3831, tail mean rank:436.1953, topn:10.
2021-03-04 22:27:44,328 - root - INFO - avg hit:0.2718, avg mean rank:617.5628, topn:10.
2021-03-04 22:27:47,457 - root - INFO - head hit:0.1498, head mean rank:718.8252, topn:10.
2021-03-04 22:27:47,458 - root - INFO - tail hit:0.4028, tail mean rank:433.9340, topn:10.
2021-03-04 22:27:47,458 - root - INFO - avg hit:0.2763, avg mean rank:576.3796, topn:10.
2021-03-04 22:27:47,459 - root - INFO - Checkpointing ...
2021-03-04 22:28:19,986 - root - INFO - train loss:0.0010!
2021-03-04 22:28:21,688 - root - INFO - head hit:0.1592, head mean rank:788.7649, topn:10.
2021-03-04 22:28:21,688 - root - INFO - tail hit:0.3893, tail mean rank:431.8109, topn:10.
2021-03-04 22:28:21,688 - root - INFO - avg hit:0.2743, avg mean rank:610.2879, topn:10.
2021-03-04 22:28:24,790 - root - INFO - head hit:0.1540, head mean rank:708.8233, topn:10.
2021-03-04 22:28:24,791 - root - INFO - tail hit:0.4089, tail mean rank:429.5611, topn:10.
2021-03-04 22:28:24,791 - root - INFO - avg hit:0.2815, avg mean rank:569.1922, topn:10.
2021-03-04 22:28:24,792 - root - INFO - Checkpointing ...
2021-03-04 22:28:58,703 - root - INFO - train loss:0.0013!
2021-03-04 22:29:00,405 - root - INFO - head hit:0.1580, head mean rank:781.2313, topn:10.
2021-03-04 22:29:00,406 - root - INFO - tail hit:0.3843, tail mean rank:432.6978, topn:10.
2021-03-04 22:29:00,406 - root - INFO - avg hit:0.2711, avg mean rank:606.9646, topn:10.
2021-03-04 22:29:03,649 - root - INFO - head hit:0.1650, head mean rank:705.7029, topn:10.
2021-03-04 22:29:03,650 - root - INFO - tail hit:0.4059, tail mean rank:430.6944, topn:10.
2021-03-04 22:29:03,650 - root - INFO - avg hit:0.2855, avg mean rank:568.1987, topn:10.
2021-03-04 22:29:03,652 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 22:29:39,793 - root - INFO - train loss:0.0010!
2021-03-04 22:29:41,492 - root - INFO - head hit:0.1592, head mean rank:779.1269, topn:10.
2021-03-04 22:29:41,492 - root - INFO - tail hit:0.3893, tail mean rank:432.9876, topn:10.
2021-03-04 22:29:41,493 - root - INFO - avg hit:0.2743, avg mean rank:606.0572, topn:10.
2021-03-04 22:29:44,481 - root - INFO - head hit:0.1638, head mean rank:706.1858, topn:10.
2021-03-04 22:29:44,481 - root - INFO - tail hit:0.4077, tail mean rank:431.8068, topn:10.
2021-03-04 22:29:44,481 - root - INFO - avg hit:0.2858, avg mean rank:568.9963, topn:10.
2021-03-04 22:29:44,483 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 22:30:20,176 - root - INFO - train loss:0.0016!
2021-03-04 22:30:21,902 - root - INFO - head hit:0.1580, head mean rank:778.4266, topn:10.
2021-03-04 22:30:21,903 - root - INFO - tail hit:0.3856, tail mean rank:433.2015, topn:10.
2021-03-04 22:30:21,903 - root - INFO - avg hit:0.2718, avg mean rank:605.8141, topn:10.
2021-03-04 22:30:24,928 - root - INFO - head hit:0.1669, head mean rank:705.8429, topn:10.
2021-03-04 22:30:24,928 - root - INFO - tail hit:0.4077, tail mean rank:431.3172, topn:10.
2021-03-04 22:30:24,928 - root - INFO - avg hit:0.2873, avg mean rank:568.5801, topn:10.
2021-03-04 22:30:24,929 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 22:30:57,905 - root - INFO - train loss:0.0007!
2021-03-04 22:30:59,648 - root - INFO - head hit:0.1580, head mean rank:777.9776, topn:10.
2021-03-04 22:30:59,649 - root - INFO - tail hit:0.3881, tail mean rank:432.7289, topn:10.
2021-03-04 22:30:59,649 - root - INFO - avg hit:0.2730, avg mean rank:605.3532, topn:10.
2021-03-04 22:31:02,711 - root - INFO - head hit:0.1675, head mean rank:705.3949, topn:10.
2021-03-04 22:31:02,711 - root - INFO - tail hit:0.4077, tail mean rank:430.5391, topn:10.
2021-03-04 22:31:02,712 - root - INFO - avg hit:0.2876, avg mean rank:567.9670, topn:10.
2021-03-04 22:31:02,713 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 22:31:33,131 - root - INFO - No improvement after 24363 steps. Stopping training.
