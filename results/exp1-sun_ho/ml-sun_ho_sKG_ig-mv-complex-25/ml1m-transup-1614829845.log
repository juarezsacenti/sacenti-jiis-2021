2021-03-04 00:50:45,282 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 13317,
    "embedding_size": 100,
    "eval_interval_steps": 2663,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transup-1614829845",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": null,
    "l2_lambda": 1e-05,
    "learning_rate": 0.005,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/ml1m-bprmf-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transup",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 3,
    "num_processes": 4,
    "optimizer_type": "Adagrad",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 266300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-04 00:50:45,517 - root - INFO - Totally 69982 train ratings, 9998,19995 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/cao-format/ml1m/test.dat!
2021-03-04 00:50:45,520 - root - INFO - successfully load 943 users and 1675 items!
2021-03-04 00:50:45,658 - root - INFO - Building model.
2021-03-04 00:50:46,941 - root - INFO - Architecture: TransUPModel(
  (user_embeddings): Embedding(943, 100)
  (item_embeddings): Embedding(1675, 100)
  (pref_embeddings): Embedding(3, 100)
  (pref_norm_embeddings): Embedding(3, 100)
)
2021-03-04 00:50:46,941 - root - INFO - Total params: 262400.0
2021-03-04 00:50:46,941 - root - INFO - One epoch is 274 steps.
2021-03-04 00:50:46,942 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-04 00:50:46,945 - root - INFO - Load Embeddings of user_embeddings.weight, item_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/ml1m-bprmf-pretrained.ckpt.
2021-03-04 00:50:46,945 - root - INFO - Training.
2021-03-04 00:50:46,945 - root - INFO - train loss:0.0000!
2021-03-04 00:50:48,181 - root - INFO - f1:0.0719, p:0.0969, r:0.0764, hit:0.4539, ndcg:0.2730, topn:10.
2021-03-04 00:50:49,339 - root - INFO - f1:0.0774, p:0.1593, r:0.0620, hit:0.5663, ndcg:0.3553, topn:10.
2021-03-04 00:51:11,319 - root - INFO - train loss:78.2290!
2021-03-04 00:51:12,511 - root - INFO - f1:0.1405, p:0.1638, r:0.1738, hit:0.7084, ndcg:0.4415, topn:10.
2021-03-04 00:51:13,735 - root - INFO - f1:0.1698, p:0.2732, r:0.1630, hit:0.8537, ndcg:0.5732, topn:10.
2021-03-04 00:51:13,740 - root - INFO - Checkpointing ...
2021-03-04 00:51:37,155 - root - INFO - train loss:0.1728!
2021-03-04 00:51:38,409 - root - INFO - f1:0.1504, p:0.1742, r:0.1862, hit:0.7370, ndcg:0.4622, topn:10.
2021-03-04 00:51:39,609 - root - INFO - f1:0.1774, p:0.2852, r:0.1701, hit:0.8653, ndcg:0.5878, topn:10.
2021-03-04 00:51:39,614 - root - INFO - Checkpointing ...
2021-03-04 00:52:00,427 - root - INFO - train loss:0.1631!
2021-03-04 00:52:01,661 - root - INFO - f1:0.1545, p:0.1790, r:0.1919, hit:0.7370, ndcg:0.4746, topn:10.
2021-03-04 00:52:02,839 - root - INFO - f1:0.1827, p:0.2925, r:0.1757, hit:0.8749, ndcg:0.6008, topn:10.
2021-03-04 00:52:02,843 - root - INFO - Checkpointing ...
2021-03-04 00:52:25,313 - root - INFO - train loss:0.1557!
2021-03-04 00:52:26,490 - root - INFO - f1:0.1589, p:0.1842, r:0.1976, hit:0.7455, ndcg:0.4793, topn:10.
2021-03-04 00:52:27,656 - root - INFO - f1:0.1870, p:0.2984, r:0.1802, hit:0.8770, ndcg:0.6086, topn:10.
2021-03-04 00:52:27,660 - root - INFO - Checkpointing ...
2021-03-04 00:52:50,028 - root - INFO - train loss:0.1510!
2021-03-04 00:52:51,241 - root - INFO - f1:0.1612, p:0.1864, r:0.2015, hit:0.7529, ndcg:0.4871, topn:10.
2021-03-04 00:52:52,477 - root - INFO - f1:0.1895, p:0.3025, r:0.1829, hit:0.8823, ndcg:0.6142, topn:10.
2021-03-04 00:52:52,481 - root - INFO - Checkpointing ...
2021-03-04 00:53:14,726 - root - INFO - train loss:0.1476!
2021-03-04 00:53:15,890 - root - INFO - f1:0.1637, p:0.1891, r:0.2060, hit:0.7614, ndcg:0.4958, topn:10.
2021-03-04 00:53:17,033 - root - INFO - f1:0.1925, p:0.3072, r:0.1858, hit:0.8844, ndcg:0.6203, topn:10.
2021-03-04 00:53:17,038 - root - INFO - Checkpointing ...
2021-03-04 00:53:38,136 - root - INFO - train loss:0.1443!
2021-03-04 00:53:39,590 - root - INFO - f1:0.1645, p:0.1906, r:0.2059, hit:0.7572, ndcg:0.4967, topn:10.
2021-03-04 00:53:40,770 - root - INFO - f1:0.1948, p:0.3108, r:0.1881, hit:0.8844, ndcg:0.6217, topn:10.
2021-03-04 00:53:40,775 - root - INFO - Checkpointing ...
2021-03-04 00:54:02,563 - root - INFO - train loss:0.1413!
2021-03-04 00:54:03,717 - root - INFO - f1:0.1659, p:0.1926, r:0.2073, hit:0.7540, ndcg:0.4966, topn:10.
2021-03-04 00:54:04,912 - root - INFO - f1:0.1967, p:0.3141, r:0.1894, hit:0.8844, ndcg:0.6240, topn:10.
2021-03-04 00:54:04,916 - root - INFO - Checkpointing ...
2021-03-04 00:54:25,887 - root - INFO - train loss:0.1392!
2021-03-04 00:54:27,072 - root - INFO - f1:0.1677, p:0.1945, r:0.2099, hit:0.7572, ndcg:0.5007, topn:10.
2021-03-04 00:54:28,249 - root - INFO - f1:0.1987, p:0.3172, r:0.1916, hit:0.8844, ndcg:0.6280, topn:10.
2021-03-04 00:54:28,255 - root - INFO - Checkpointing ...
2021-03-04 00:54:50,449 - root - INFO - train loss:0.1368!
2021-03-04 00:54:51,641 - root - INFO - f1:0.1693, p:0.1960, r:0.2119, hit:0.7614, ndcg:0.5062, topn:10.
2021-03-04 00:54:52,875 - root - INFO - f1:0.2002, p:0.3192, r:0.1931, hit:0.8876, ndcg:0.6306, topn:10.
2021-03-04 00:54:52,880 - root - INFO - Checkpointing ...
2021-03-04 00:55:13,774 - root - INFO - train loss:0.1346!
2021-03-04 00:55:15,001 - root - INFO - f1:0.1703, p:0.1971, r:0.2130, hit:0.7593, ndcg:0.5055, topn:10.
2021-03-04 00:55:16,128 - root - INFO - f1:0.2018, p:0.3210, r:0.1949, hit:0.8855, ndcg:0.6306, topn:10.
2021-03-04 00:55:16,131 - root - INFO - Checkpointing ...
2021-03-04 00:55:36,880 - root - INFO - train loss:0.1333!
2021-03-04 00:55:38,021 - root - INFO - f1:0.1723, p:0.1988, r:0.2165, hit:0.7614, ndcg:0.5070, topn:10.
2021-03-04 00:55:39,165 - root - INFO - f1:0.2025, p:0.3224, r:0.1948, hit:0.8844, ndcg:0.6304, topn:10.
2021-03-04 00:55:39,170 - root - INFO - Checkpointing ...
2021-03-04 00:56:00,794 - root - INFO - train loss:0.1320!
2021-03-04 00:56:01,907 - root - INFO - f1:0.1741, p:0.2012, r:0.2177, hit:0.7656, ndcg:0.5113, topn:10.
2021-03-04 00:56:03,104 - root - INFO - f1:0.2048, p:0.3257, r:0.1973, hit:0.8855, ndcg:0.6321, topn:10.
2021-03-04 00:56:03,108 - root - INFO - Checkpointing ...
2021-03-04 00:56:23,828 - root - INFO - train loss:0.1302!
2021-03-04 00:56:24,894 - root - INFO - f1:0.1751, p:0.2024, r:0.2183, hit:0.7667, ndcg:0.5125, topn:10.
2021-03-04 00:56:26,032 - root - INFO - f1:0.2066, p:0.3282, r:0.1999, hit:0.8876, ndcg:0.6367, topn:10.
2021-03-04 00:56:26,036 - root - INFO - Checkpointing ...
2021-03-04 00:56:46,112 - root - INFO - train loss:0.1290!
2021-03-04 00:56:47,335 - root - INFO - f1:0.1764, p:0.2040, r:0.2202, hit:0.7688, ndcg:0.5140, topn:10.
2021-03-04 00:56:48,536 - root - INFO - f1:0.2082, p:0.3303, r:0.2016, hit:0.8908, ndcg:0.6406, topn:10.
2021-03-04 00:56:48,539 - root - INFO - Checkpointing ...
2021-03-04 00:57:09,125 - root - INFO - train loss:0.1283!
2021-03-04 00:57:10,257 - root - INFO - f1:0.1775, p:0.2050, r:0.2217, hit:0.7699, ndcg:0.5178, topn:10.
2021-03-04 00:57:11,445 - root - INFO - f1:0.2091, p:0.3318, r:0.2025, hit:0.8887, ndcg:0.6413, topn:10.
2021-03-04 00:57:11,449 - root - INFO - Checkpointing ...
2021-03-04 00:57:33,300 - root - INFO - train loss:0.1272!
2021-03-04 00:57:34,481 - root - INFO - f1:0.1768, p:0.2048, r:0.2207, hit:0.7678, ndcg:0.5175, topn:10.
2021-03-04 00:57:35,656 - root - INFO - f1:0.2101, p:0.3336, r:0.2033, hit:0.8887, ndcg:0.6434, topn:10.
2021-03-04 00:57:35,660 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 00:57:55,928 - root - INFO - train loss:0.1304!
2021-03-04 00:57:57,085 - root - INFO - f1:0.1834, p:0.2116, r:0.2313, hit:0.7911, ndcg:0.5414, topn:10.
2021-03-04 00:57:58,294 - root - INFO - f1:0.2169, p:0.3444, r:0.2080, hit:0.9014, ndcg:0.6687, topn:10.
2021-03-04 00:57:58,299 - root - INFO - Checkpointing ...
2021-03-04 00:58:19,320 - root - INFO - train loss:0.1230!
2021-03-04 00:58:20,528 - root - INFO - f1:0.1864, p:0.2148, r:0.2355, hit:0.7975, ndcg:0.5467, topn:10.
2021-03-04 00:58:21,712 - root - INFO - f1:0.2223, p:0.3519, r:0.2136, hit:0.9077, ndcg:0.6779, topn:10.
2021-03-04 00:58:21,716 - root - INFO - Checkpointing ...
2021-03-04 00:58:43,449 - root - INFO - train loss:0.1200!
2021-03-04 00:58:44,826 - root - INFO - f1:0.1870, p:0.2156, r:0.2356, hit:0.7975, ndcg:0.5519, topn:10.
2021-03-04 00:58:45,988 - root - INFO - f1:0.2253, p:0.3566, r:0.2156, hit:0.9088, ndcg:0.6805, topn:10.
2021-03-04 00:58:45,991 - root - INFO - Checkpointing ...
2021-03-04 00:59:07,903 - root - INFO - train loss:0.1182!
2021-03-04 00:59:09,134 - root - INFO - f1:0.1903, p:0.2188, r:0.2404, hit:0.8028, ndcg:0.5526, topn:10.
2021-03-04 00:59:10,377 - root - INFO - f1:0.2262, p:0.3585, r:0.2168, hit:0.9088, ndcg:0.6846, topn:10.
2021-03-04 00:59:10,381 - root - INFO - Checkpointing ...
2021-03-04 00:59:33,106 - root - INFO - train loss:0.1164!
2021-03-04 00:59:34,301 - root - INFO - f1:0.1908, p:0.2196, r:0.2403, hit:0.8017, ndcg:0.5565, topn:10.
2021-03-04 00:59:35,510 - root - INFO - f1:0.2283, p:0.3610, r:0.2190, hit:0.9120, ndcg:0.6882, topn:10.
2021-03-04 00:59:35,514 - root - INFO - Checkpointing ...
2021-03-04 00:59:57,447 - root - INFO - train loss:0.1159!
2021-03-04 00:59:58,588 - root - INFO - f1:0.1931, p:0.2217, r:0.2432, hit:0.8038, ndcg:0.5587, topn:10.
2021-03-04 00:59:59,767 - root - INFO - f1:0.2288, p:0.3625, r:0.2193, hit:0.9109, ndcg:0.6927, topn:10.
2021-03-04 00:59:59,771 - root - INFO - Checkpointing ...
2021-03-04 01:00:21,201 - root - INFO - train loss:0.1148!
2021-03-04 01:00:22,395 - root - INFO - f1:0.1942, p:0.2230, r:0.2444, hit:0.8102, ndcg:0.5591, topn:10.
2021-03-04 01:00:23,603 - root - INFO - f1:0.2304, p:0.3645, r:0.2207, hit:0.9130, ndcg:0.6926, topn:10.
2021-03-04 01:00:23,607 - root - INFO - Checkpointing ...
2021-03-04 01:00:44,504 - root - INFO - train loss:0.1139!
2021-03-04 01:00:45,582 - root - INFO - f1:0.1953, p:0.2242, r:0.2459, hit:0.8091, ndcg:0.5614, topn:10.
2021-03-04 01:00:46,819 - root - INFO - f1:0.2311, p:0.3653, r:0.2215, hit:0.9130, ndcg:0.6946, topn:10.
2021-03-04 01:00:46,825 - root - INFO - Checkpointing ...
2021-03-04 01:01:07,484 - root - INFO - train loss:0.1128!
2021-03-04 01:01:08,707 - root - INFO - f1:0.1955, p:0.2243, r:0.2469, hit:0.8081, ndcg:0.5618, topn:10.
2021-03-04 01:01:09,865 - root - INFO - f1:0.2319, p:0.3667, r:0.2223, hit:0.9120, ndcg:0.6959, topn:10.
2021-03-04 01:01:09,868 - root - INFO - Checkpointing ...
2021-03-04 01:01:32,781 - root - INFO - train loss:0.1117!
2021-03-04 01:01:33,976 - root - INFO - f1:0.1972, p:0.2261, r:0.2488, hit:0.8091, ndcg:0.5644, topn:10.
2021-03-04 01:01:35,132 - root - INFO - f1:0.2323, p:0.3677, r:0.2227, hit:0.9130, ndcg:0.6957, topn:10.
2021-03-04 01:01:35,136 - root - INFO - Checkpointing ...
2021-03-04 01:01:55,746 - root - INFO - train loss:0.1115!
2021-03-04 01:01:56,946 - root - INFO - f1:0.1990, p:0.2275, r:0.2524, hit:0.8144, ndcg:0.5665, topn:10.
2021-03-04 01:01:58,203 - root - INFO - f1:0.2334, p:0.3690, r:0.2237, hit:0.9141, ndcg:0.6995, topn:10.
2021-03-04 01:01:58,207 - root - INFO - Checkpointing ...
2021-03-04 01:02:20,082 - root - INFO - train loss:0.1114!
2021-03-04 01:02:21,254 - root - INFO - f1:0.1983, p:0.2265, r:0.2513, hit:0.8134, ndcg:0.5683, topn:10.
2021-03-04 01:02:22,456 - root - INFO - f1:0.2340, p:0.3695, r:0.2245, hit:0.9162, ndcg:0.7015, topn:10.
2021-03-04 01:02:22,460 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 01:02:45,032 - root - INFO - train loss:0.1132!
2021-03-04 01:02:46,158 - root - INFO - f1:0.1999, p:0.2282, r:0.2537, hit:0.8112, ndcg:0.5740, topn:10.
2021-03-04 01:02:47,356 - root - INFO - f1:0.2352, p:0.3721, r:0.2248, hit:0.9152, ndcg:0.7005, topn:10.
2021-03-04 01:02:47,360 - root - INFO - Checkpointing ...
2021-03-04 01:03:08,056 - root - INFO - train loss:0.1103!
2021-03-04 01:03:09,161 - root - INFO - f1:0.2022, p:0.2305, r:0.2576, hit:0.8155, ndcg:0.5750, topn:10.
2021-03-04 01:03:10,382 - root - INFO - f1:0.2355, p:0.3730, r:0.2250, hit:0.9152, ndcg:0.7026, topn:10.
2021-03-04 01:03:10,388 - root - INFO - Checkpointing ...
2021-03-04 01:03:31,424 - root - INFO - train loss:0.1091!
2021-03-04 01:03:32,655 - root - INFO - f1:0.2025, p:0.2308, r:0.2585, hit:0.8187, ndcg:0.5803, topn:10.
2021-03-04 01:03:33,884 - root - INFO - f1:0.2371, p:0.3751, r:0.2270, hit:0.9194, ndcg:0.7070, topn:10.
2021-03-04 01:03:33,889 - root - INFO - Checkpointing ...
2021-03-04 01:03:55,264 - root - INFO - train loss:0.1079!
2021-03-04 01:03:56,428 - root - INFO - f1:0.2027, p:0.2310, r:0.2585, hit:0.8250, ndcg:0.5832, topn:10.
2021-03-04 01:03:57,848 - root - INFO - f1:0.2382, p:0.3761, r:0.2281, hit:0.9194, ndcg:0.7075, topn:10.
2021-03-04 01:03:57,853 - root - INFO - Checkpointing ...
2021-03-04 01:04:18,874 - root - INFO - train loss:0.1071!
2021-03-04 01:04:20,117 - root - INFO - f1:0.2030, p:0.2314, r:0.2591, hit:0.8240, ndcg:0.5835, topn:10.
2021-03-04 01:04:21,256 - root - INFO - f1:0.2389, p:0.3770, r:0.2292, hit:0.9194, ndcg:0.7094, topn:10.
2021-03-04 01:04:21,259 - root - INFO - Checkpointing ...
2021-03-04 01:04:41,493 - root - INFO - train loss:0.1073!
2021-03-04 01:04:42,621 - root - INFO - f1:0.2039, p:0.2326, r:0.2595, hit:0.8240, ndcg:0.5846, topn:10.
2021-03-04 01:04:43,859 - root - INFO - f1:0.2395, p:0.3779, r:0.2295, hit:0.9215, ndcg:0.7079, topn:10.
2021-03-04 01:04:43,862 - root - INFO - Checkpointing ...
2021-03-04 01:05:04,072 - root - INFO - train loss:0.1067!
2021-03-04 01:05:05,196 - root - INFO - f1:0.2037, p:0.2327, r:0.2587, hit:0.8229, ndcg:0.5851, topn:10.
2021-03-04 01:05:06,340 - root - INFO - f1:0.2405, p:0.3789, r:0.2309, hit:0.9226, ndcg:0.7099, topn:10.
2021-03-04 01:05:06,343 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 01:05:26,621 - root - INFO - train loss:0.1072!
2021-03-04 01:05:27,762 - root - INFO - f1:0.2032, p:0.2322, r:0.2578, hit:0.8197, ndcg:0.5835, topn:10.
2021-03-04 01:05:28,969 - root - INFO - f1:0.2395, p:0.3789, r:0.2289, hit:0.9183, ndcg:0.7100, topn:10.
2021-03-04 01:05:28,972 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 01:05:49,263 - root - INFO - train loss:0.1071!
2021-03-04 01:05:50,459 - root - INFO - f1:0.2026, p:0.2317, r:0.2558, hit:0.8187, ndcg:0.5830, topn:10.
2021-03-04 01:05:51,608 - root - INFO - f1:0.2397, p:0.3791, r:0.2289, hit:0.9215, ndcg:0.7115, topn:10.
2021-03-04 01:05:51,612 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 01:06:11,830 - root - INFO - train loss:0.1061!
2021-03-04 01:06:13,006 - root - INFO - f1:0.2026, p:0.2315, r:0.2568, hit:0.8197, ndcg:0.5840, topn:10.
2021-03-04 01:06:14,229 - root - INFO - f1:0.2399, p:0.3795, r:0.2289, hit:0.9194, ndcg:0.7112, topn:10.
2021-03-04 01:06:14,232 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 01:06:35,321 - root - INFO - train loss:0.1065!
2021-03-04 01:06:36,502 - root - INFO - f1:0.2026, p:0.2316, r:0.2567, hit:0.8197, ndcg:0.5840, topn:10.
2021-03-04 01:06:37,734 - root - INFO - f1:0.2402, p:0.3802, r:0.2292, hit:0.9194, ndcg:0.7105, topn:10.
2021-03-04 01:06:37,738 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 01:06:37,789 - root - INFO - No improvement after 13317 steps. Stopping training.
2021-03-04 01:06:39,327 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.231495, 'RECALL@10': 0.256432, 'NDCG@10': 0.584639, 'MAP@10': 0.475868, 'MAP': 0.475868}.
2021-03-04 01:06:39,527 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.474549, 'GENRE_REDUNDANCY@10': 0.43158, 'ILD_GENRE@10': 0.810529}.
2021-03-04 01:06:41,230 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.379639, 'RECALL@10': 0.228918, 'NDCG@10': 0.710295, 'MAP@10': 0.608654, 'MAP': 0.608654}.
2021-03-04 01:06:41,393 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.469159, 'GENRE_REDUNDANCY@10': 0.42479, 'ILD_GENRE@10': 0.807061}.
