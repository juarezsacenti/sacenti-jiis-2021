2021-03-04 00:35:42,766 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614828942",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-04 00:35:42,819 - root - INFO - Totally 6085 train triples, 819,1630 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/cao-format/ml1m/kg/test.dat!
2021-03-04 00:35:42,822 - root - INFO - successfully load 2852 entities and 3 relations!
2021-03-04 00:35:42,832 - root - INFO - Building model.
2021-03-04 00:35:43,941 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(2852, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-04 00:35:43,941 - root - INFO - Total params: 285800.0
2021-03-04 00:35:43,941 - root - INFO - One epoch is 24 steps.
2021-03-04 00:35:43,942 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-04 00:35:43,945 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-25/ml1m-transe-pretrained.ckpt.
2021-03-04 00:35:43,945 - root - INFO - Training.
2021-03-04 00:35:43,945 - root - INFO - train loss:0.0000!
2021-03-04 00:35:45,345 - root - INFO - head hit:0.1770, head mean rank:601.1600, topn:10.
2021-03-04 00:35:45,345 - root - INFO - tail hit:0.4335, tail mean rank:189.5458, topn:10.
2021-03-04 00:35:45,345 - root - INFO - avg hit:0.3053, avg mean rank:395.3529, topn:10.
2021-03-04 00:35:47,904 - root - INFO - head hit:0.2080, head mean rank:572.7429, topn:10.
2021-03-04 00:35:47,904 - root - INFO - tail hit:0.4141, tail mean rank:203.1773, topn:10.
2021-03-04 00:35:47,904 - root - INFO - avg hit:0.3110, avg mean rank:387.9601, topn:10.
2021-03-04 00:36:20,264 - root - INFO - train loss:0.0276!
2021-03-04 00:36:21,771 - root - INFO - head hit:0.1233, head mean rank:607.3358, topn:10.
2021-03-04 00:36:21,771 - root - INFO - tail hit:0.3614, tail mean rank:204.8767, topn:10.
2021-03-04 00:36:21,771 - root - INFO - avg hit:0.2424, avg mean rank:406.1062, topn:10.
2021-03-04 00:36:24,290 - root - INFO - head hit:0.1399, head mean rank:582.1393, topn:10.
2021-03-04 00:36:24,291 - root - INFO - tail hit:0.3607, tail mean rank:206.4859, topn:10.
2021-03-04 00:36:24,291 - root - INFO - avg hit:0.2503, avg mean rank:394.3126, topn:10.
2021-03-04 00:36:24,292 - root - INFO - Checkpointing ...
2021-03-04 00:36:54,642 - root - INFO - train loss:0.0732!
2021-03-04 00:36:55,980 - root - INFO - head hit:0.1111, head mean rank:614.8376, topn:10.
2021-03-04 00:36:55,980 - root - INFO - tail hit:0.3394, tail mean rank:198.2821, topn:10.
2021-03-04 00:36:55,980 - root - INFO - avg hit:0.2253, avg mean rank:406.5598, topn:10.
2021-03-04 00:36:58,584 - root - INFO - head hit:0.1399, head mean rank:599.6270, topn:10.
2021-03-04 00:36:58,585 - root - INFO - tail hit:0.3472, tail mean rank:218.5718, topn:10.
2021-03-04 00:36:58,585 - root - INFO - avg hit:0.2436, avg mean rank:409.0994, topn:10.
2021-03-04 00:36:58,586 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 00:37:30,544 - root - INFO - train loss:0.0288!
2021-03-04 00:37:32,000 - root - INFO - head hit:0.1636, head mean rank:595.4371, topn:10.
2021-03-04 00:37:32,000 - root - INFO - tail hit:0.3810, tail mean rank:189.0720, topn:10.
2021-03-04 00:37:32,001 - root - INFO - avg hit:0.2723, avg mean rank:392.2546, topn:10.
2021-03-04 00:37:34,650 - root - INFO - head hit:0.1791, head mean rank:570.5564, topn:10.
2021-03-04 00:37:34,651 - root - INFO - tail hit:0.3822, tail mean rank:205.6638, topn:10.
2021-03-04 00:37:34,651 - root - INFO - avg hit:0.2807, avg mean rank:388.1101, topn:10.
2021-03-04 00:37:34,652 - root - INFO - Checkpointing ...
2021-03-04 00:38:07,499 - root - INFO - train loss:0.0167!
2021-03-04 00:38:08,938 - root - INFO - head hit:0.1502, head mean rank:597.5775, topn:10.
2021-03-04 00:38:08,939 - root - INFO - tail hit:0.3871, tail mean rank:193.0586, topn:10.
2021-03-04 00:38:08,939 - root - INFO - avg hit:0.2686, avg mean rank:395.3181, topn:10.
2021-03-04 00:38:11,525 - root - INFO - head hit:0.1785, head mean rank:570.5245, topn:10.
2021-03-04 00:38:11,526 - root - INFO - tail hit:0.3730, tail mean rank:208.2221, topn:10.
2021-03-04 00:38:11,526 - root - INFO - avg hit:0.2758, avg mean rank:389.3733, topn:10.
2021-03-04 00:38:11,527 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 00:38:44,332 - root - INFO - train loss:0.0075!
2021-03-04 00:38:45,729 - root - INFO - head hit:0.1685, head mean rank:591.1685, topn:10.
2021-03-04 00:38:45,730 - root - INFO - tail hit:0.4066, tail mean rank:185.3626, topn:10.
2021-03-04 00:38:45,730 - root - INFO - avg hit:0.2875, avg mean rank:388.2656, topn:10.
2021-03-04 00:38:48,309 - root - INFO - head hit:0.1951, head mean rank:564.3307, topn:10.
2021-03-04 00:38:48,309 - root - INFO - tail hit:0.3988, tail mean rank:200.6706, topn:10.
2021-03-04 00:38:48,310 - root - INFO - avg hit:0.2969, avg mean rank:382.5006, topn:10.
2021-03-04 00:38:48,311 - root - INFO - Checkpointing ...
2021-03-04 00:39:20,524 - root - INFO - train loss:0.0046!
2021-03-04 00:39:21,962 - root - INFO - head hit:0.1734, head mean rank:585.9744, topn:10.
2021-03-04 00:39:21,962 - root - INFO - tail hit:0.4103, tail mean rank:184.2943, topn:10.
2021-03-04 00:39:21,963 - root - INFO - avg hit:0.2918, avg mean rank:385.1343, topn:10.
2021-03-04 00:39:24,571 - root - INFO - head hit:0.1969, head mean rank:555.9583, topn:10.
2021-03-04 00:39:24,571 - root - INFO - tail hit:0.3982, tail mean rank:198.7755, topn:10.
2021-03-04 00:39:24,571 - root - INFO - avg hit:0.2975, avg mean rank:377.3669, topn:10.
2021-03-04 00:39:24,573 - root - INFO - Checkpointing ...
2021-03-04 00:39:56,703 - root - INFO - train loss:0.0036!
2021-03-04 00:39:58,104 - root - INFO - head hit:0.1722, head mean rank:585.7790, topn:10.
2021-03-04 00:39:58,105 - root - INFO - tail hit:0.4078, tail mean rank:186.7937, topn:10.
2021-03-04 00:39:58,105 - root - INFO - avg hit:0.2900, avg mean rank:386.2863, topn:10.
2021-03-04 00:40:00,802 - root - INFO - head hit:0.1994, head mean rank:561.4926, topn:10.
2021-03-04 00:40:00,802 - root - INFO - tail hit:0.4018, tail mean rank:201.8681, topn:10.
2021-03-04 00:40:00,802 - root - INFO - avg hit:0.3006, avg mean rank:381.6804, topn:10.
2021-03-04 00:40:00,804 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 00:40:32,699 - root - INFO - train loss:0.0019!
2021-03-04 00:40:34,117 - root - INFO - head hit:0.1868, head mean rank:583.2589, topn:10.
2021-03-04 00:40:34,117 - root - INFO - tail hit:0.4151, tail mean rank:184.2991, topn:10.
2021-03-04 00:40:34,117 - root - INFO - avg hit:0.3010, avg mean rank:383.7790, topn:10.
2021-03-04 00:40:36,748 - root - INFO - head hit:0.2018, head mean rank:560.8393, topn:10.
2021-03-04 00:40:36,749 - root - INFO - tail hit:0.4117, tail mean rank:199.8282, topn:10.
2021-03-04 00:40:36,749 - root - INFO - avg hit:0.3067, avg mean rank:380.3337, topn:10.
2021-03-04 00:40:36,750 - root - INFO - Checkpointing ...
2021-03-04 00:41:06,134 - root - INFO - train loss:0.0010!
2021-03-04 00:41:07,592 - root - INFO - head hit:0.1856, head mean rank:583.1087, topn:10.
2021-03-04 00:41:07,592 - root - INFO - tail hit:0.4176, tail mean rank:182.3504, topn:10.
2021-03-04 00:41:07,592 - root - INFO - avg hit:0.3016, avg mean rank:382.7295, topn:10.
2021-03-04 00:41:10,169 - root - INFO - head hit:0.1994, head mean rank:559.7982, topn:10.
2021-03-04 00:41:10,170 - root - INFO - tail hit:0.4104, tail mean rank:198.4325, topn:10.
2021-03-04 00:41:10,170 - root - INFO - avg hit:0.3049, avg mean rank:379.1153, topn:10.
2021-03-04 00:41:10,171 - root - INFO - Checkpointing ...
2021-03-04 00:41:41,817 - root - INFO - train loss:0.0012!
2021-03-04 00:41:43,224 - root - INFO - head hit:0.1868, head mean rank:585.2076, topn:10.
2021-03-04 00:41:43,225 - root - INFO - tail hit:0.4212, tail mean rank:181.4518, topn:10.
2021-03-04 00:41:43,225 - root - INFO - avg hit:0.3040, avg mean rank:383.3297, topn:10.
2021-03-04 00:41:45,741 - root - INFO - head hit:0.1988, head mean rank:559.7656, topn:10.
2021-03-04 00:41:45,741 - root - INFO - tail hit:0.4110, tail mean rank:197.9325, topn:10.
2021-03-04 00:41:45,742 - root - INFO - avg hit:0.3049, avg mean rank:378.8491, topn:10.
2021-03-04 00:41:45,743 - root - INFO - Checkpointing ...
2021-03-04 00:42:16,367 - root - INFO - train loss:0.0013!
2021-03-04 00:42:17,855 - root - INFO - head hit:0.1844, head mean rank:587.3089, topn:10.
2021-03-04 00:42:17,855 - root - INFO - tail hit:0.4164, tail mean rank:181.8327, topn:10.
2021-03-04 00:42:17,856 - root - INFO - avg hit:0.3004, avg mean rank:384.5708, topn:10.
2021-03-04 00:42:20,502 - root - INFO - head hit:0.2006, head mean rank:560.3442, topn:10.
2021-03-04 00:42:20,502 - root - INFO - tail hit:0.4074, tail mean rank:197.7620, topn:10.
2021-03-04 00:42:20,502 - root - INFO - avg hit:0.3040, avg mean rank:379.0531, topn:10.
2021-03-04 00:42:20,503 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 00:42:51,722 - root - INFO - train loss:0.0010!
2021-03-04 00:42:53,217 - root - INFO - head hit:0.1844, head mean rank:585.1148, topn:10.
2021-03-04 00:42:53,217 - root - INFO - tail hit:0.4176, tail mean rank:181.0562, topn:10.
2021-03-04 00:42:53,217 - root - INFO - avg hit:0.3010, avg mean rank:383.0855, topn:10.
2021-03-04 00:42:55,801 - root - INFO - head hit:0.1988, head mean rank:559.6086, topn:10.
2021-03-04 00:42:55,801 - root - INFO - tail hit:0.4074, tail mean rank:197.6644, topn:10.
2021-03-04 00:42:55,801 - root - INFO - avg hit:0.3031, avg mean rank:378.6365, topn:10.
2021-03-04 00:42:55,802 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 00:43:28,317 - root - INFO - train loss:0.0008!
2021-03-04 00:43:29,751 - root - INFO - head hit:0.1880, head mean rank:585.6545, topn:10.
2021-03-04 00:43:29,752 - root - INFO - tail hit:0.4151, tail mean rank:180.8388, topn:10.
2021-03-04 00:43:29,752 - root - INFO - avg hit:0.3016, avg mean rank:383.2466, topn:10.
2021-03-04 00:43:32,232 - root - INFO - head hit:0.1988, head mean rank:559.3994, topn:10.
2021-03-04 00:43:32,232 - root - INFO - tail hit:0.4074, tail mean rank:197.1748, topn:10.
2021-03-04 00:43:32,233 - root - INFO - avg hit:0.3031, avg mean rank:378.2871, topn:10.
2021-03-04 00:43:32,234 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 00:44:05,845 - root - INFO - train loss:0.0005!
2021-03-04 00:44:07,304 - root - INFO - head hit:0.1893, head mean rank:585.4444, topn:10.
2021-03-04 00:44:07,304 - root - INFO - tail hit:0.4151, tail mean rank:180.7766, topn:10.
2021-03-04 00:44:07,304 - root - INFO - avg hit:0.3022, avg mean rank:383.1105, topn:10.
2021-03-04 00:44:09,830 - root - INFO - head hit:0.2000, head mean rank:559.5092, topn:10.
2021-03-04 00:44:09,830 - root - INFO - tail hit:0.4074, tail mean rank:197.1785, topn:10.
2021-03-04 00:44:09,830 - root - INFO - avg hit:0.3037, avg mean rank:378.3439, topn:10.
2021-03-04 00:44:09,832 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 00:44:39,007 - root - INFO - No improvement after 24363 steps. Stopping training.
