2021-03-02 22:27:36,631 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 13317,
    "embedding_size": 100,
    "eval_interval_steps": 2663,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transup-1614734856",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": null,
    "l2_lambda": 1e-05,
    "learning_rate": 0.005,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/ml1m-bprmf-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transup",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 3,
    "num_processes": 4,
    "optimizer_type": "Adagrad",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 266300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-02 22:27:36,868 - root - INFO - Totally 69982 train ratings, 9998,19995 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/cao-format/ml1m/test.dat!
2021-03-02 22:27:36,871 - root - INFO - successfully load 943 users and 1675 items!
2021-03-02 22:27:36,953 - root - INFO - Building model.
2021-03-02 22:27:38,058 - root - INFO - Architecture: TransUPModel(
  (user_embeddings): Embedding(943, 100)
  (item_embeddings): Embedding(1675, 100)
  (pref_embeddings): Embedding(3, 100)
  (pref_norm_embeddings): Embedding(3, 100)
)
2021-03-02 22:27:38,059 - root - INFO - Total params: 262400.0
2021-03-02 22:27:38,059 - root - INFO - One epoch is 274 steps.
2021-03-02 22:27:38,060 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-02 22:27:38,063 - root - INFO - Load Embeddings of user_embeddings.weight, item_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/ml1m-bprmf-pretrained.ckpt.
2021-03-02 22:27:38,063 - root - INFO - Training.
2021-03-02 22:27:38,063 - root - INFO - train loss:0.0000!
2021-03-02 22:27:39,422 - root - INFO - f1:0.0703, p:0.0953, r:0.0745, hit:0.4486, ndcg:0.2683, topn:10.
2021-03-02 22:27:40,700 - root - INFO - f1:0.0768, p:0.1571, r:0.0627, hit:0.5726, ndcg:0.3612, topn:10.
2021-03-02 22:28:01,315 - root - INFO - train loss:78.4389!
2021-03-02 22:28:02,612 - root - INFO - f1:0.1444, p:0.1676, r:0.1805, hit:0.7222, ndcg:0.4500, topn:10.
2021-03-02 22:28:03,844 - root - INFO - f1:0.1710, p:0.2752, r:0.1644, hit:0.8526, ndcg:0.5734, topn:10.
2021-03-02 22:28:03,849 - root - INFO - Checkpointing ...
2021-03-02 22:28:25,885 - root - INFO - train loss:0.1732!
2021-03-02 22:28:27,181 - root - INFO - f1:0.1484, p:0.1722, r:0.1845, hit:0.7285, ndcg:0.4656, topn:10.
2021-03-02 22:28:28,444 - root - INFO - f1:0.1782, p:0.2859, r:0.1708, hit:0.8579, ndcg:0.5871, topn:10.
2021-03-02 22:28:28,448 - root - INFO - Checkpointing ...
2021-03-02 22:28:50,807 - root - INFO - train loss:0.1630!
2021-03-02 22:28:52,147 - root - INFO - f1:0.1519, p:0.1767, r:0.1883, hit:0.7381, ndcg:0.4765, topn:10.
2021-03-02 22:28:53,432 - root - INFO - f1:0.1823, p:0.2925, r:0.1748, hit:0.8706, ndcg:0.5957, topn:10.
2021-03-02 22:28:53,437 - root - INFO - Checkpointing ...
2021-03-02 22:29:14,920 - root - INFO - train loss:0.1559!
2021-03-02 22:29:16,228 - root - INFO - f1:0.1556, p:0.1810, r:0.1926, hit:0.7497, ndcg:0.4851, topn:10.
2021-03-02 22:29:17,505 - root - INFO - f1:0.1862, p:0.2978, r:0.1795, hit:0.8759, ndcg:0.6021, topn:10.
2021-03-02 22:29:17,509 - root - INFO - Checkpointing ...
2021-03-02 22:29:39,583 - root - INFO - train loss:0.1516!
2021-03-02 22:29:40,919 - root - INFO - f1:0.1579, p:0.1837, r:0.1949, hit:0.7413, ndcg:0.4810, topn:10.
2021-03-02 22:29:42,233 - root - INFO - f1:0.1896, p:0.3027, r:0.1837, hit:0.8834, ndcg:0.6092, topn:10.
2021-03-02 22:29:42,237 - root - INFO - Checkpointing ...
2021-03-02 22:30:03,839 - root - INFO - train loss:0.1475!
2021-03-02 22:30:05,118 - root - INFO - f1:0.1603, p:0.1862, r:0.1986, hit:0.7434, ndcg:0.4846, topn:10.
2021-03-02 22:30:06,450 - root - INFO - f1:0.1926, p:0.3068, r:0.1863, hit:0.8876, ndcg:0.6153, topn:10.
2021-03-02 22:30:06,454 - root - INFO - Checkpointing ...
2021-03-02 22:30:27,584 - root - INFO - train loss:0.1445!
2021-03-02 22:30:29,039 - root - INFO - f1:0.1635, p:0.1895, r:0.2021, hit:0.7540, ndcg:0.4869, topn:10.
2021-03-02 22:30:30,424 - root - INFO - f1:0.1947, p:0.3102, r:0.1885, hit:0.8844, ndcg:0.6168, topn:10.
2021-03-02 22:30:30,428 - root - INFO - Checkpointing ...
2021-03-02 22:30:52,578 - root - INFO - train loss:0.1417!
2021-03-02 22:30:53,878 - root - INFO - f1:0.1660, p:0.1925, r:0.2048, hit:0.7593, ndcg:0.4937, topn:10.
2021-03-02 22:30:55,097 - root - INFO - f1:0.1980, p:0.3148, r:0.1912, hit:0.8887, ndcg:0.6217, topn:10.
2021-03-02 22:30:55,101 - root - INFO - Checkpointing ...
2021-03-02 22:31:17,527 - root - INFO - train loss:0.1390!
2021-03-02 22:31:18,799 - root - INFO - f1:0.1679, p:0.1947, r:0.2073, hit:0.7593, ndcg:0.4957, topn:10.
2021-03-02 22:31:20,075 - root - INFO - f1:0.1993, p:0.3170, r:0.1921, hit:0.8897, ndcg:0.6252, topn:10.
2021-03-02 22:31:20,079 - root - INFO - Checkpointing ...
2021-03-02 22:31:42,288 - root - INFO - train loss:0.1369!
2021-03-02 22:31:43,592 - root - INFO - f1:0.1689, p:0.1954, r:0.2089, hit:0.7572, ndcg:0.5003, topn:10.
2021-03-02 22:31:44,855 - root - INFO - f1:0.2021, p:0.3215, r:0.1947, hit:0.8918, ndcg:0.6289, topn:10.
2021-03-02 22:31:44,858 - root - INFO - Checkpointing ...
2021-03-02 22:32:07,409 - root - INFO - train loss:0.1353!
2021-03-02 22:32:08,668 - root - INFO - f1:0.1690, p:0.1954, r:0.2095, hit:0.7625, ndcg:0.5042, topn:10.
2021-03-02 22:32:09,991 - root - INFO - f1:0.2038, p:0.3238, r:0.1965, hit:0.8950, ndcg:0.6323, topn:10.
2021-03-02 22:32:09,994 - root - INFO - Checkpointing ...
2021-03-02 22:32:32,004 - root - INFO - train loss:0.1341!
2021-03-02 22:32:33,266 - root - INFO - f1:0.1703, p:0.1975, r:0.2108, hit:0.7625, ndcg:0.5030, topn:10.
2021-03-02 22:32:34,519 - root - INFO - f1:0.2054, p:0.3256, r:0.1990, hit:0.8940, ndcg:0.6332, topn:10.
2021-03-02 22:32:34,524 - root - INFO - Checkpointing ...
2021-03-02 22:32:55,455 - root - INFO - train loss:0.1324!
2021-03-02 22:32:56,767 - root - INFO - f1:0.1712, p:0.1983, r:0.2132, hit:0.7667, ndcg:0.5064, topn:10.
2021-03-02 22:32:57,992 - root - INFO - f1:0.2063, p:0.3274, r:0.1997, hit:0.8971, ndcg:0.6382, topn:10.
2021-03-02 22:32:57,995 - root - INFO - Checkpointing ...
2021-03-02 22:33:20,285 - root - INFO - train loss:0.1307!
2021-03-02 22:33:21,546 - root - INFO - f1:0.1732, p:0.2004, r:0.2151, hit:0.7688, ndcg:0.5091, topn:10.
2021-03-02 22:33:22,841 - root - INFO - f1:0.2082, p:0.3302, r:0.2014, hit:0.8993, ndcg:0.6386, topn:10.
2021-03-02 22:33:22,846 - root - INFO - Checkpointing ...
2021-03-02 22:33:45,032 - root - INFO - train loss:0.1296!
2021-03-02 22:33:46,306 - root - INFO - f1:0.1745, p:0.2020, r:0.2164, hit:0.7720, ndcg:0.5123, topn:10.
2021-03-02 22:33:47,593 - root - INFO - f1:0.2099, p:0.3323, r:0.2032, hit:0.8993, ndcg:0.6401, topn:10.
2021-03-02 22:33:47,596 - root - INFO - Checkpointing ...
2021-03-02 22:34:08,545 - root - INFO - train loss:0.1288!
2021-03-02 22:34:09,863 - root - INFO - f1:0.1757, p:0.2034, r:0.2179, hit:0.7731, ndcg:0.5143, topn:10.
2021-03-02 22:34:11,199 - root - INFO - f1:0.2118, p:0.3350, r:0.2058, hit:0.9014, ndcg:0.6410, topn:10.
2021-03-02 22:34:11,203 - root - INFO - Checkpointing ...
2021-03-02 22:34:33,146 - root - INFO - train loss:0.1273!
2021-03-02 22:34:34,429 - root - INFO - f1:0.1764, p:0.2045, r:0.2179, hit:0.7720, ndcg:0.5172, topn:10.
2021-03-02 22:34:35,791 - root - INFO - f1:0.2115, p:0.3349, r:0.2054, hit:0.9014, ndcg:0.6447, topn:10.
2021-03-02 22:34:35,796 - root - INFO - Checkpointing ...
2021-03-02 22:34:59,866 - root - INFO - train loss:0.1264!
2021-03-02 22:35:01,196 - root - INFO - f1:0.1775, p:0.2057, r:0.2195, hit:0.7773, ndcg:0.5208, topn:10.
2021-03-02 22:35:02,545 - root - INFO - f1:0.2123, p:0.3358, r:0.2063, hit:0.9014, ndcg:0.6453, topn:10.
2021-03-02 22:35:02,550 - root - INFO - Checkpointing ...
2021-03-02 22:35:26,040 - root - INFO - train loss:0.1253!
2021-03-02 22:35:27,377 - root - INFO - f1:0.1774, p:0.2058, r:0.2198, hit:0.7773, ndcg:0.5231, topn:10.
2021-03-02 22:35:28,681 - root - INFO - f1:0.2133, p:0.3370, r:0.2075, hit:0.9046, ndcg:0.6499, topn:10.
2021-03-02 22:35:28,685 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:35:51,038 - root - INFO - train loss:0.1289!
2021-03-02 22:35:52,499 - root - INFO - f1:0.1847, p:0.2124, r:0.2325, hit:0.7869, ndcg:0.5415, topn:10.
2021-03-02 22:35:53,827 - root - INFO - f1:0.2202, p:0.3485, r:0.2109, hit:0.9099, ndcg:0.6811, topn:10.
2021-03-02 22:35:53,831 - root - INFO - Checkpointing ...
2021-03-02 22:36:14,940 - root - INFO - train loss:0.1212!
2021-03-02 22:36:16,281 - root - INFO - f1:0.1898, p:0.2172, r:0.2396, hit:0.7996, ndcg:0.5505, topn:10.
2021-03-02 22:36:17,486 - root - INFO - f1:0.2255, p:0.3552, r:0.2173, hit:0.9141, ndcg:0.6839, topn:10.
2021-03-02 22:36:17,490 - root - INFO - Checkpointing ...
2021-03-02 22:36:40,147 - root - INFO - train loss:0.1193!
2021-03-02 22:36:41,466 - root - INFO - f1:0.1914, p:0.2196, r:0.2417, hit:0.7985, ndcg:0.5567, topn:10.
2021-03-02 22:36:42,834 - root - INFO - f1:0.2265, p:0.3577, r:0.2178, hit:0.9152, ndcg:0.6904, topn:10.
2021-03-02 22:36:42,838 - root - INFO - Checkpointing ...
2021-03-02 22:37:02,471 - root - INFO - train loss:0.1171!
2021-03-02 22:37:03,817 - root - INFO - f1:0.1929, p:0.2211, r:0.2431, hit:0.8049, ndcg:0.5599, topn:10.
2021-03-02 22:37:05,129 - root - INFO - f1:0.2279, p:0.3600, r:0.2199, hit:0.9130, ndcg:0.6945, topn:10.
2021-03-02 22:37:05,133 - root - INFO - Checkpointing ...
2021-03-02 22:37:27,118 - root - INFO - train loss:0.1155!
2021-03-02 22:37:28,369 - root - INFO - f1:0.1931, p:0.2216, r:0.2436, hit:0.8049, ndcg:0.5602, topn:10.
2021-03-02 22:37:29,713 - root - INFO - f1:0.2295, p:0.3619, r:0.2217, hit:0.9141, ndcg:0.6953, topn:10.
2021-03-02 22:37:29,717 - root - INFO - Checkpointing ...
2021-03-02 22:37:50,357 - root - INFO - train loss:0.1143!
2021-03-02 22:37:51,597 - root - INFO - f1:0.1942, p:0.2226, r:0.2451, hit:0.8028, ndcg:0.5625, topn:10.
2021-03-02 22:37:52,764 - root - INFO - f1:0.2305, p:0.3636, r:0.2226, hit:0.9152, ndcg:0.6961, topn:10.
2021-03-02 22:37:52,767 - root - INFO - Checkpointing ...
2021-03-02 22:38:12,857 - root - INFO - train loss:0.1135!
2021-03-02 22:38:14,145 - root - INFO - f1:0.1958, p:0.2242, r:0.2476, hit:0.8070, ndcg:0.5654, topn:10.
2021-03-02 22:38:15,440 - root - INFO - f1:0.2315, p:0.3656, r:0.2228, hit:0.9141, ndcg:0.6993, topn:10.
2021-03-02 22:38:15,445 - root - INFO - Checkpointing ...
2021-03-02 22:38:39,099 - root - INFO - train loss:0.1127!
2021-03-02 22:38:40,413 - root - INFO - f1:0.1967, p:0.2255, r:0.2480, hit:0.8091, ndcg:0.5678, topn:10.
2021-03-02 22:38:41,748 - root - INFO - f1:0.2324, p:0.3671, r:0.2241, hit:0.9152, ndcg:0.6987, topn:10.
2021-03-02 22:38:41,752 - root - INFO - Checkpointing ...
2021-03-02 22:39:04,617 - root - INFO - train loss:0.1118!
2021-03-02 22:39:05,835 - root - INFO - f1:0.1976, p:0.2264, r:0.2495, hit:0.8081, ndcg:0.5688, topn:10.
2021-03-02 22:39:07,141 - root - INFO - f1:0.2326, p:0.3678, r:0.2239, hit:0.9152, ndcg:0.6997, topn:10.
2021-03-02 22:39:07,145 - root - INFO - Checkpointing ...
2021-03-02 22:39:28,746 - root - INFO - train loss:0.1106!
2021-03-02 22:39:30,073 - root - INFO - f1:0.1969, p:0.2255, r:0.2491, hit:0.8081, ndcg:0.5705, topn:10.
2021-03-02 22:39:31,386 - root - INFO - f1:0.2332, p:0.3686, r:0.2245, hit:0.9152, ndcg:0.7014, topn:10.
2021-03-02 22:39:31,390 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:39:54,002 - root - INFO - train loss:0.1128!
2021-03-02 22:39:55,320 - root - INFO - f1:0.1974, p:0.2267, r:0.2488, hit:0.8028, ndcg:0.5715, topn:10.
2021-03-02 22:39:56,586 - root - INFO - f1:0.2347, p:0.3712, r:0.2255, hit:0.9173, ndcg:0.7034, topn:10.
2021-03-02 22:39:56,590 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:40:17,200 - root - INFO - train loss:0.1116!
2021-03-02 22:40:18,482 - root - INFO - f1:0.1963, p:0.2258, r:0.2470, hit:0.8006, ndcg:0.5730, topn:10.
2021-03-02 22:40:19,841 - root - INFO - f1:0.2348, p:0.3713, r:0.2248, hit:0.9162, ndcg:0.7014, topn:10.
2021-03-02 22:40:19,846 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:40:39,406 - root - INFO - train loss:0.1108!
2021-03-02 22:40:40,726 - root - INFO - f1:0.1969, p:0.2267, r:0.2474, hit:0.8038, ndcg:0.5752, topn:10.
2021-03-02 22:40:42,035 - root - INFO - f1:0.2353, p:0.3719, r:0.2256, hit:0.9141, ndcg:0.7016, topn:10.
2021-03-02 22:40:42,039 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:41:03,738 - root - INFO - train loss:0.1098!
2021-03-02 22:41:05,028 - root - INFO - f1:0.1965, p:0.2264, r:0.2467, hit:0.8038, ndcg:0.5754, topn:10.
2021-03-02 22:41:06,542 - root - INFO - f1:0.2358, p:0.3727, r:0.2260, hit:0.9152, ndcg:0.7023, topn:10.
2021-03-02 22:41:06,546 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:41:06,595 - root - INFO - No improvement after 13317 steps. Stopping training.
2021-03-02 22:41:08,268 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.226193, 'RECALL@10': 0.246038, 'NDCG@10': 0.57562, 'MAP@10': 0.467346, 'MAP': 0.467346}.
2021-03-02 22:41:08,498 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.473621, 'GENRE_REDUNDANCY@10': 0.429818, 'ILD_GENRE@10': 0.812133}.
2021-03-02 22:41:10,134 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.372959, 'RECALL@10': 0.225973, 'NDCG@10': 0.702388, 'MAP@10': 0.598311, 'MAP': 0.598311}.
2021-03-02 22:41:10,307 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.470219, 'GENRE_REDUNDANCY@10': 0.425095, 'ILD_GENRE@10': 0.810216}.
