2021-03-02 22:14:57,906 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614734097",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-02 22:14:57,917 - root - INFO - Totally 2715 train triples, 311,580 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/cao-format/ml1m/kg/test.dat!
2021-03-02 22:14:57,919 - root - INFO - successfully load 1536 entities and 3 relations!
2021-03-02 22:14:57,924 - root - INFO - Building model.
2021-03-02 22:14:59,194 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(1536, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-02 22:14:59,194 - root - INFO - Total params: 154200.0
2021-03-02 22:14:59,195 - root - INFO - One epoch is 11 steps.
2021-03-02 22:14:59,195 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-02 22:14:59,197 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-mv-complex-50/ml1m-transe-pretrained.ckpt.
2021-03-02 22:14:59,198 - root - INFO - Training.
2021-03-02 22:14:59,198 - root - INFO - train loss:0.0000!
2021-03-02 22:14:59,781 - root - INFO - head hit:0.2990, head mean rank:317.7428, topn:10.
2021-03-02 22:14:59,781 - root - INFO - tail hit:0.8457, tail mean rank:8.5016, topn:10.
2021-03-02 22:14:59,781 - root - INFO - avg hit:0.5723, avg mean rank:163.1222, topn:10.
2021-03-02 22:15:00,682 - root - INFO - head hit:0.3397, head mean rank:297.5155, topn:10.
2021-03-02 22:15:00,683 - root - INFO - tail hit:0.8397, tail mean rank:10.1638, topn:10.
2021-03-02 22:15:00,683 - root - INFO - avg hit:0.5897, avg mean rank:153.8397, topn:10.
2021-03-02 22:15:38,951 - root - INFO - train loss:0.0216!
2021-03-02 22:15:39,499 - root - INFO - head hit:0.2540, head mean rank:306.1865, topn:10.
2021-03-02 22:15:39,499 - root - INFO - tail hit:0.7846, tail mean rank:8.4566, topn:10.
2021-03-02 22:15:39,499 - root - INFO - avg hit:0.5193, avg mean rank:157.3215, topn:10.
2021-03-02 22:15:40,298 - root - INFO - head hit:0.2621, head mean rank:307.6793, topn:10.
2021-03-02 22:15:40,298 - root - INFO - tail hit:0.7983, tail mean rank:12.9121, topn:10.
2021-03-02 22:15:40,298 - root - INFO - avg hit:0.5302, avg mean rank:160.2957, topn:10.
2021-03-02 22:15:40,299 - root - INFO - Checkpointing ...
2021-03-02 22:16:19,543 - root - INFO - train loss:0.0226!
2021-03-02 22:16:20,110 - root - INFO - head hit:0.2379, head mean rank:321.4952, topn:10.
2021-03-02 22:16:20,110 - root - INFO - tail hit:0.7749, tail mean rank:12.5788, topn:10.
2021-03-02 22:16:20,110 - root - INFO - avg hit:0.5064, avg mean rank:167.0370, topn:10.
2021-03-02 22:16:20,975 - root - INFO - head hit:0.2638, head mean rank:292.2293, topn:10.
2021-03-02 22:16:20,975 - root - INFO - tail hit:0.7845, tail mean rank:12.6069, topn:10.
2021-03-02 22:16:20,975 - root - INFO - avg hit:0.5241, avg mean rank:152.4181, topn:10.
2021-03-02 22:16:20,976 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:16:59,119 - root - INFO - train loss:0.0047!
2021-03-02 22:16:59,697 - root - INFO - head hit:0.2958, head mean rank:309.4759, topn:10.
2021-03-02 22:16:59,698 - root - INFO - tail hit:0.7974, tail mean rank:9.5691, topn:10.
2021-03-02 22:16:59,698 - root - INFO - avg hit:0.5466, avg mean rank:159.5225, topn:10.
2021-03-02 22:17:00,518 - root - INFO - head hit:0.3345, head mean rank:279.3914, topn:10.
2021-03-02 22:17:00,519 - root - INFO - tail hit:0.8138, tail mean rank:10.7517, topn:10.
2021-03-02 22:17:00,519 - root - INFO - avg hit:0.5741, avg mean rank:145.0716, topn:10.
2021-03-02 22:17:00,520 - root - INFO - Checkpointing ...
2021-03-02 22:17:37,361 - root - INFO - train loss:0.0022!
2021-03-02 22:17:37,949 - root - INFO - head hit:0.2894, head mean rank:297.6495, topn:10.
2021-03-02 22:17:37,949 - root - INFO - tail hit:0.7749, tail mean rank:10.4887, topn:10.
2021-03-02 22:17:37,950 - root - INFO - avg hit:0.5322, avg mean rank:154.0691, topn:10.
2021-03-02 22:17:38,750 - root - INFO - head hit:0.3259, head mean rank:274.9966, topn:10.
2021-03-02 22:17:38,750 - root - INFO - tail hit:0.8000, tail mean rank:12.8931, topn:10.
2021-03-02 22:17:38,750 - root - INFO - avg hit:0.5629, avg mean rank:143.9448, topn:10.
2021-03-02 22:17:38,751 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:18:15,834 - root - INFO - train loss:0.0005!
2021-03-02 22:18:16,443 - root - INFO - head hit:0.3087, head mean rank:297.9711, topn:10.
2021-03-02 22:18:16,443 - root - INFO - tail hit:0.8264, tail mean rank:7.7974, topn:10.
2021-03-02 22:18:16,443 - root - INFO - avg hit:0.5675, avg mean rank:152.8842, topn:10.
2021-03-02 22:18:17,282 - root - INFO - head hit:0.3500, head mean rank:275.3500, topn:10.
2021-03-02 22:18:17,283 - root - INFO - tail hit:0.8362, tail mean rank:9.2276, topn:10.
2021-03-02 22:18:17,283 - root - INFO - avg hit:0.5931, avg mean rank:142.2888, topn:10.
2021-03-02 22:18:17,283 - root - INFO - Checkpointing ...
2021-03-02 22:18:52,826 - root - INFO - train loss:0.0001!
2021-03-02 22:18:53,396 - root - INFO - head hit:0.2926, head mean rank:297.3441, topn:10.
2021-03-02 22:18:53,397 - root - INFO - tail hit:0.8392, tail mean rank:7.2283, topn:10.
2021-03-02 22:18:53,397 - root - INFO - avg hit:0.5659, avg mean rank:152.2862, topn:10.
2021-03-02 22:18:54,234 - root - INFO - head hit:0.3414, head mean rank:276.1293, topn:10.
2021-03-02 22:18:54,234 - root - INFO - tail hit:0.8345, tail mean rank:9.1552, topn:10.
2021-03-02 22:18:54,234 - root - INFO - avg hit:0.5879, avg mean rank:142.6422, topn:10.
2021-03-02 22:18:54,235 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:19:29,712 - root - INFO - train loss:0.0001!
2021-03-02 22:19:30,321 - root - INFO - head hit:0.2926, head mean rank:297.3762, topn:10.
2021-03-02 22:19:30,321 - root - INFO - tail hit:0.8392, tail mean rank:7.1318, topn:10.
2021-03-02 22:19:30,321 - root - INFO - avg hit:0.5659, avg mean rank:152.2540, topn:10.
2021-03-02 22:19:31,116 - root - INFO - head hit:0.3431, head mean rank:276.9034, topn:10.
2021-03-02 22:19:31,116 - root - INFO - tail hit:0.8362, tail mean rank:9.4069, topn:10.
2021-03-02 22:19:31,116 - root - INFO - avg hit:0.5897, avg mean rank:143.1552, topn:10.
2021-03-02 22:19:31,117 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:20:06,383 - root - INFO - train loss:0.0000!
2021-03-02 22:20:06,912 - root - INFO - head hit:0.2926, head mean rank:297.2765, topn:10.
2021-03-02 22:20:06,912 - root - INFO - tail hit:0.8328, tail mean rank:7.1318, topn:10.
2021-03-02 22:20:06,912 - root - INFO - avg hit:0.5627, avg mean rank:152.2042, topn:10.
2021-03-02 22:20:07,709 - root - INFO - head hit:0.3483, head mean rank:276.9724, topn:10.
2021-03-02 22:20:07,709 - root - INFO - tail hit:0.8362, tail mean rank:9.3638, topn:10.
2021-03-02 22:20:07,709 - root - INFO - avg hit:0.5922, avg mean rank:143.1681, topn:10.
2021-03-02 22:20:07,710 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:20:45,069 - root - INFO - train loss:0.0000!
2021-03-02 22:20:45,686 - root - INFO - head hit:0.2926, head mean rank:297.2733, topn:10.
2021-03-02 22:20:45,687 - root - INFO - tail hit:0.8328, tail mean rank:7.1318, topn:10.
2021-03-02 22:20:45,687 - root - INFO - avg hit:0.5627, avg mean rank:152.2026, topn:10.
2021-03-02 22:20:46,495 - root - INFO - head hit:0.3483, head mean rank:276.9672, topn:10.
2021-03-02 22:20:46,495 - root - INFO - tail hit:0.8362, tail mean rank:9.3621, topn:10.
2021-03-02 22:20:46,496 - root - INFO - avg hit:0.5922, avg mean rank:143.1647, topn:10.
2021-03-02 22:20:46,496 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 22:21:22,550 - root - INFO - No improvement after 24363 steps. Stopping training.
