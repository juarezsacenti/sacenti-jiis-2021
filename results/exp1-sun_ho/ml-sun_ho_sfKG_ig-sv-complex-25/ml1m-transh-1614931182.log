2021-03-05 04:59:42,439 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-25/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-25/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614931182",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-25/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-25/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-05 04:59:42,456 - root - INFO - Totally 3763 train triples, 481,992 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-25/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-25/cao-format/ml1m/kg/test.dat!
2021-03-05 04:59:42,458 - root - INFO - successfully load 1703 entities and 3 relations!
2021-03-05 04:59:42,464 - root - INFO - Building model.
2021-03-05 04:59:43,924 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(1703, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-05 04:59:43,925 - root - INFO - Total params: 170900.0
2021-03-05 04:59:43,925 - root - INFO - One epoch is 15 steps.
2021-03-05 04:59:43,926 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-05 04:59:43,928 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sfKG_ig-sv-complex-25/ml1m-transe-pretrained.ckpt.
2021-03-05 04:59:43,929 - root - INFO - Training.
2021-03-05 04:59:43,929 - root - INFO - train loss:0.0000!
2021-03-05 04:59:44,631 - root - INFO - head hit:0.2474, head mean rank:389.8378, topn:10.
2021-03-05 04:59:44,632 - root - INFO - tail hit:0.7256, tail mean rank:16.9834, topn:10.
2021-03-05 04:59:44,632 - root - INFO - avg hit:0.4865, avg mean rank:203.4106, topn:10.
2021-03-05 04:59:45,846 - root - INFO - head hit:0.2591, head mean rank:384.0262, topn:10.
2021-03-05 04:59:45,847 - root - INFO - tail hit:0.7137, tail mean rank:17.1431, topn:10.
2021-03-05 04:59:45,847 - root - INFO - avg hit:0.4864, avg mean rank:200.5847, topn:10.
2021-03-05 05:00:22,888 - root - INFO - train loss:0.0311!
2021-03-05 05:00:23,622 - root - INFO - head hit:0.1933, head mean rank:398.5572, topn:10.
2021-03-05 05:00:23,623 - root - INFO - tail hit:0.6757, tail mean rank:21.5509, topn:10.
2021-03-05 05:00:23,623 - root - INFO - avg hit:0.4345, avg mean rank:210.0541, topn:10.
2021-03-05 05:00:24,836 - root - INFO - head hit:0.2157, head mean rank:401.8931, topn:10.
2021-03-05 05:00:24,837 - root - INFO - tail hit:0.6663, tail mean rank:22.5756, topn:10.
2021-03-05 05:00:24,837 - root - INFO - avg hit:0.4410, avg mean rank:212.2344, topn:10.
2021-03-05 05:00:24,838 - root - INFO - Checkpointing ...
2021-03-05 05:01:00,324 - root - INFO - train loss:0.0433!
2021-03-05 05:01:01,070 - root - INFO - head hit:0.2100, head mean rank:398.1414, topn:10.
2021-03-05 05:01:01,070 - root - INFO - tail hit:0.6840, tail mean rank:21.4678, topn:10.
2021-03-05 05:01:01,070 - root - INFO - avg hit:0.4470, avg mean rank:209.8046, topn:10.
2021-03-05 05:01:02,294 - root - INFO - head hit:0.1885, head mean rank:393.3760, topn:10.
2021-03-05 05:01:02,294 - root - INFO - tail hit:0.6472, tail mean rank:24.4980, topn:10.
2021-03-05 05:01:02,294 - root - INFO - avg hit:0.4178, avg mean rank:208.9370, topn:10.
2021-03-05 05:01:02,295 - root - INFO - Checkpointing ...
2021-03-05 05:01:38,557 - root - INFO - train loss:0.0422!
2021-03-05 05:01:39,320 - root - INFO - head hit:0.2058, head mean rank:379.3160, topn:10.
2021-03-05 05:01:39,321 - root - INFO - tail hit:0.6549, tail mean rank:22.1102, topn:10.
2021-03-05 05:01:39,321 - root - INFO - avg hit:0.4304, avg mean rank:200.7131, topn:10.
2021-03-05 05:01:40,586 - root - INFO - head hit:0.2319, head mean rank:374.5958, topn:10.
2021-03-05 05:01:40,586 - root - INFO - tail hit:0.6502, tail mean rank:25.5433, topn:10.
2021-03-05 05:01:40,586 - root - INFO - avg hit:0.4410, avg mean rank:200.0696, topn:10.
2021-03-05 05:01:40,587 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 05:02:15,937 - root - INFO - train loss:0.0109!
2021-03-05 05:02:16,647 - root - INFO - head hit:0.2474, head mean rank:370.8046, topn:10.
2021-03-05 05:02:16,647 - root - INFO - tail hit:0.7027, tail mean rank:17.5322, topn:10.
2021-03-05 05:02:16,647 - root - INFO - avg hit:0.4751, avg mean rank:194.1684, topn:10.
2021-03-05 05:02:17,862 - root - INFO - head hit:0.2510, head mean rank:364.1210, topn:10.
2021-03-05 05:02:17,863 - root - INFO - tail hit:0.6835, tail mean rank:18.1683, topn:10.
2021-03-05 05:02:17,863 - root - INFO - avg hit:0.4672, avg mean rank:191.1447, topn:10.
2021-03-05 05:02:17,863 - root - INFO - Checkpointing ...
2021-03-05 05:02:50,920 - root - INFO - train loss:0.0050!
2021-03-05 05:02:51,560 - root - INFO - head hit:0.2536, head mean rank:377.1393, topn:10.
2021-03-05 05:02:51,560 - root - INFO - tail hit:0.7152, tail mean rank:18.1996, topn:10.
2021-03-05 05:02:51,561 - root - INFO - avg hit:0.4844, avg mean rank:197.6694, topn:10.
2021-03-05 05:02:52,810 - root - INFO - head hit:0.2631, head mean rank:367.3216, topn:10.
2021-03-05 05:02:52,810 - root - INFO - tail hit:0.7077, tail mean rank:18.9385, topn:10.
2021-03-05 05:02:52,810 - root - INFO - avg hit:0.4854, avg mean rank:193.1300, topn:10.
2021-03-05 05:02:52,811 - root - INFO - Checkpointing ...
2021-03-05 05:03:26,716 - root - INFO - train loss:0.0028!
2021-03-05 05:03:27,493 - root - INFO - head hit:0.2661, head mean rank:376.2661, topn:10.
2021-03-05 05:03:27,493 - root - INFO - tail hit:0.6798, tail mean rank:19.1143, topn:10.
2021-03-05 05:03:27,493 - root - INFO - avg hit:0.4730, avg mean rank:197.6902, topn:10.
2021-03-05 05:03:28,776 - root - INFO - head hit:0.2661, head mean rank:363.5635, topn:10.
2021-03-05 05:03:28,777 - root - INFO - tail hit:0.6663, tail mean rank:21.5524, topn:10.
2021-03-05 05:03:28,777 - root - INFO - avg hit:0.4662, avg mean rank:192.5580, topn:10.
2021-03-05 05:03:28,778 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 05:04:04,300 - root - INFO - train loss:0.0010!
2021-03-05 05:04:04,991 - root - INFO - head hit:0.2661, head mean rank:376.5863, topn:10.
2021-03-05 05:04:04,992 - root - INFO - tail hit:0.6985, tail mean rank:15.5696, topn:10.
2021-03-05 05:04:04,992 - root - INFO - avg hit:0.4823, avg mean rank:196.0780, topn:10.
2021-03-05 05:04:06,315 - root - INFO - head hit:0.2762, head mean rank:362.7177, topn:10.
2021-03-05 05:04:06,315 - root - INFO - tail hit:0.7036, tail mean rank:17.4446, topn:10.
2021-03-05 05:04:06,315 - root - INFO - avg hit:0.4899, avg mean rank:190.0811, topn:10.
2021-03-05 05:04:06,316 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 05:04:39,857 - root - INFO - train loss:0.0003!
2021-03-05 05:04:40,590 - root - INFO - head hit:0.2786, head mean rank:375.1102, topn:10.
2021-03-05 05:04:40,590 - root - INFO - tail hit:0.7110, tail mean rank:15.2807, topn:10.
2021-03-05 05:04:40,590 - root - INFO - avg hit:0.4948, avg mean rank:195.1954, topn:10.
2021-03-05 05:04:41,780 - root - INFO - head hit:0.2792, head mean rank:361.0625, topn:10.
2021-03-05 05:04:41,780 - root - INFO - tail hit:0.7046, tail mean rank:17.3417, topn:10.
2021-03-05 05:04:41,780 - root - INFO - avg hit:0.4919, avg mean rank:189.2021, topn:10.
2021-03-05 05:04:41,781 - root - INFO - Checkpointing ...
2021-03-05 05:05:14,073 - root - INFO - train loss:0.0002!
2021-03-05 05:05:14,779 - root - INFO - head hit:0.2744, head mean rank:374.5364, topn:10.
2021-03-05 05:05:14,780 - root - INFO - tail hit:0.7214, tail mean rank:14.2204, topn:10.
2021-03-05 05:05:14,780 - root - INFO - avg hit:0.4979, avg mean rank:194.3784, topn:10.
2021-03-05 05:05:16,016 - root - INFO - head hit:0.2833, head mean rank:361.7077, topn:10.
2021-03-05 05:05:16,017 - root - INFO - tail hit:0.7268, tail mean rank:16.0222, topn:10.
2021-03-05 05:05:16,017 - root - INFO - avg hit:0.5050, avg mean rank:188.8649, topn:10.
2021-03-05 05:05:16,017 - root - INFO - Checkpointing ...
2021-03-05 05:05:50,539 - root - INFO - train loss:0.0001!
2021-03-05 05:05:51,160 - root - INFO - head hit:0.2744, head mean rank:374.9938, topn:10.
2021-03-05 05:05:51,160 - root - INFO - tail hit:0.7235, tail mean rank:14.1746, topn:10.
2021-03-05 05:05:51,160 - root - INFO - avg hit:0.4990, avg mean rank:194.5842, topn:10.
2021-03-05 05:05:52,247 - root - INFO - head hit:0.2823, head mean rank:361.5363, topn:10.
2021-03-05 05:05:52,247 - root - INFO - tail hit:0.7258, tail mean rank:15.8821, topn:10.
2021-03-05 05:05:52,247 - root - INFO - avg hit:0.5040, avg mean rank:188.7092, topn:10.
2021-03-05 05:05:52,248 - root - INFO - Checkpointing ...
2021-03-05 05:06:26,943 - root - INFO - train loss:0.0003!
2021-03-05 05:06:27,718 - root - INFO - head hit:0.2703, head mean rank:373.9563, topn:10.
2021-03-05 05:06:27,719 - root - INFO - tail hit:0.7173, tail mean rank:14.1642, topn:10.
2021-03-05 05:06:27,719 - root - INFO - avg hit:0.4938, avg mean rank:194.0603, topn:10.
2021-03-05 05:06:29,035 - root - INFO - head hit:0.2823, head mean rank:360.1875, topn:10.
2021-03-05 05:06:29,035 - root - INFO - tail hit:0.7208, tail mean rank:15.9657, topn:10.
2021-03-05 05:06:29,035 - root - INFO - avg hit:0.5015, avg mean rank:188.0766, topn:10.
2021-03-05 05:06:29,036 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 05:07:04,425 - root - INFO - train loss:0.0001!
2021-03-05 05:07:05,155 - root - INFO - head hit:0.2682, head mean rank:373.9189, topn:10.
2021-03-05 05:07:05,155 - root - INFO - tail hit:0.7131, tail mean rank:14.6466, topn:10.
2021-03-05 05:07:05,156 - root - INFO - avg hit:0.4906, avg mean rank:194.2827, topn:10.
2021-03-05 05:07:06,492 - root - INFO - head hit:0.2823, head mean rank:359.8417, topn:10.
2021-03-05 05:07:06,493 - root - INFO - tail hit:0.7137, tail mean rank:16.4002, topn:10.
2021-03-05 05:07:06,493 - root - INFO - avg hit:0.4980, avg mean rank:188.1210, topn:10.
2021-03-05 05:07:06,493 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 05:07:40,261 - root - INFO - train loss:0.0000!
2021-03-05 05:07:41,057 - root - INFO - head hit:0.2744, head mean rank:374.4802, topn:10.
2021-03-05 05:07:41,058 - root - INFO - tail hit:0.7131, tail mean rank:14.5156, topn:10.
2021-03-05 05:07:41,058 - root - INFO - avg hit:0.4938, avg mean rank:194.4979, topn:10.
2021-03-05 05:07:42,341 - root - INFO - head hit:0.2802, head mean rank:360.4758, topn:10.
2021-03-05 05:07:42,342 - root - INFO - tail hit:0.7167, tail mean rank:16.1815, topn:10.
2021-03-05 05:07:42,342 - root - INFO - avg hit:0.4985, avg mean rank:188.3286, topn:10.
2021-03-05 05:07:42,342 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 05:08:17,544 - root - INFO - train loss:0.0000!
2021-03-05 05:08:18,264 - root - INFO - head hit:0.2765, head mean rank:374.4761, topn:10.
2021-03-05 05:08:18,264 - root - INFO - tail hit:0.7131, tail mean rank:14.4595, topn:10.
2021-03-05 05:08:18,264 - root - INFO - avg hit:0.4948, avg mean rank:194.4678, topn:10.
2021-03-05 05:08:19,499 - root - INFO - head hit:0.2772, head mean rank:360.4970, topn:10.
2021-03-05 05:08:19,500 - root - INFO - tail hit:0.7177, tail mean rank:16.1129, topn:10.
2021-03-05 05:08:19,500 - root - INFO - avg hit:0.4975, avg mean rank:188.3049, topn:10.
2021-03-05 05:08:19,501 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-05 05:08:55,602 - root - INFO - No improvement after 24363 steps. Stopping training.
