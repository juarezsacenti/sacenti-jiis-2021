2021-03-01 22:10:06,777 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_oKG/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_oKG/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 13317,
    "embedding_size": 100,
    "eval_interval_steps": 2663,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transup-1614647406",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": null,
    "l2_lambda": 1e-05,
    "learning_rate": 0.005,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_oKG/ml1m-bprmf-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_oKG/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transup",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 3,
    "num_processes": 4,
    "optimizer_type": "Adagrad",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 266300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-01 22:10:07,014 - root - INFO - Totally 69982 train ratings, 9998,19995 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_oKG/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_oKG/cao-format/ml1m/test.dat!
2021-03-01 22:10:07,017 - root - INFO - successfully load 943 users and 1675 items!
2021-03-01 22:10:07,096 - root - INFO - Building model.
2021-03-01 22:10:08,368 - root - INFO - Architecture: TransUPModel(
  (user_embeddings): Embedding(943, 100)
  (item_embeddings): Embedding(1675, 100)
  (pref_embeddings): Embedding(3, 100)
  (pref_norm_embeddings): Embedding(3, 100)
)
2021-03-01 22:10:08,369 - root - INFO - Total params: 262400.0
2021-03-01 22:10:08,369 - root - INFO - One epoch is 274 steps.
2021-03-01 22:10:08,370 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-01 22:10:08,373 - root - INFO - Load Embeddings of user_embeddings.weight, item_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_oKG/ml1m-bprmf-pretrained.ckpt.
2021-03-01 22:10:08,374 - root - INFO - Training.
2021-03-01 22:10:08,374 - root - INFO - train loss:0.0000!
2021-03-01 22:10:09,713 - root - INFO - f1:0.0708, p:0.0958, r:0.0757, hit:0.4507, ndcg:0.2687, topn:10.
2021-03-01 22:10:10,864 - root - INFO - f1:0.0761, p:0.1577, r:0.0604, hit:0.5610, ndcg:0.3605, topn:10.
2021-03-01 22:10:33,054 - root - INFO - train loss:77.9847!
2021-03-01 22:10:34,275 - root - INFO - f1:0.1433, p:0.1656, r:0.1812, hit:0.7169, ndcg:0.4426, topn:10.
2021-03-01 22:10:35,477 - root - INFO - f1:0.1683, p:0.2727, r:0.1606, hit:0.8452, ndcg:0.5676, topn:10.
2021-03-01 22:10:35,481 - root - INFO - Checkpointing ...
2021-03-01 22:10:58,960 - root - INFO - train loss:0.1741!
2021-03-01 22:11:00,207 - root - INFO - f1:0.1478, p:0.1715, r:0.1847, hit:0.7243, ndcg:0.4555, topn:10.
2021-03-01 22:11:01,436 - root - INFO - f1:0.1733, p:0.2805, r:0.1657, hit:0.8526, ndcg:0.5838, topn:10.
2021-03-01 22:11:01,440 - root - INFO - Checkpointing ...
2021-03-01 22:11:21,142 - root - INFO - train loss:0.1634!
2021-03-01 22:11:22,338 - root - INFO - f1:0.1541, p:0.1779, r:0.1934, hit:0.7381, ndcg:0.4680, topn:10.
2021-03-01 22:11:23,463 - root - INFO - f1:0.1794, p:0.2902, r:0.1715, hit:0.8579, ndcg:0.5940, topn:10.
2021-03-01 22:11:23,468 - root - INFO - Checkpointing ...
2021-03-01 22:11:43,123 - root - INFO - train loss:0.1560!
2021-03-01 22:11:44,342 - root - INFO - f1:0.1564, p:0.1807, r:0.1960, hit:0.7487, ndcg:0.4756, topn:10.
2021-03-01 22:11:45,565 - root - INFO - f1:0.1823, p:0.2952, r:0.1740, hit:0.8547, ndcg:0.5990, topn:10.
2021-03-01 22:11:45,569 - root - INFO - Checkpointing ...
2021-03-01 22:12:07,280 - root - INFO - train loss:0.1520!
2021-03-01 22:12:08,514 - root - INFO - f1:0.1609, p:0.1857, r:0.2026, hit:0.7529, ndcg:0.4836, topn:10.
2021-03-01 22:12:09,660 - root - INFO - f1:0.1868, p:0.3006, r:0.1787, hit:0.8653, ndcg:0.6056, topn:10.
2021-03-01 22:12:09,665 - root - INFO - Checkpointing ...
2021-03-01 22:12:31,317 - root - INFO - train loss:0.1473!
2021-03-01 22:12:32,538 - root - INFO - f1:0.1631, p:0.1882, r:0.2046, hit:0.7529, ndcg:0.4881, topn:10.
2021-03-01 22:12:33,659 - root - INFO - f1:0.1895, p:0.3038, r:0.1819, hit:0.8706, ndcg:0.6112, topn:10.
2021-03-01 22:12:33,664 - root - INFO - Checkpointing ...
2021-03-01 22:12:53,028 - root - INFO - train loss:0.1448!
2021-03-01 22:12:54,439 - root - INFO - f1:0.1657, p:0.1913, r:0.2076, hit:0.7603, ndcg:0.4920, topn:10.
2021-03-01 22:12:55,630 - root - INFO - f1:0.1905, p:0.3067, r:0.1823, hit:0.8706, ndcg:0.6148, topn:10.
2021-03-01 22:12:55,635 - root - INFO - Checkpointing ...
2021-03-01 22:13:18,283 - root - INFO - train loss:0.1421!
2021-03-01 22:13:19,439 - root - INFO - f1:0.1668, p:0.1923, r:0.2099, hit:0.7635, ndcg:0.5000, topn:10.
2021-03-01 22:13:20,688 - root - INFO - f1:0.1941, p:0.3113, r:0.1862, hit:0.8759, ndcg:0.6205, topn:10.
2021-03-01 22:13:20,693 - root - INFO - Checkpointing ...
2021-03-01 22:13:42,574 - root - INFO - train loss:0.1395!
2021-03-01 22:13:43,732 - root - INFO - f1:0.1684, p:0.1944, r:0.2113, hit:0.7678, ndcg:0.5058, topn:10.
2021-03-01 22:13:44,930 - root - INFO - f1:0.1963, p:0.3145, r:0.1881, hit:0.8780, ndcg:0.6213, topn:10.
2021-03-01 22:13:44,934 - root - INFO - Checkpointing ...
2021-03-01 22:14:04,907 - root - INFO - train loss:0.1378!
2021-03-01 22:14:06,126 - root - INFO - f1:0.1699, p:0.1958, r:0.2135, hit:0.7699, ndcg:0.5081, topn:10.
2021-03-01 22:14:07,377 - root - INFO - f1:0.1986, p:0.3182, r:0.1905, hit:0.8812, ndcg:0.6245, topn:10.
2021-03-01 22:14:07,381 - root - INFO - Checkpointing ...
2021-03-01 22:14:30,087 - root - INFO - train loss:0.1353!
2021-03-01 22:14:31,250 - root - INFO - f1:0.1721, p:0.1983, r:0.2155, hit:0.7678, ndcg:0.5057, topn:10.
2021-03-01 22:14:32,447 - root - INFO - f1:0.1998, p:0.3201, r:0.1919, hit:0.8834, ndcg:0.6283, topn:10.
2021-03-01 22:14:32,452 - root - INFO - Checkpointing ...
2021-03-01 22:14:53,372 - root - INFO - train loss:0.1336!
2021-03-01 22:14:54,556 - root - INFO - f1:0.1741, p:0.2004, r:0.2191, hit:0.7752, ndcg:0.5092, topn:10.
2021-03-01 22:14:55,731 - root - INFO - f1:0.2013, p:0.3221, r:0.1934, hit:0.8844, ndcg:0.6311, topn:10.
2021-03-01 22:14:55,736 - root - INFO - Checkpointing ...
2021-03-01 22:15:18,360 - root - INFO - train loss:0.1324!
2021-03-01 22:15:19,522 - root - INFO - f1:0.1741, p:0.2006, r:0.2191, hit:0.7762, ndcg:0.5137, topn:10.
2021-03-01 22:15:20,659 - root - INFO - f1:0.2025, p:0.3242, r:0.1941, hit:0.8855, ndcg:0.6334, topn:10.
2021-03-01 22:15:20,664 - root - INFO - Checkpointing ...
2021-03-01 22:15:42,795 - root - INFO - train loss:0.1312!
2021-03-01 22:15:44,005 - root - INFO - f1:0.1741, p:0.2006, r:0.2190, hit:0.7731, ndcg:0.5139, topn:10.
2021-03-01 22:15:45,202 - root - INFO - f1:0.2048, p:0.3276, r:0.1966, hit:0.8897, ndcg:0.6375, topn:10.
2021-03-01 22:15:45,206 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:16:08,399 - root - INFO - train loss:0.1334!
2021-03-01 22:16:09,612 - root - INFO - f1:0.1822, p:0.2093, r:0.2304, hit:0.7911, ndcg:0.5389, topn:10.
2021-03-01 22:16:10,860 - root - INFO - f1:0.2147, p:0.3407, r:0.2058, hit:0.8908, ndcg:0.6645, topn:10.
2021-03-01 22:16:10,863 - root - INFO - Checkpointing ...
2021-03-01 22:16:31,833 - root - INFO - train loss:0.1258!
2021-03-01 22:16:33,011 - root - INFO - f1:0.1835, p:0.2109, r:0.2319, hit:0.7900, ndcg:0.5467, topn:10.
2021-03-01 22:16:34,206 - root - INFO - f1:0.2180, p:0.3459, r:0.2093, hit:0.8940, ndcg:0.6718, topn:10.
2021-03-01 22:16:34,210 - root - INFO - Checkpointing ...
2021-03-01 22:16:56,406 - root - INFO - train loss:0.1226!
2021-03-01 22:16:57,543 - root - INFO - f1:0.1847, p:0.2129, r:0.2329, hit:0.7932, ndcg:0.5508, topn:10.
2021-03-01 22:16:58,801 - root - INFO - f1:0.2212, p:0.3503, r:0.2122, hit:0.9014, ndcg:0.6776, topn:10.
2021-03-01 22:16:58,805 - root - INFO - Checkpointing ...
2021-03-01 22:17:20,063 - root - INFO - train loss:0.1206!
2021-03-01 22:17:21,262 - root - INFO - f1:0.1884, p:0.2164, r:0.2383, hit:0.7975, ndcg:0.5538, topn:10.
2021-03-01 22:17:22,479 - root - INFO - f1:0.2225, p:0.3526, r:0.2135, hit:0.9056, ndcg:0.6812, topn:10.
2021-03-01 22:17:22,484 - root - INFO - Checkpointing ...
2021-03-01 22:17:44,092 - root - INFO - train loss:0.1189!
2021-03-01 22:17:45,306 - root - INFO - f1:0.1900, p:0.2179, r:0.2412, hit:0.7985, ndcg:0.5565, topn:10.
2021-03-01 22:17:46,557 - root - INFO - f1:0.2234, p:0.3538, r:0.2145, hit:0.9067, ndcg:0.6842, topn:10.
2021-03-01 22:17:46,561 - root - INFO - Checkpointing ...
2021-03-01 22:18:08,102 - root - INFO - train loss:0.1178!
2021-03-01 22:18:09,418 - root - INFO - f1:0.1915, p:0.2198, r:0.2426, hit:0.8006, ndcg:0.5583, topn:10.
2021-03-01 22:18:10,661 - root - INFO - f1:0.2250, p:0.3562, r:0.2159, hit:0.9077, ndcg:0.6870, topn:10.
2021-03-01 22:18:10,665 - root - INFO - Checkpointing ...
2021-03-01 22:18:33,122 - root - INFO - train loss:0.1168!
2021-03-01 22:18:34,323 - root - INFO - f1:0.1927, p:0.2212, r:0.2440, hit:0.8049, ndcg:0.5619, topn:10.
2021-03-01 22:18:35,592 - root - INFO - f1:0.2253, p:0.3565, r:0.2165, hit:0.9099, ndcg:0.6902, topn:10.
2021-03-01 22:18:35,596 - root - INFO - Checkpointing ...
2021-03-01 22:18:55,842 - root - INFO - train loss:0.1160!
2021-03-01 22:18:57,079 - root - INFO - f1:0.1921, p:0.2209, r:0.2422, hit:0.7985, ndcg:0.5612, topn:10.
2021-03-01 22:18:58,298 - root - INFO - f1:0.2274, p:0.3595, r:0.2181, hit:0.9099, ndcg:0.6914, topn:10.
2021-03-01 22:18:58,302 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:19:19,644 - root - INFO - train loss:0.1170!
2021-03-01 22:19:20,901 - root - INFO - f1:0.1947, p:0.2231, r:0.2464, hit:0.8070, ndcg:0.5711, topn:10.
2021-03-01 22:19:22,023 - root - INFO - f1:0.2297, p:0.3632, r:0.2204, hit:0.9088, ndcg:0.6935, topn:10.
2021-03-01 22:19:22,027 - root - INFO - Checkpointing ...
2021-03-01 22:19:43,541 - root - INFO - train loss:0.1141!
2021-03-01 22:19:44,779 - root - INFO - f1:0.1964, p:0.2246, r:0.2489, hit:0.8081, ndcg:0.5755, topn:10.
2021-03-01 22:19:45,935 - root - INFO - f1:0.2312, p:0.3651, r:0.2219, hit:0.9120, ndcg:0.6958, topn:10.
2021-03-01 22:19:45,939 - root - INFO - Checkpointing ...
2021-03-01 22:20:08,917 - root - INFO - train loss:0.1131!
2021-03-01 22:20:10,107 - root - INFO - f1:0.1966, p:0.2251, r:0.2483, hit:0.8070, ndcg:0.5733, topn:10.
2021-03-01 22:20:11,330 - root - INFO - f1:0.2312, p:0.3655, r:0.2216, hit:0.9120, ndcg:0.6980, topn:10.
2021-03-01 22:20:11,334 - root - INFO - Checkpointing ...
2021-03-01 22:20:31,496 - root - INFO - train loss:0.1119!
2021-03-01 22:20:32,716 - root - INFO - f1:0.1970, p:0.2256, r:0.2488, hit:0.8059, ndcg:0.5770, topn:10.
2021-03-01 22:20:33,874 - root - INFO - f1:0.2314, p:0.3662, r:0.2221, hit:0.9130, ndcg:0.6984, topn:10.
2021-03-01 22:20:33,878 - root - INFO - Checkpointing ...
2021-03-01 22:20:57,454 - root - INFO - train loss:0.1110!
2021-03-01 22:20:58,718 - root - INFO - f1:0.1975, p:0.2263, r:0.2492, hit:0.8081, ndcg:0.5790, topn:10.
2021-03-01 22:20:59,930 - root - INFO - f1:0.2322, p:0.3668, r:0.2232, hit:0.9141, ndcg:0.6997, topn:10.
2021-03-01 22:20:59,933 - root - INFO - Checkpointing ...
2021-03-01 22:21:21,580 - root - INFO - train loss:0.1104!
2021-03-01 22:21:22,811 - root - INFO - f1:0.1975, p:0.2261, r:0.2501, hit:0.8123, ndcg:0.5809, topn:10.
2021-03-01 22:21:23,988 - root - INFO - f1:0.2330, p:0.3685, r:0.2237, hit:0.9120, ndcg:0.7010, topn:10.
2021-03-01 22:21:23,992 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:21:45,755 - root - INFO - train loss:0.1118!
2021-03-01 22:21:46,979 - root - INFO - f1:0.1979, p:0.2266, r:0.2505, hit:0.8112, ndcg:0.5780, topn:10.
2021-03-01 22:21:48,160 - root - INFO - f1:0.2330, p:0.3691, r:0.2233, hit:0.9141, ndcg:0.7030, topn:10.
2021-03-01 22:21:48,163 - root - INFO - Checkpointing ...
2021-03-01 22:22:10,010 - root - INFO - train loss:0.1102!
2021-03-01 22:22:11,292 - root - INFO - f1:0.1982, p:0.2265, r:0.2516, hit:0.8123, ndcg:0.5784, topn:10.
2021-03-01 22:22:12,503 - root - INFO - f1:0.2333, p:0.3697, r:0.2235, hit:0.9130, ndcg:0.7029, topn:10.
2021-03-01 22:22:12,507 - root - INFO - Checkpointing ...
2021-03-01 22:22:33,363 - root - INFO - train loss:0.1092!
2021-03-01 22:22:34,595 - root - INFO - f1:0.1993, p:0.2276, r:0.2533, hit:0.8134, ndcg:0.5803, topn:10.
2021-03-01 22:22:35,770 - root - INFO - f1:0.2333, p:0.3699, r:0.2233, hit:0.9141, ndcg:0.7056, topn:10.
2021-03-01 22:22:35,773 - root - INFO - Checkpointing ...
2021-03-01 22:22:58,753 - root - INFO - train loss:0.1089!
2021-03-01 22:22:59,992 - root - INFO - f1:0.1997, p:0.2282, r:0.2534, hit:0.8134, ndcg:0.5809, topn:10.
2021-03-01 22:23:01,135 - root - INFO - f1:0.2347, p:0.3712, r:0.2250, hit:0.9152, ndcg:0.7067, topn:10.
2021-03-01 22:23:01,139 - root - INFO - Checkpointing ...
2021-03-01 22:23:23,580 - root - INFO - train loss:0.1083!
2021-03-01 22:23:24,832 - root - INFO - f1:0.2003, p:0.2288, r:0.2540, hit:0.8134, ndcg:0.5797, topn:10.
2021-03-01 22:23:26,230 - root - INFO - f1:0.2350, p:0.3719, r:0.2252, hit:0.9141, ndcg:0.7062, topn:10.
2021-03-01 22:23:26,234 - root - INFO - Checkpointing ...
2021-03-01 22:23:47,696 - root - INFO - train loss:0.1081!
2021-03-01 22:23:48,907 - root - INFO - f1:0.2007, p:0.2293, r:0.2546, hit:0.8144, ndcg:0.5796, topn:10.
2021-03-01 22:23:50,098 - root - INFO - f1:0.2355, p:0.3724, r:0.2256, hit:0.9141, ndcg:0.7050, topn:10.
2021-03-01 22:23:50,102 - root - INFO - Checkpointing ...
2021-03-01 22:24:12,056 - root - INFO - train loss:0.1082!
2021-03-01 22:24:13,259 - root - INFO - f1:0.2013, p:0.2299, r:0.2556, hit:0.8165, ndcg:0.5808, topn:10.
2021-03-01 22:24:14,512 - root - INFO - f1:0.2356, p:0.3730, r:0.2257, hit:0.9130, ndcg:0.7047, topn:10.
2021-03-01 22:24:14,515 - root - INFO - Checkpointing ...
2021-03-01 22:24:35,308 - root - INFO - train loss:0.1083!
2021-03-01 22:24:36,467 - root - INFO - f1:0.2013, p:0.2299, r:0.2556, hit:0.8165, ndcg:0.5811, topn:10.
2021-03-01 22:24:37,667 - root - INFO - f1:0.2358, p:0.3733, r:0.2259, hit:0.9130, ndcg:0.7053, topn:10.
2021-03-01 22:24:37,671 - root - INFO - Checkpointing ...
2021-03-01 22:24:59,842 - root - INFO - train loss:0.1077!
2021-03-01 22:25:01,075 - root - INFO - f1:0.2013, p:0.2300, r:0.2553, hit:0.8155, ndcg:0.5809, topn:10.
2021-03-01 22:25:02,238 - root - INFO - f1:0.2363, p:0.3738, r:0.2265, hit:0.9141, ndcg:0.7063, topn:10.
2021-03-01 22:25:02,242 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:25:24,105 - root - INFO - train loss:0.1082!
2021-03-01 22:25:25,319 - root - INFO - f1:0.2001, p:0.2292, r:0.2534, hit:0.8123, ndcg:0.5819, topn:10.
2021-03-01 22:25:26,532 - root - INFO - f1:0.2354, p:0.3732, r:0.2253, hit:0.9130, ndcg:0.7067, topn:10.
2021-03-01 22:25:26,534 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:25:47,134 - root - INFO - train loss:0.1083!
2021-03-01 22:25:48,373 - root - INFO - f1:0.2005, p:0.2297, r:0.2534, hit:0.8102, ndcg:0.5798, topn:10.
2021-03-01 22:25:49,543 - root - INFO - f1:0.2358, p:0.3739, r:0.2256, hit:0.9141, ndcg:0.7083, topn:10.
2021-03-01 22:25:49,548 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:26:12,124 - root - INFO - train loss:0.1075!
2021-03-01 22:26:13,313 - root - INFO - f1:0.2002, p:0.2294, r:0.2529, hit:0.8112, ndcg:0.5821, topn:10.
2021-03-01 22:26:14,525 - root - INFO - f1:0.2357, p:0.3739, r:0.2254, hit:0.9152, ndcg:0.7094, topn:10.
2021-03-01 22:26:14,530 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:26:35,908 - root - INFO - train loss:0.1077!
2021-03-01 22:26:37,145 - root - INFO - f1:0.2002, p:0.2293, r:0.2530, hit:0.8112, ndcg:0.5815, topn:10.
2021-03-01 22:26:38,333 - root - INFO - f1:0.2356, p:0.3740, r:0.2253, hit:0.9141, ndcg:0.7096, topn:10.
2021-03-01 22:26:38,335 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:26:38,375 - root - INFO - No improvement after 13317 steps. Stopping training.
2021-03-01 22:26:39,888 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.229268, 'RECALL@10': 0.253032, 'NDCG@10': 0.581888, 'MAP@10': 0.475174, 'MAP': 0.475174}.
2021-03-01 22:26:40,082 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.469512, 'GENRE_REDUNDANCY@10': 0.428218, 'ILD_GENRE@10': 0.808685}.
2021-03-01 22:26:41,774 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.374231, 'RECALL@10': 0.225543, 'NDCG@10': 0.709397, 'MAP@10': 0.606943, 'MAP': 0.606943}.
2021-03-01 22:26:41,969 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.466331, 'GENRE_REDUNDANCY@10': 0.422504, 'ILD_GENRE@10': 0.806607}.
