2021-03-01 21:52:07,800 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_oKG/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_oKG/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614646327",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_oKG/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_oKG/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-01 21:52:07,862 - root - INFO - Totally 8618 train triples, 783,1631 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_oKG/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_oKG/cao-format/ml1m/kg/test.dat!
2021-03-01 21:52:07,869 - root - INFO - successfully load 5606 entities and 3 relations!
2021-03-01 21:52:07,882 - root - INFO - Building model.
2021-03-01 21:52:09,182 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(5606, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-01 21:52:09,183 - root - INFO - Total params: 561200.0
2021-03-01 21:52:09,190 - root - INFO - One epoch is 34 steps.
2021-03-01 21:52:09,191 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-01 21:52:09,200 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_oKG/ml1m-transe-pretrained.ckpt.
2021-03-01 21:52:09,201 - root - INFO - Training.
2021-03-01 21:52:09,201 - root - INFO - train loss:0.0000!
2021-03-01 21:52:10,910 - root - INFO - head hit:0.1443, head mean rank:840.4789, topn:10.
2021-03-01 21:52:10,910 - root - INFO - tail hit:0.3780, tail mean rank:646.8659, topn:10.
2021-03-01 21:52:10,910 - root - INFO - avg hit:0.2612, avg mean rank:743.6724, topn:10.
2021-03-01 21:52:13,957 - root - INFO - head hit:0.1226, head mean rank:893.4788, topn:10.
2021-03-01 21:52:13,958 - root - INFO - tail hit:0.3403, tail mean rank:589.8099, topn:10.
2021-03-01 21:52:13,958 - root - INFO - avg hit:0.2315, avg mean rank:741.6444, topn:10.
2021-03-01 21:52:47,171 - root - INFO - train loss:0.0628!
2021-03-01 21:52:48,984 - root - INFO - head hit:0.0856, head mean rank:846.7510, topn:10.
2021-03-01 21:52:48,984 - root - INFO - tail hit:0.3116, tail mean rank:661.0677, topn:10.
2021-03-01 21:52:48,984 - root - INFO - avg hit:0.1986, avg mean rank:753.9093, topn:10.
2021-03-01 21:52:52,249 - root - INFO - head hit:0.0717, head mean rank:870.1183, topn:10.
2021-03-01 21:52:52,249 - root - INFO - tail hit:0.3023, tail mean rank:608.5910, topn:10.
2021-03-01 21:52:52,250 - root - INFO - avg hit:0.1870, avg mean rank:739.3547, topn:10.
2021-03-01 21:52:52,251 - root - INFO - Checkpointing ...
2021-03-01 21:53:23,958 - root - INFO - train loss:0.1400!
2021-03-01 21:53:25,709 - root - INFO - head hit:0.0805, head mean rank:867.8646, topn:10.
2021-03-01 21:53:25,709 - root - INFO - tail hit:0.2465, tail mean rank:678.8391, topn:10.
2021-03-01 21:53:25,709 - root - INFO - avg hit:0.1635, avg mean rank:773.3519, topn:10.
2021-03-01 21:53:28,852 - root - INFO - head hit:0.0754, head mean rank:905.2600, topn:10.
2021-03-01 21:53:28,852 - root - INFO - tail hit:0.2354, tail mean rank:652.9994, topn:10.
2021-03-01 21:53:28,852 - root - INFO - avg hit:0.1554, avg mean rank:779.1297, topn:10.
2021-03-01 21:53:28,853 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 21:54:00,032 - root - INFO - train loss:0.0626!
2021-03-01 21:54:01,736 - root - INFO - head hit:0.1149, head mean rank:822.7765, topn:10.
2021-03-01 21:54:01,737 - root - INFO - tail hit:0.3078, tail mean rank:650.9527, topn:10.
2021-03-01 21:54:01,737 - root - INFO - avg hit:0.2114, avg mean rank:736.8646, topn:10.
2021-03-01 21:54:04,978 - root - INFO - head hit:0.1110, head mean rank:856.3329, topn:10.
2021-03-01 21:54:04,978 - root - INFO - tail hit:0.2900, tail mean rank:609.0540, topn:10.
2021-03-01 21:54:04,978 - root - INFO - avg hit:0.2005, avg mean rank:732.6934, topn:10.
2021-03-01 21:54:04,980 - root - INFO - Checkpointing ...
2021-03-01 21:54:36,760 - root - INFO - train loss:0.0334!
2021-03-01 21:54:38,542 - root - INFO - head hit:0.1188, head mean rank:818.0460, topn:10.
2021-03-01 21:54:38,543 - root - INFO - tail hit:0.2963, tail mean rank:627.9745, topn:10.
2021-03-01 21:54:38,543 - root - INFO - avg hit:0.2075, avg mean rank:723.0102, topn:10.
2021-03-01 21:54:41,737 - root - INFO - head hit:0.0993, head mean rank:879.4163, topn:10.
2021-03-01 21:54:41,737 - root - INFO - tail hit:0.2925, tail mean rank:591.9135, topn:10.
2021-03-01 21:54:41,738 - root - INFO - avg hit:0.1959, avg mean rank:735.6649, topn:10.
2021-03-01 21:54:41,739 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 21:55:14,674 - root - INFO - train loss:0.0176!
2021-03-01 21:55:16,382 - root - INFO - head hit:0.1290, head mean rank:800.2912, topn:10.
2021-03-01 21:55:16,382 - root - INFO - tail hit:0.3308, tail mean rank:611.2937, topn:10.
2021-03-01 21:55:16,382 - root - INFO - avg hit:0.2299, avg mean rank:705.7925, topn:10.
2021-03-01 21:55:19,631 - root - INFO - head hit:0.1171, head mean rank:849.9951, topn:10.
2021-03-01 21:55:19,632 - root - INFO - tail hit:0.3188, tail mean rank:566.5579, topn:10.
2021-03-01 21:55:19,632 - root - INFO - avg hit:0.2180, avg mean rank:708.2765, topn:10.
2021-03-01 21:55:19,633 - root - INFO - Checkpointing ...
2021-03-01 21:55:51,526 - root - INFO - train loss:0.0120!
2021-03-01 21:55:53,243 - root - INFO - head hit:0.1430, head mean rank:781.4393, topn:10.
2021-03-01 21:55:53,244 - root - INFO - tail hit:0.3295, tail mean rank:602.1826, topn:10.
2021-03-01 21:55:53,244 - root - INFO - avg hit:0.2363, avg mean rank:691.8110, topn:10.
2021-03-01 21:55:56,456 - root - INFO - head hit:0.1300, head mean rank:845.6021, topn:10.
2021-03-01 21:55:56,456 - root - INFO - tail hit:0.3243, tail mean rank:565.6579, topn:10.
2021-03-01 21:55:56,456 - root - INFO - avg hit:0.2272, avg mean rank:705.6300, topn:10.
2021-03-01 21:55:56,458 - root - INFO - Checkpointing ...
2021-03-01 21:56:28,965 - root - INFO - train loss:0.0088!
2021-03-01 21:56:30,718 - root - INFO - head hit:0.1379, head mean rank:794.7267, topn:10.
2021-03-01 21:56:30,718 - root - INFO - tail hit:0.3499, tail mean rank:606.4879, topn:10.
2021-03-01 21:56:30,718 - root - INFO - avg hit:0.2439, avg mean rank:700.6073, topn:10.
2021-03-01 21:56:33,897 - root - INFO - head hit:0.1306, head mean rank:848.9540, topn:10.
2021-03-01 21:56:33,898 - root - INFO - tail hit:0.3440, tail mean rank:555.6634, topn:10.
2021-03-01 21:56:33,898 - root - INFO - avg hit:0.2373, avg mean rank:702.3087, topn:10.
2021-03-01 21:56:33,899 - root - INFO - Checkpointing ...
2021-03-01 21:57:04,517 - root - INFO - train loss:0.0055!
2021-03-01 21:57:06,314 - root - INFO - head hit:0.1456, head mean rank:776.7752, topn:10.
2021-03-01 21:57:06,314 - root - INFO - tail hit:0.3576, tail mean rank:612.1149, topn:10.
2021-03-01 21:57:06,315 - root - INFO - avg hit:0.2516, avg mean rank:694.4451, topn:10.
2021-03-01 21:57:09,513 - root - INFO - head hit:0.1343, head mean rank:836.9086, topn:10.
2021-03-01 21:57:09,513 - root - INFO - tail hit:0.3403, tail mean rank:561.2587, topn:10.
2021-03-01 21:57:09,513 - root - INFO - avg hit:0.2373, avg mean rank:699.0837, topn:10.
2021-03-01 21:57:09,515 - root - INFO - Checkpointing ...
2021-03-01 21:57:39,851 - root - INFO - train loss:0.0059!
2021-03-01 21:57:41,517 - root - INFO - head hit:0.1405, head mean rank:753.1699, topn:10.
2021-03-01 21:57:41,517 - root - INFO - tail hit:0.3780, tail mean rank:612.7791, topn:10.
2021-03-01 21:57:41,517 - root - INFO - avg hit:0.2593, avg mean rank:682.9745, topn:10.
2021-03-01 21:57:44,708 - root - INFO - head hit:0.1257, head mean rank:813.6487, topn:10.
2021-03-01 21:57:44,709 - root - INFO - tail hit:0.3538, tail mean rank:554.1422, topn:10.
2021-03-01 21:57:44,709 - root - INFO - avg hit:0.2397, avg mean rank:683.8955, topn:10.
2021-03-01 21:57:44,710 - root - INFO - Checkpointing ...
2021-03-01 21:58:15,353 - root - INFO - train loss:0.0044!
2021-03-01 21:58:17,114 - root - INFO - head hit:0.1430, head mean rank:762.8416, topn:10.
2021-03-01 21:58:17,114 - root - INFO - tail hit:0.3716, tail mean rank:605.7420, topn:10.
2021-03-01 21:58:17,114 - root - INFO - avg hit:0.2573, avg mean rank:684.2918, topn:10.
2021-03-01 21:58:20,264 - root - INFO - head hit:0.1294, head mean rank:827.5849, topn:10.
2021-03-01 21:58:20,265 - root - INFO - tail hit:0.3691, tail mean rank:546.8706, topn:10.
2021-03-01 21:58:20,265 - root - INFO - avg hit:0.2492, avg mean rank:687.2278, topn:10.
2021-03-01 21:58:20,266 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 21:58:50,720 - root - INFO - train loss:0.0039!
2021-03-01 21:58:52,431 - root - INFO - head hit:0.1507, head mean rank:766.4151, topn:10.
2021-03-01 21:58:52,432 - root - INFO - tail hit:0.3793, tail mean rank:608.4662, topn:10.
2021-03-01 21:58:52,432 - root - INFO - avg hit:0.2650, avg mean rank:687.4406, topn:10.
2021-03-01 21:58:55,597 - root - INFO - head hit:0.1380, head mean rank:830.2716, topn:10.
2021-03-01 21:58:55,597 - root - INFO - tail hit:0.3630, tail mean rank:551.8700, topn:10.
2021-03-01 21:58:55,597 - root - INFO - avg hit:0.2505, avg mean rank:691.0708, topn:10.
2021-03-01 21:58:55,599 - root - INFO - Checkpointing ...
2021-03-01 21:59:25,844 - root - INFO - train loss:0.0029!
2021-03-01 21:59:27,567 - root - INFO - head hit:0.1545, head mean rank:776.4330, topn:10.
2021-03-01 21:59:27,567 - root - INFO - tail hit:0.3691, tail mean rank:608.5134, topn:10.
2021-03-01 21:59:27,568 - root - INFO - avg hit:0.2618, avg mean rank:692.4732, topn:10.
2021-03-01 21:59:30,799 - root - INFO - head hit:0.1386, head mean rank:832.7002, topn:10.
2021-03-01 21:59:30,799 - root - INFO - tail hit:0.3581, tail mean rank:552.3023, topn:10.
2021-03-01 21:59:30,799 - root - INFO - avg hit:0.2483, avg mean rank:692.5012, topn:10.
2021-03-01 21:59:30,801 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:00:01,225 - root - INFO - train loss:0.0030!
2021-03-01 22:00:02,985 - root - INFO - head hit:0.1584, head mean rank:777.1379, topn:10.
2021-03-01 22:00:02,985 - root - INFO - tail hit:0.3691, tail mean rank:608.2222, topn:10.
2021-03-01 22:00:02,985 - root - INFO - avg hit:0.2637, avg mean rank:692.6801, topn:10.
2021-03-01 22:00:06,148 - root - INFO - head hit:0.1416, head mean rank:832.9681, topn:10.
2021-03-01 22:00:06,149 - root - INFO - tail hit:0.3666, tail mean rank:552.3906, topn:10.
2021-03-01 22:00:06,149 - root - INFO - avg hit:0.2541, avg mean rank:692.6793, topn:10.
2021-03-01 22:00:06,150 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:00:36,936 - root - INFO - train loss:0.0023!
2021-03-01 22:00:38,715 - root - INFO - head hit:0.1545, head mean rank:775.5057, topn:10.
2021-03-01 22:00:38,716 - root - INFO - tail hit:0.3742, tail mean rank:606.0817, topn:10.
2021-03-01 22:00:38,716 - root - INFO - avg hit:0.2644, avg mean rank:690.7937, topn:10.
2021-03-01 22:00:41,824 - root - INFO - head hit:0.1422, head mean rank:830.1337, topn:10.
2021-03-01 22:00:41,825 - root - INFO - tail hit:0.3679, tail mean rank:550.8945, topn:10.
2021-03-01 22:00:41,825 - root - INFO - avg hit:0.2551, avg mean rank:690.5141, topn:10.
2021-03-01 22:00:41,826 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:01:12,019 - root - INFO - train loss:0.0018!
2021-03-01 22:01:13,693 - root - INFO - head hit:0.1558, head mean rank:775.2337, topn:10.
2021-03-01 22:01:13,693 - root - INFO - tail hit:0.3780, tail mean rank:605.7905, topn:10.
2021-03-01 22:01:13,693 - root - INFO - avg hit:0.2669, avg mean rank:690.5121, topn:10.
2021-03-01 22:01:16,879 - root - INFO - head hit:0.1429, head mean rank:829.9834, topn:10.
2021-03-01 22:01:16,879 - root - INFO - tail hit:0.3685, tail mean rank:550.1803, topn:10.
2021-03-01 22:01:16,879 - root - INFO - avg hit:0.2557, avg mean rank:690.0819, topn:10.
2021-03-01 22:01:16,880 - root - INFO - Checkpointing ...
2021-03-01 22:01:47,387 - root - INFO - train loss:0.0019!
2021-03-01 22:01:49,133 - root - INFO - head hit:0.1558, head mean rank:775.2465, topn:10.
2021-03-01 22:01:49,133 - root - INFO - tail hit:0.3755, tail mean rank:605.7739, topn:10.
2021-03-01 22:01:49,134 - root - INFO - avg hit:0.2656, avg mean rank:690.5102, topn:10.
2021-03-01 22:01:52,652 - root - INFO - head hit:0.1429, head mean rank:830.3305, topn:10.
2021-03-01 22:01:52,652 - root - INFO - tail hit:0.3691, tail mean rank:550.1772, topn:10.
2021-03-01 22:01:52,652 - root - INFO - avg hit:0.2560, avg mean rank:690.2538, topn:10.
2021-03-01 22:01:52,653 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:02:23,588 - root - INFO - train loss:0.0014!
2021-03-01 22:02:25,327 - root - INFO - head hit:0.1558, head mean rank:775.1086, topn:10.
2021-03-01 22:02:25,328 - root - INFO - tail hit:0.3755, tail mean rank:605.0626, topn:10.
2021-03-01 22:02:25,328 - root - INFO - avg hit:0.2656, avg mean rank:690.0856, topn:10.
2021-03-01 22:02:28,543 - root - INFO - head hit:0.1435, head mean rank:830.0914, topn:10.
2021-03-01 22:02:28,543 - root - INFO - tail hit:0.3691, tail mean rank:549.7486, topn:10.
2021-03-01 22:02:28,543 - root - INFO - avg hit:0.2563, avg mean rank:689.9200, topn:10.
2021-03-01 22:02:28,544 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:02:58,695 - root - INFO - train loss:0.0020!
2021-03-01 22:03:00,398 - root - INFO - head hit:0.1558, head mean rank:775.2337, topn:10.
2021-03-01 22:03:00,398 - root - INFO - tail hit:0.3768, tail mean rank:605.0728, topn:10.
2021-03-01 22:03:00,398 - root - INFO - avg hit:0.2663, avg mean rank:690.1533, topn:10.
2021-03-01 22:03:03,599 - root - INFO - head hit:0.1441, head mean rank:830.0926, topn:10.
2021-03-01 22:03:03,599 - root - INFO - tail hit:0.3691, tail mean rank:549.6548, topn:10.
2021-03-01 22:03:03,599 - root - INFO - avg hit:0.2566, avg mean rank:689.8737, topn:10.
2021-03-01 22:03:03,601 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:03:34,321 - root - INFO - train loss:0.0013!
2021-03-01 22:03:36,116 - root - INFO - head hit:0.1558, head mean rank:775.0690, topn:10.
2021-03-01 22:03:36,116 - root - INFO - tail hit:0.3768, tail mean rank:605.0434, topn:10.
2021-03-01 22:03:36,117 - root - INFO - avg hit:0.2663, avg mean rank:690.0562, topn:10.
2021-03-01 22:03:39,351 - root - INFO - head hit:0.1447, head mean rank:829.8866, topn:10.
2021-03-01 22:03:39,352 - root - INFO - tail hit:0.3691, tail mean rank:549.5113, topn:10.
2021-03-01 22:03:39,352 - root - INFO - avg hit:0.2569, avg mean rank:689.6990, topn:10.
2021-03-01 22:03:39,353 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-01 22:04:09,470 - root - INFO - No improvement after 24363 steps. Stopping training.
