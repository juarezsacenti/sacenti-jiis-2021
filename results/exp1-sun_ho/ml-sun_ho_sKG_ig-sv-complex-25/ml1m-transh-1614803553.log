2021-03-03 17:32:33,410 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-25/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-25/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614803553",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-25/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-25/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-03 17:32:33,462 - root - INFO - Totally 6611 train triples, 885,1769 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-25/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-25/cao-format/ml1m/kg/test.dat!
2021-03-03 17:32:33,465 - root - INFO - successfully load 2833 entities and 3 relations!
2021-03-03 17:32:33,476 - root - INFO - Building model.
2021-03-03 17:32:34,761 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(2833, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-03 17:32:34,762 - root - INFO - Total params: 283900.0
2021-03-03 17:32:34,762 - root - INFO - One epoch is 26 steps.
2021-03-03 17:32:34,762 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-03 17:32:34,765 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-25/ml1m-transe-pretrained.ckpt.
2021-03-03 17:32:34,766 - root - INFO - Training.
2021-03-03 17:32:34,766 - root - INFO - train loss:0.0000!
2021-03-03 17:32:36,346 - root - INFO - head hit:0.1548, head mean rank:601.2565, topn:10.
2021-03-03 17:32:36,346 - root - INFO - tail hit:0.4463, tail mean rank:185.4452, topn:10.
2021-03-03 17:32:36,346 - root - INFO - avg hit:0.3006, avg mean rank:393.3508, topn:10.
2021-03-03 17:32:38,872 - root - INFO - head hit:0.1724, head mean rank:588.9960, topn:10.
2021-03-03 17:32:38,872 - root - INFO - tail hit:0.4432, tail mean rank:197.3674, topn:10.
2021-03-03 17:32:38,872 - root - INFO - avg hit:0.3078, avg mean rank:393.1817, topn:10.
2021-03-03 17:33:13,108 - root - INFO - train loss:0.0603!
2021-03-03 17:33:14,731 - root - INFO - head hit:0.1107, head mean rank:609.1751, topn:10.
2021-03-03 17:33:14,731 - root - INFO - tail hit:0.3559, tail mean rank:206.9424, topn:10.
2021-03-03 17:33:14,731 - root - INFO - avg hit:0.2333, avg mean rank:408.0588, topn:10.
2021-03-03 17:33:17,160 - root - INFO - head hit:0.1238, head mean rank:613.1984, topn:10.
2021-03-03 17:33:17,160 - root - INFO - tail hit:0.3697, tail mean rank:214.1758, topn:10.
2021-03-03 17:33:17,160 - root - INFO - avg hit:0.2467, avg mean rank:413.6871, topn:10.
2021-03-03 17:33:17,161 - root - INFO - Checkpointing ...
2021-03-03 17:33:50,802 - root - INFO - train loss:0.1370!
2021-03-03 17:33:52,277 - root - INFO - head hit:0.1096, head mean rank:614.6768, topn:10.
2021-03-03 17:33:52,277 - root - INFO - tail hit:0.3605, tail mean rank:207.3684, topn:10.
2021-03-03 17:33:52,278 - root - INFO - avg hit:0.2350, avg mean rank:411.0226, topn:10.
2021-03-03 17:33:54,687 - root - INFO - head hit:0.1283, head mean rank:605.8666, topn:10.
2021-03-03 17:33:54,687 - root - INFO - tail hit:0.3471, tail mean rank:221.8700, topn:10.
2021-03-03 17:33:54,687 - root - INFO - avg hit:0.2377, avg mean rank:413.8683, topn:10.
2021-03-03 17:33:54,689 - root - INFO - Checkpointing ...
2021-03-03 17:34:27,338 - root - INFO - train loss:0.1545!
2021-03-03 17:34:28,868 - root - INFO - head hit:0.1186, head mean rank:622.8655, topn:10.
2021-03-03 17:34:28,868 - root - INFO - tail hit:0.3684, tail mean rank:214.6531, topn:10.
2021-03-03 17:34:28,868 - root - INFO - avg hit:0.2435, avg mean rank:418.7593, topn:10.
2021-03-03 17:34:31,481 - root - INFO - head hit:0.1306, head mean rank:604.2866, topn:10.
2021-03-03 17:34:31,481 - root - INFO - tail hit:0.3725, tail mean rank:214.9214, topn:10.
2021-03-03 17:34:31,481 - root - INFO - avg hit:0.2516, avg mean rank:409.6040, topn:10.
2021-03-03 17:34:31,483 - root - INFO - Checkpointing ...
2021-03-03 17:35:04,700 - root - INFO - train loss:0.1453!
2021-03-03 17:35:06,319 - root - INFO - head hit:0.1367, head mean rank:619.0181, topn:10.
2021-03-03 17:35:06,319 - root - INFO - tail hit:0.3311, tail mean rank:212.8836, topn:10.
2021-03-03 17:35:06,319 - root - INFO - avg hit:0.2339, avg mean rank:415.9508, topn:10.
2021-03-03 17:35:08,828 - root - INFO - head hit:0.1306, head mean rank:593.3154, topn:10.
2021-03-03 17:35:08,829 - root - INFO - tail hit:0.3397, tail mean rank:220.0328, topn:10.
2021-03-03 17:35:08,829 - root - INFO - avg hit:0.2352, avg mean rank:406.6741, topn:10.
2021-03-03 17:35:08,830 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-03 17:35:41,716 - root - INFO - train loss:0.0447!
2021-03-03 17:35:43,207 - root - INFO - head hit:0.1401, head mean rank:600.1627, topn:10.
2021-03-03 17:35:43,208 - root - INFO - tail hit:0.3966, tail mean rank:201.0023, topn:10.
2021-03-03 17:35:43,208 - root - INFO - avg hit:0.2684, avg mean rank:400.5825, topn:10.
2021-03-03 17:35:45,801 - root - INFO - head hit:0.1526, head mean rank:585.0102, topn:10.
2021-03-03 17:35:45,801 - root - INFO - tail hit:0.4002, tail mean rank:208.7258, topn:10.
2021-03-03 17:35:45,801 - root - INFO - avg hit:0.2764, avg mean rank:396.8680, topn:10.
2021-03-03 17:35:45,802 - root - INFO - Checkpointing ...
2021-03-03 17:36:18,028 - root - INFO - train loss:0.0267!
2021-03-03 17:36:19,564 - root - INFO - head hit:0.1605, head mean rank:594.8260, topn:10.
2021-03-03 17:36:19,564 - root - INFO - tail hit:0.4136, tail mean rank:198.0927, topn:10.
2021-03-03 17:36:19,565 - root - INFO - avg hit:0.2870, avg mean rank:396.4593, topn:10.
2021-03-03 17:36:22,094 - root - INFO - head hit:0.1735, head mean rank:571.1323, topn:10.
2021-03-03 17:36:22,094 - root - INFO - tail hit:0.4059, tail mean rank:204.3940, topn:10.
2021-03-03 17:36:22,094 - root - INFO - avg hit:0.2897, avg mean rank:387.7631, topn:10.
2021-03-03 17:36:22,095 - root - INFO - Checkpointing ...
2021-03-03 17:36:53,620 - root - INFO - train loss:0.0177!
2021-03-03 17:36:55,120 - root - INFO - head hit:0.1559, head mean rank:584.7616, topn:10.
2021-03-03 17:36:55,120 - root - INFO - tail hit:0.4158, tail mean rank:195.8328, topn:10.
2021-03-03 17:36:55,120 - root - INFO - avg hit:0.2859, avg mean rank:390.2972, topn:10.
2021-03-03 17:36:57,604 - root - INFO - head hit:0.1741, head mean rank:557.1148, topn:10.
2021-03-03 17:36:57,604 - root - INFO - tail hit:0.4031, tail mean rank:197.7677, topn:10.
2021-03-03 17:36:57,604 - root - INFO - avg hit:0.2886, avg mean rank:377.4412, topn:10.
2021-03-03 17:36:57,605 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-03 17:37:28,458 - root - INFO - train loss:0.0075!
2021-03-03 17:37:29,951 - root - INFO - head hit:0.1718, head mean rank:588.0791, topn:10.
2021-03-03 17:37:29,951 - root - INFO - tail hit:0.4282, tail mean rank:194.8418, topn:10.
2021-03-03 17:37:29,951 - root - INFO - avg hit:0.3000, avg mean rank:391.4605, topn:10.
2021-03-03 17:37:32,596 - root - INFO - head hit:0.1899, head mean rank:558.8485, topn:10.
2021-03-03 17:37:32,597 - root - INFO - tail hit:0.4200, tail mean rank:195.0367, topn:10.
2021-03-03 17:37:32,597 - root - INFO - avg hit:0.3050, avg mean rank:376.9426, topn:10.
2021-03-03 17:37:32,599 - root - INFO - Checkpointing ...
2021-03-03 17:38:06,003 - root - INFO - train loss:0.0058!
2021-03-03 17:38:07,395 - root - INFO - head hit:0.1751, head mean rank:582.0124, topn:10.
2021-03-03 17:38:07,396 - root - INFO - tail hit:0.4407, tail mean rank:188.1944, topn:10.
2021-03-03 17:38:07,396 - root - INFO - avg hit:0.3079, avg mean rank:385.1034, topn:10.
2021-03-03 17:38:10,053 - root - INFO - head hit:0.1916, head mean rank:556.3103, topn:10.
2021-03-03 17:38:10,053 - root - INFO - tail hit:0.4240, tail mean rank:193.2352, topn:10.
2021-03-03 17:38:10,053 - root - INFO - avg hit:0.3078, avg mean rank:374.7728, topn:10.
2021-03-03 17:38:10,055 - root - INFO - Checkpointing ...
2021-03-03 17:38:40,596 - root - INFO - train loss:0.0037!
2021-03-03 17:38:42,235 - root - INFO - head hit:0.1774, head mean rank:580.9186, topn:10.
2021-03-03 17:38:42,235 - root - INFO - tail hit:0.4452, tail mean rank:189.6090, topn:10.
2021-03-03 17:38:42,235 - root - INFO - avg hit:0.3113, avg mean rank:385.2638, topn:10.
2021-03-03 17:38:44,695 - root - INFO - head hit:0.2046, head mean rank:556.5789, topn:10.
2021-03-03 17:38:44,696 - root - INFO - tail hit:0.4336, tail mean rank:194.7959, topn:10.
2021-03-03 17:38:44,696 - root - INFO - avg hit:0.3191, avg mean rank:375.6874, topn:10.
2021-03-03 17:38:44,697 - root - INFO - Checkpointing ...
2021-03-03 17:39:15,227 - root - INFO - train loss:0.0032!
2021-03-03 17:39:16,815 - root - INFO - head hit:0.1740, head mean rank:579.9910, topn:10.
2021-03-03 17:39:16,815 - root - INFO - tail hit:0.4395, tail mean rank:192.0723, topn:10.
2021-03-03 17:39:16,815 - root - INFO - avg hit:0.3068, avg mean rank:386.0316, topn:10.
2021-03-03 17:39:19,340 - root - INFO - head hit:0.1962, head mean rank:552.1283, topn:10.
2021-03-03 17:39:19,341 - root - INFO - tail hit:0.4330, tail mean rank:194.1085, topn:10.
2021-03-03 17:39:19,341 - root - INFO - avg hit:0.3146, avg mean rank:373.1184, topn:10.
2021-03-03 17:39:19,343 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-03 17:39:50,652 - root - INFO - train loss:0.0019!
2021-03-03 17:39:52,279 - root - INFO - head hit:0.1842, head mean rank:580.8689, topn:10.
2021-03-03 17:39:52,284 - root - INFO - tail hit:0.4373, tail mean rank:192.1706, topn:10.
2021-03-03 17:39:52,284 - root - INFO - avg hit:0.3107, avg mean rank:386.5198, topn:10.
2021-03-03 17:39:54,869 - root - INFO - head hit:0.2012, head mean rank:553.7258, topn:10.
2021-03-03 17:39:54,870 - root - INFO - tail hit:0.4398, tail mean rank:193.5110, topn:10.
2021-03-03 17:39:54,870 - root - INFO - avg hit:0.3205, avg mean rank:373.6184, topn:10.
2021-03-03 17:39:54,871 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-03 17:40:25,938 - root - INFO - train loss:0.0012!
2021-03-03 17:40:27,525 - root - INFO - head hit:0.1864, head mean rank:581.0011, topn:10.
2021-03-03 17:40:27,526 - root - INFO - tail hit:0.4429, tail mean rank:189.7537, topn:10.
2021-03-03 17:40:27,526 - root - INFO - avg hit:0.3147, avg mean rank:385.3774, topn:10.
2021-03-03 17:40:30,018 - root - INFO - head hit:0.2058, head mean rank:553.6263, topn:10.
2021-03-03 17:40:30,019 - root - INFO - tail hit:0.4398, tail mean rank:191.6919, topn:10.
2021-03-03 17:40:30,019 - root - INFO - avg hit:0.3228, avg mean rank:372.6591, topn:10.
2021-03-03 17:40:30,020 - root - INFO - Checkpointing ...
2021-03-03 17:41:01,249 - root - INFO - train loss:0.0021!
2021-03-03 17:41:02,880 - root - INFO - head hit:0.1819, head mean rank:580.4203, topn:10.
2021-03-03 17:41:02,880 - root - INFO - tail hit:0.4475, tail mean rank:188.5695, topn:10.
2021-03-03 17:41:02,881 - root - INFO - avg hit:0.3147, avg mean rank:384.4949, topn:10.
2021-03-03 17:41:05,441 - root - INFO - head hit:0.2029, head mean rank:556.1227, topn:10.
2021-03-03 17:41:05,442 - root - INFO - tail hit:0.4409, tail mean rank:190.9073, topn:10.
2021-03-03 17:41:05,442 - root - INFO - avg hit:0.3219, avg mean rank:373.5150, topn:10.
2021-03-03 17:41:05,444 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-03 17:41:36,574 - root - INFO - train loss:0.0014!
2021-03-03 17:41:38,167 - root - INFO - head hit:0.1819, head mean rank:580.7582, topn:10.
2021-03-03 17:41:38,167 - root - INFO - tail hit:0.4554, tail mean rank:188.6780, topn:10.
2021-03-03 17:41:38,168 - root - INFO - avg hit:0.3186, avg mean rank:384.7181, topn:10.
2021-03-03 17:41:40,668 - root - INFO - head hit:0.2029, head mean rank:557.0300, topn:10.
2021-03-03 17:41:40,668 - root - INFO - tail hit:0.4432, tail mean rank:191.0667, topn:10.
2021-03-03 17:41:40,668 - root - INFO - avg hit:0.3231, avg mean rank:374.0483, topn:10.
2021-03-03 17:41:40,670 - root - INFO - Checkpointing ...
2021-03-03 17:42:13,129 - root - INFO - train loss:0.0015!
2021-03-03 17:42:14,513 - root - INFO - head hit:0.1831, head mean rank:582.2542, topn:10.
2021-03-03 17:42:14,514 - root - INFO - tail hit:0.4599, tail mean rank:189.2056, topn:10.
2021-03-03 17:42:14,514 - root - INFO - avg hit:0.3215, avg mean rank:385.7299, topn:10.
2021-03-03 17:42:16,836 - root - INFO - head hit:0.2007, head mean rank:558.2996, topn:10.
2021-03-03 17:42:16,836 - root - INFO - tail hit:0.4454, tail mean rank:191.5546, topn:10.
2021-03-03 17:42:16,836 - root - INFO - avg hit:0.3231, avg mean rank:374.9271, topn:10.
2021-03-03 17:42:16,838 - root - INFO - Checkpointing ...
2021-03-03 17:42:46,650 - root - INFO - train loss:0.0009!
2021-03-03 17:42:48,204 - root - INFO - head hit:0.1842, head mean rank:581.4215, topn:10.
2021-03-03 17:42:48,205 - root - INFO - tail hit:0.4599, tail mean rank:188.9661, topn:10.
2021-03-03 17:42:48,205 - root - INFO - avg hit:0.3220, avg mean rank:385.1938, topn:10.
2021-03-03 17:42:50,717 - root - INFO - head hit:0.2012, head mean rank:558.0447, topn:10.
2021-03-03 17:42:50,718 - root - INFO - tail hit:0.4488, tail mean rank:191.7965, topn:10.
2021-03-03 17:42:50,718 - root - INFO - avg hit:0.3250, avg mean rank:374.9206, topn:10.
2021-03-03 17:42:50,719 - root - INFO - Checkpointing ...
2021-03-03 17:43:21,706 - root - INFO - train loss:0.0010!
2021-03-03 17:43:23,309 - root - INFO - head hit:0.1842, head mean rank:581.4565, topn:10.
2021-03-03 17:43:23,309 - root - INFO - tail hit:0.4621, tail mean rank:188.7819, topn:10.
2021-03-03 17:43:23,309 - root - INFO - avg hit:0.3232, avg mean rank:385.1192, topn:10.
2021-03-03 17:43:25,759 - root - INFO - head hit:0.2012, head mean rank:558.1560, topn:10.
2021-03-03 17:43:25,760 - root - INFO - tail hit:0.4477, tail mean rank:191.8406, topn:10.
2021-03-03 17:43:25,760 - root - INFO - avg hit:0.3245, avg mean rank:374.9983, topn:10.
2021-03-03 17:43:25,761 - root - INFO - Checkpointing ...
2021-03-03 17:43:56,529 - root - INFO - train loss:0.0010!
2021-03-03 17:43:58,062 - root - INFO - head hit:0.1842, head mean rank:581.0362, topn:10.
2021-03-03 17:43:58,063 - root - INFO - tail hit:0.4588, tail mean rank:189.0407, topn:10.
2021-03-03 17:43:58,063 - root - INFO - avg hit:0.3215, avg mean rank:385.0384, topn:10.
2021-03-03 17:44:00,327 - root - INFO - head hit:0.2012, head mean rank:558.9474, topn:10.
2021-03-03 17:44:00,327 - root - INFO - tail hit:0.4449, tail mean rank:192.5223, topn:10.
2021-03-03 17:44:00,327 - root - INFO - avg hit:0.3231, avg mean rank:375.7349, topn:10.
2021-03-03 17:44:00,328 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-03 17:44:30,947 - root - INFO - train loss:0.0011!
2021-03-03 17:44:32,485 - root - INFO - head hit:0.1831, head mean rank:581.2271, topn:10.
2021-03-03 17:44:32,485 - root - INFO - tail hit:0.4610, tail mean rank:189.2565, topn:10.
2021-03-03 17:44:32,485 - root - INFO - avg hit:0.3220, avg mean rank:385.2418, topn:10.
2021-03-03 17:44:35,092 - root - INFO - head hit:0.2012, head mean rank:558.9079, topn:10.
2021-03-03 17:44:35,093 - root - INFO - tail hit:0.4454, tail mean rank:192.5851, topn:10.
2021-03-03 17:44:35,093 - root - INFO - avg hit:0.3233, avg mean rank:375.7465, topn:10.
2021-03-03 17:44:35,094 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-03 17:45:05,119 - root - INFO - train loss:0.0010!
2021-03-03 17:45:06,623 - root - INFO - head hit:0.1831, head mean rank:581.4113, topn:10.
2021-03-03 17:45:06,623 - root - INFO - tail hit:0.4599, tail mean rank:189.2757, topn:10.
2021-03-03 17:45:06,623 - root - INFO - avg hit:0.3215, avg mean rank:385.3435, topn:10.
2021-03-03 17:45:09,064 - root - INFO - head hit:0.2012, head mean rank:559.0300, topn:10.
2021-03-03 17:45:09,064 - root - INFO - tail hit:0.4466, tail mean rank:192.5500, topn:10.
2021-03-03 17:45:09,065 - root - INFO - avg hit:0.3239, avg mean rank:375.7900, topn:10.
2021-03-03 17:45:09,066 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-03 17:45:40,211 - root - INFO - train loss:0.0010!
2021-03-03 17:45:41,695 - root - INFO - head hit:0.1831, head mean rank:581.4904, topn:10.
2021-03-03 17:45:41,695 - root - INFO - tail hit:0.4599, tail mean rank:189.1684, topn:10.
2021-03-03 17:45:41,695 - root - INFO - avg hit:0.3215, avg mean rank:385.3294, topn:10.
2021-03-03 17:45:44,207 - root - INFO - head hit:0.2012, head mean rank:559.1159, topn:10.
2021-03-03 17:45:44,207 - root - INFO - tail hit:0.4471, tail mean rank:192.5184, topn:10.
2021-03-03 17:45:44,208 - root - INFO - avg hit:0.3242, avg mean rank:375.8171, topn:10.
2021-03-03 17:45:44,210 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-03 17:46:19,557 - root - INFO - No improvement after 24363 steps. Stopping training.
