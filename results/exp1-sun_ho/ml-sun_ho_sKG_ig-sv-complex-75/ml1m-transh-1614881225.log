2021-03-04 15:07:05,711 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-75/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-75/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614881225",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-75/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-75/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-04 15:07:05,765 - root - INFO - Totally 7707 train triples, 829,1623 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-75/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-75/cao-format/ml1m/kg/test.dat!
2021-03-04 15:07:05,771 - root - INFO - successfully load 4734 entities and 3 relations!
2021-03-04 15:07:05,783 - root - INFO - Building model.
2021-03-04 15:07:07,079 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(4734, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-04 15:07:07,079 - root - INFO - Total params: 474000.0
2021-03-04 15:07:07,080 - root - INFO - One epoch is 31 steps.
2021-03-04 15:07:07,080 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-04 15:07:07,085 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-sv-complex-75/ml1m-transe-pretrained.ckpt.
2021-03-04 15:07:07,085 - root - INFO - Training.
2021-03-04 15:07:07,085 - root - INFO - train loss:0.0000!
2021-03-04 15:07:08,730 - root - INFO - head hit:0.1689, head mean rank:722.3112, topn:10.
2021-03-04 15:07:08,731 - root - INFO - tail hit:0.4234, tail mean rank:420.1134, topn:10.
2021-03-04 15:07:08,731 - root - INFO - avg hit:0.2961, avg mean rank:571.2123, topn:10.
2021-03-04 15:07:11,576 - root - INFO - head hit:0.1479, head mean rank:758.3469, topn:10.
2021-03-04 15:07:11,576 - root - INFO - tail hit:0.3863, tail mean rank:505.1405, topn:10.
2021-03-04 15:07:11,577 - root - INFO - avg hit:0.2671, avg mean rank:631.7437, topn:10.
2021-03-04 15:07:46,460 - root - INFO - train loss:0.0322!
2021-03-04 15:07:48,115 - root - INFO - head hit:0.1098, head mean rank:765.8444, topn:10.
2021-03-04 15:07:48,115 - root - INFO - tail hit:0.3426, tail mean rank:452.7274, topn:10.
2021-03-04 15:07:48,115 - root - INFO - avg hit:0.2262, avg mean rank:609.2859, topn:10.
2021-03-04 15:07:51,076 - root - INFO - head hit:0.0949, head mean rank:764.3031, topn:10.
2021-03-04 15:07:51,077 - root - INFO - tail hit:0.3013, tail mean rank:540.1540, topn:10.
2021-03-04 15:07:51,077 - root - INFO - avg hit:0.1981, avg mean rank:652.2286, topn:10.
2021-03-04 15:07:51,079 - root - INFO - Checkpointing ...
2021-03-04 15:08:22,609 - root - INFO - train loss:0.0868!
2021-03-04 15:08:24,245 - root - INFO - head hit:0.1086, head mean rank:756.1411, topn:10.
2021-03-04 15:08:24,245 - root - INFO - tail hit:0.3305, tail mean rank:445.1411, topn:10.
2021-03-04 15:08:24,245 - root - INFO - avg hit:0.2195, avg mean rank:600.6411, topn:10.
2021-03-04 15:08:27,147 - root - INFO - head hit:0.0863, head mean rank:769.7351, topn:10.
2021-03-04 15:08:27,148 - root - INFO - tail hit:0.2884, tail mean rank:531.3956, topn:10.
2021-03-04 15:08:27,148 - root - INFO - avg hit:0.1873, avg mean rank:650.5653, topn:10.
2021-03-04 15:08:27,149 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:08:59,563 - root - INFO - train loss:0.0390!
2021-03-04 15:09:01,162 - root - INFO - head hit:0.1460, head mean rank:718.2871, topn:10.
2021-03-04 15:09:01,162 - root - INFO - tail hit:0.3534, tail mean rank:434.2811, topn:10.
2021-03-04 15:09:01,162 - root - INFO - avg hit:0.2497, avg mean rank:576.2841, topn:10.
2021-03-04 15:09:04,167 - root - INFO - head hit:0.1171, head mean rank:729.0025, topn:10.
2021-03-04 15:09:04,167 - root - INFO - tail hit:0.3130, tail mean rank:511.9889, topn:10.
2021-03-04 15:09:04,168 - root - INFO - avg hit:0.2150, avg mean rank:620.4957, topn:10.
2021-03-04 15:09:04,169 - root - INFO - Checkpointing ...
2021-03-04 15:09:40,344 - root - INFO - train loss:0.0222!
2021-03-04 15:09:42,072 - root - INFO - head hit:0.1472, head mean rank:709.7708, topn:10.
2021-03-04 15:09:42,073 - root - INFO - tail hit:0.3764, tail mean rank:432.0109, topn:10.
2021-03-04 15:09:42,073 - root - INFO - avg hit:0.2618, avg mean rank:570.8908, topn:10.
2021-03-04 15:09:45,080 - root - INFO - head hit:0.1263, head mean rank:732.5447, topn:10.
2021-03-04 15:09:45,080 - root - INFO - tail hit:0.3383, tail mean rank:511.3432, topn:10.
2021-03-04 15:09:45,080 - root - INFO - avg hit:0.2323, avg mean rank:621.9439, topn:10.
2021-03-04 15:09:45,082 - root - INFO - Checkpointing ...
2021-03-04 15:10:16,392 - root - INFO - train loss:0.0146!
2021-03-04 15:10:18,111 - root - INFO - head hit:0.1387, head mean rank:693.2497, topn:10.
2021-03-04 15:10:18,111 - root - INFO - tail hit:0.3957, tail mean rank:421.2195, topn:10.
2021-03-04 15:10:18,111 - root - INFO - avg hit:0.2672, avg mean rank:557.2346, topn:10.
2021-03-04 15:10:21,052 - root - INFO - head hit:0.1165, head mean rank:714.3161, topn:10.
2021-03-04 15:10:21,052 - root - INFO - tail hit:0.3537, tail mean rank:514.5638, topn:10.
2021-03-04 15:10:21,052 - root - INFO - avg hit:0.2351, avg mean rank:614.4399, topn:10.
2021-03-04 15:10:21,054 - root - INFO - Checkpointing ...
2021-03-04 15:10:50,906 - root - INFO - train loss:0.0142!
2021-03-04 15:10:52,560 - root - INFO - head hit:0.1472, head mean rank:701.3390, topn:10.
2021-03-04 15:10:52,560 - root - INFO - tail hit:0.4065, tail mean rank:423.6345, topn:10.
2021-03-04 15:10:52,561 - root - INFO - avg hit:0.2768, avg mean rank:562.4867, topn:10.
2021-03-04 15:10:55,404 - root - INFO - head hit:0.1356, head mean rank:714.6913, topn:10.
2021-03-04 15:10:55,404 - root - INFO - tail hit:0.3641, tail mean rank:509.2274, topn:10.
2021-03-04 15:10:55,404 - root - INFO - avg hit:0.2498, avg mean rank:611.9593, topn:10.
2021-03-04 15:10:55,406 - root - INFO - Checkpointing ...
2021-03-04 15:11:27,007 - root - INFO - train loss:0.0110!
2021-03-04 15:11:28,674 - root - INFO - head hit:0.1496, head mean rank:688.1556, topn:10.
2021-03-04 15:11:28,674 - root - INFO - tail hit:0.3896, tail mean rank:419.1230, topn:10.
2021-03-04 15:11:28,674 - root - INFO - avg hit:0.2696, avg mean rank:553.6393, topn:10.
2021-03-04 15:11:31,590 - root - INFO - head hit:0.1288, head mean rank:720.4251, topn:10.
2021-03-04 15:11:31,590 - root - INFO - tail hit:0.3549, tail mean rank:499.2311, topn:10.
2021-03-04 15:11:31,590 - root - INFO - avg hit:0.2418, avg mean rank:609.8281, topn:10.
2021-03-04 15:11:31,592 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:12:03,410 - root - INFO - train loss:0.0077!
2021-03-04 15:12:05,115 - root - INFO - head hit:0.1496, head mean rank:690.7805, topn:10.
2021-03-04 15:12:05,115 - root - INFO - tail hit:0.4101, tail mean rank:410.5862, topn:10.
2021-03-04 15:12:05,115 - root - INFO - avg hit:0.2799, avg mean rank:550.6834, topn:10.
2021-03-04 15:12:08,059 - root - INFO - head hit:0.1325, head mean rank:729.6827, topn:10.
2021-03-04 15:12:08,060 - root - INFO - tail hit:0.3808, tail mean rank:504.1454, topn:10.
2021-03-04 15:12:08,060 - root - INFO - avg hit:0.2566, avg mean rank:616.9140, topn:10.
2021-03-04 15:12:08,061 - root - INFO - Checkpointing ...
2021-03-04 15:12:40,520 - root - INFO - train loss:0.0045!
2021-03-04 15:12:42,201 - root - INFO - head hit:0.1568, head mean rank:685.9469, topn:10.
2021-03-04 15:12:42,201 - root - INFO - tail hit:0.4246, tail mean rank:411.6960, topn:10.
2021-03-04 15:12:42,201 - root - INFO - avg hit:0.2907, avg mean rank:548.8215, topn:10.
2021-03-04 15:12:45,158 - root - INFO - head hit:0.1374, head mean rank:721.1547, topn:10.
2021-03-04 15:12:45,159 - root - INFO - tail hit:0.3746, tail mean rank:498.6014, topn:10.
2021-03-04 15:12:45,159 - root - INFO - avg hit:0.2560, avg mean rank:609.8780, topn:10.
2021-03-04 15:12:45,160 - root - INFO - Checkpointing ...
2021-03-04 15:13:17,731 - root - INFO - train loss:0.0037!
2021-03-04 15:13:19,348 - root - INFO - head hit:0.1665, head mean rank:691.9505, topn:10.
2021-03-04 15:13:19,348 - root - INFO - tail hit:0.4246, tail mean rank:416.4958, topn:10.
2021-03-04 15:13:19,348 - root - INFO - avg hit:0.2955, avg mean rank:554.2232, topn:10.
2021-03-04 15:13:22,256 - root - INFO - head hit:0.1510, head mean rank:716.3130, topn:10.
2021-03-04 15:13:22,256 - root - INFO - tail hit:0.3857, tail mean rank:495.3019, topn:10.
2021-03-04 15:13:22,256 - root - INFO - avg hit:0.2683, avg mean rank:605.8075, topn:10.
2021-03-04 15:13:22,257 - root - INFO - Checkpointing ...
2021-03-04 15:13:54,502 - root - INFO - train loss:0.0034!
2021-03-04 15:13:56,197 - root - INFO - head hit:0.1665, head mean rank:683.6996, topn:10.
2021-03-04 15:13:56,197 - root - INFO - tail hit:0.4294, tail mean rank:415.9349, topn:10.
2021-03-04 15:13:56,197 - root - INFO - avg hit:0.2979, avg mean rank:549.8172, topn:10.
2021-03-04 15:13:59,204 - root - INFO - head hit:0.1466, head mean rank:708.1497, topn:10.
2021-03-04 15:13:59,205 - root - INFO - tail hit:0.3900, tail mean rank:486.7135, topn:10.
2021-03-04 15:13:59,205 - root - INFO - avg hit:0.2683, avg mean rank:597.4316, topn:10.
2021-03-04 15:13:59,206 - root - INFO - Checkpointing ...
2021-03-04 15:14:32,759 - root - INFO - train loss:0.0032!
2021-03-04 15:14:34,374 - root - INFO - head hit:0.1544, head mean rank:686.4524, topn:10.
2021-03-04 15:14:34,374 - root - INFO - tail hit:0.4222, tail mean rank:410.5139, topn:10.
2021-03-04 15:14:34,375 - root - INFO - avg hit:0.2883, avg mean rank:548.4831, topn:10.
2021-03-04 15:14:37,416 - root - INFO - head hit:0.1485, head mean rank:711.9513, topn:10.
2021-03-04 15:14:37,416 - root - INFO - tail hit:0.3826, tail mean rank:480.1201, topn:10.
2021-03-04 15:14:37,416 - root - INFO - avg hit:0.2656, avg mean rank:596.0357, topn:10.
2021-03-04 15:14:37,418 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:15:09,642 - root - INFO - train loss:0.0021!
2021-03-04 15:15:11,270 - root - INFO - head hit:0.1665, head mean rank:685.2618, topn:10.
2021-03-04 15:15:11,270 - root - INFO - tail hit:0.4150, tail mean rank:415.1134, topn:10.
2021-03-04 15:15:11,270 - root - INFO - avg hit:0.2907, avg mean rank:550.1876, topn:10.
2021-03-04 15:15:14,321 - root - INFO - head hit:0.1553, head mean rank:711.7486, topn:10.
2021-03-04 15:15:14,321 - root - INFO - tail hit:0.3734, tail mean rank:485.7825, topn:10.
2021-03-04 15:15:14,322 - root - INFO - avg hit:0.2643, avg mean rank:598.7656, topn:10.
2021-03-04 15:15:14,323 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:15:47,021 - root - INFO - train loss:0.0019!
2021-03-04 15:15:48,600 - root - INFO - head hit:0.1689, head mean rank:691.1472, topn:10.
2021-03-04 15:15:48,600 - root - INFO - tail hit:0.4294, tail mean rank:412.2388, topn:10.
2021-03-04 15:15:48,600 - root - INFO - avg hit:0.2992, avg mean rank:551.6930, topn:10.
2021-03-04 15:15:51,532 - root - INFO - head hit:0.1602, head mean rank:717.1836, topn:10.
2021-03-04 15:15:51,533 - root - INFO - tail hit:0.3882, tail mean rank:483.0364, topn:10.
2021-03-04 15:15:51,533 - root - INFO - avg hit:0.2742, avg mean rank:600.1100, topn:10.
2021-03-04 15:15:51,535 - root - INFO - Checkpointing ...
2021-03-04 15:16:22,791 - root - INFO - train loss:0.0019!
2021-03-04 15:16:24,394 - root - INFO - head hit:0.1677, head mean rank:692.7600, topn:10.
2021-03-04 15:16:24,395 - root - INFO - tail hit:0.4282, tail mean rank:412.7732, topn:10.
2021-03-04 15:16:24,395 - root - INFO - avg hit:0.2979, avg mean rank:552.7666, topn:10.
2021-03-04 15:16:27,359 - root - INFO - head hit:0.1577, head mean rank:716.9476, topn:10.
2021-03-04 15:16:27,360 - root - INFO - tail hit:0.3931, tail mean rank:482.7819, topn:10.
2021-03-04 15:16:27,360 - root - INFO - avg hit:0.2754, avg mean rank:599.8648, topn:10.
2021-03-04 15:16:27,362 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:16:58,404 - root - INFO - train loss:0.0014!
2021-03-04 15:17:00,062 - root - INFO - head hit:0.1701, head mean rank:691.7117, topn:10.
2021-03-04 15:17:00,062 - root - INFO - tail hit:0.4306, tail mean rank:413.1399, topn:10.
2021-03-04 15:17:00,062 - root - INFO - avg hit:0.3004, avg mean rank:552.4258, topn:10.
2021-03-04 15:17:03,027 - root - INFO - head hit:0.1596, head mean rank:716.2871, topn:10.
2021-03-04 15:17:03,028 - root - INFO - tail hit:0.3949, tail mean rank:483.8139, topn:10.
2021-03-04 15:17:03,028 - root - INFO - avg hit:0.2773, avg mean rank:600.0505, topn:10.
2021-03-04 15:17:03,029 - root - INFO - Checkpointing ...
2021-03-04 15:17:33,846 - root - INFO - train loss:0.0010!
2021-03-04 15:17:35,428 - root - INFO - head hit:0.1701, head mean rank:693.1423, topn:10.
2021-03-04 15:17:35,428 - root - INFO - tail hit:0.4306, tail mean rank:412.4101, topn:10.
2021-03-04 15:17:35,428 - root - INFO - avg hit:0.3004, avg mean rank:552.7762, topn:10.
2021-03-04 15:17:38,302 - root - INFO - head hit:0.1614, head mean rank:718.2150, topn:10.
2021-03-04 15:17:38,303 - root - INFO - tail hit:0.3980, tail mean rank:483.2656, topn:10.
2021-03-04 15:17:38,303 - root - INFO - avg hit:0.2797, avg mean rank:600.7403, topn:10.
2021-03-04 15:17:38,304 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:18:09,902 - root - INFO - train loss:0.0021!
2021-03-04 15:18:11,476 - root - INFO - head hit:0.1701, head mean rank:692.0965, topn:10.
2021-03-04 15:18:11,476 - root - INFO - tail hit:0.4306, tail mean rank:411.6876, topn:10.
2021-03-04 15:18:11,477 - root - INFO - avg hit:0.3004, avg mean rank:551.8920, topn:10.
2021-03-04 15:18:14,378 - root - INFO - head hit:0.1602, head mean rank:717.3648, topn:10.
2021-03-04 15:18:14,379 - root - INFO - tail hit:0.3999, tail mean rank:483.3025, topn:10.
2021-03-04 15:18:14,379 - root - INFO - avg hit:0.2800, avg mean rank:600.3336, topn:10.
2021-03-04 15:18:14,380 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:18:47,711 - root - INFO - train loss:0.0013!
2021-03-04 15:18:49,361 - root - INFO - head hit:0.1713, head mean rank:691.9578, topn:10.
2021-03-04 15:18:49,362 - root - INFO - tail hit:0.4318, tail mean rank:411.8359, topn:10.
2021-03-04 15:18:49,362 - root - INFO - avg hit:0.3016, avg mean rank:551.8969, topn:10.
2021-03-04 15:18:52,284 - root - INFO - head hit:0.1590, head mean rank:717.2526, topn:10.
2021-03-04 15:18:52,284 - root - INFO - tail hit:0.4011, tail mean rank:483.2274, topn:10.
2021-03-04 15:18:52,284 - root - INFO - avg hit:0.2800, avg mean rank:600.2400, topn:10.
2021-03-04 15:18:52,286 - root - INFO - Checkpointing ...
2021-03-04 15:19:26,944 - root - INFO - train loss:0.0009!
2021-03-04 15:19:28,559 - root - INFO - head hit:0.1713, head mean rank:692.1399, topn:10.
2021-03-04 15:19:28,559 - root - INFO - tail hit:0.4306, tail mean rank:411.5235, topn:10.
2021-03-04 15:19:28,559 - root - INFO - avg hit:0.3010, avg mean rank:551.8317, topn:10.
2021-03-04 15:19:31,404 - root - INFO - head hit:0.1596, head mean rank:717.3038, topn:10.
2021-03-04 15:19:31,405 - root - INFO - tail hit:0.4005, tail mean rank:482.7714, topn:10.
2021-03-04 15:19:31,405 - root - INFO - avg hit:0.2800, avg mean rank:600.0376, topn:10.
2021-03-04 15:19:31,406 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:20:03,094 - root - INFO - train loss:0.0012!
2021-03-04 15:20:04,688 - root - INFO - head hit:0.1713, head mean rank:692.0905, topn:10.
2021-03-04 15:20:04,688 - root - INFO - tail hit:0.4306, tail mean rank:411.3764, topn:10.
2021-03-04 15:20:04,688 - root - INFO - avg hit:0.3010, avg mean rank:551.7334, topn:10.
2021-03-04 15:20:07,709 - root - INFO - head hit:0.1596, head mean rank:717.0875, topn:10.
2021-03-04 15:20:07,710 - root - INFO - tail hit:0.4005, tail mean rank:482.7049, topn:10.
2021-03-04 15:20:07,710 - root - INFO - avg hit:0.2800, avg mean rank:599.8962, topn:10.
2021-03-04 15:20:07,712 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:20:38,282 - root - INFO - train loss:0.0010!
2021-03-04 15:20:39,882 - root - INFO - head hit:0.1725, head mean rank:692.1327, topn:10.
2021-03-04 15:20:39,883 - root - INFO - tail hit:0.4306, tail mean rank:411.4439, topn:10.
2021-03-04 15:20:39,883 - root - INFO - avg hit:0.3016, avg mean rank:551.7883, topn:10.
2021-03-04 15:20:42,885 - root - INFO - head hit:0.1596, head mean rank:717.1152, topn:10.
2021-03-04 15:20:42,885 - root - INFO - tail hit:0.3999, tail mean rank:482.7203, topn:10.
2021-03-04 15:20:42,886 - root - INFO - avg hit:0.2797, avg mean rank:599.9177, topn:10.
2021-03-04 15:20:42,887 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:21:16,429 - root - INFO - train loss:0.0011!
2021-03-04 15:21:18,089 - root - INFO - head hit:0.1725, head mean rank:692.1520, topn:10.
2021-03-04 15:21:18,090 - root - INFO - tail hit:0.4306, tail mean rank:411.4125, topn:10.
2021-03-04 15:21:18,090 - root - INFO - avg hit:0.3016, avg mean rank:551.7823, topn:10.
2021-03-04 15:21:21,139 - root - INFO - head hit:0.1596, head mean rank:717.1084, topn:10.
2021-03-04 15:21:21,139 - root - INFO - tail hit:0.3993, tail mean rank:482.7086, topn:10.
2021-03-04 15:21:21,139 - root - INFO - avg hit:0.2794, avg mean rank:599.9085, topn:10.
2021-03-04 15:21:21,141 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-04 15:21:53,148 - root - INFO - No improvement after 24363 steps. Stopping training.
