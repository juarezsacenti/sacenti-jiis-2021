2021-03-02 09:55:29,477 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 13317,
    "embedding_size": 100,
    "eval_interval_steps": 2663,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transup-1614689729",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": null,
    "l2_lambda": 1e-05,
    "learning_rate": 0.005,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/ml1m-bprmf-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transup",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 3,
    "num_processes": 4,
    "optimizer_type": "Adagrad",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 266300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-02 09:55:29,709 - root - INFO - Totally 69982 train ratings, 9998,19995 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/cao-format/ml1m/test.dat!
2021-03-02 09:55:29,712 - root - INFO - successfully load 943 users and 1675 items!
2021-03-02 09:55:29,792 - root - INFO - Building model.
2021-03-02 09:55:31,074 - root - INFO - Architecture: TransUPModel(
  (user_embeddings): Embedding(943, 100)
  (item_embeddings): Embedding(1675, 100)
  (pref_embeddings): Embedding(3, 100)
  (pref_norm_embeddings): Embedding(3, 100)
)
2021-03-02 09:55:31,074 - root - INFO - Total params: 262400.0
2021-03-02 09:55:31,074 - root - INFO - One epoch is 274 steps.
2021-03-02 09:55:31,075 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-02 09:55:31,078 - root - INFO - Load Embeddings of user_embeddings.weight, item_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/ml1m-bprmf-pretrained.ckpt.
2021-03-02 09:55:31,078 - root - INFO - Training.
2021-03-02 09:55:31,078 - root - INFO - train loss:0.0000!
2021-03-02 09:55:32,410 - root - INFO - f1:0.0716, p:0.0968, r:0.0758, hit:0.4528, ndcg:0.2697, topn:10.
2021-03-02 09:55:33,693 - root - INFO - f1:0.0781, p:0.1593, r:0.0634, hit:0.5748, ndcg:0.3602, topn:10.
2021-03-02 09:55:53,852 - root - INFO - train loss:77.7923!
2021-03-02 09:55:55,109 - root - INFO - f1:0.1436, p:0.1663, r:0.1782, hit:0.7190, ndcg:0.4426, topn:10.
2021-03-02 09:55:56,356 - root - INFO - f1:0.1705, p:0.2744, r:0.1635, hit:0.8547, ndcg:0.5773, topn:10.
2021-03-02 09:55:56,361 - root - INFO - Checkpointing ...
2021-03-02 09:56:18,384 - root - INFO - train loss:0.1736!
2021-03-02 09:56:19,588 - root - INFO - f1:0.1492, p:0.1729, r:0.1867, hit:0.7285, ndcg:0.4541, topn:10.
2021-03-02 09:56:20,840 - root - INFO - f1:0.1766, p:0.2830, r:0.1706, hit:0.8685, ndcg:0.5926, topn:10.
2021-03-02 09:56:20,844 - root - INFO - Checkpointing ...
2021-03-02 09:56:41,471 - root - INFO - train loss:0.1629!
2021-03-02 09:56:42,807 - root - INFO - f1:0.1532, p:0.1778, r:0.1889, hit:0.7328, ndcg:0.4635, topn:10.
2021-03-02 09:56:44,076 - root - INFO - f1:0.1809, p:0.2905, r:0.1743, hit:0.8749, ndcg:0.6003, topn:10.
2021-03-02 09:56:44,080 - root - INFO - Checkpointing ...
2021-03-02 09:57:04,871 - root - INFO - train loss:0.1564!
2021-03-02 09:57:06,132 - root - INFO - f1:0.1554, p:0.1802, r:0.1924, hit:0.7338, ndcg:0.4696, topn:10.
2021-03-02 09:57:07,396 - root - INFO - f1:0.1861, p:0.2972, r:0.1800, hit:0.8834, ndcg:0.6093, topn:10.
2021-03-02 09:57:07,400 - root - INFO - Checkpointing ...
2021-03-02 09:57:28,489 - root - INFO - train loss:0.1516!
2021-03-02 09:57:29,676 - root - INFO - f1:0.1597, p:0.1850, r:0.1980, hit:0.7423, ndcg:0.4764, topn:10.
2021-03-02 09:57:30,919 - root - INFO - f1:0.1894, p:0.3023, r:0.1833, hit:0.8908, ndcg:0.6183, topn:10.
2021-03-02 09:57:30,924 - root - INFO - Checkpointing ...
2021-03-02 09:57:51,437 - root - INFO - train loss:0.1473!
2021-03-02 09:57:52,580 - root - INFO - f1:0.1614, p:0.1864, r:0.2013, hit:0.7487, ndcg:0.4800, topn:10.
2021-03-02 09:57:53,838 - root - INFO - f1:0.1910, p:0.3052, r:0.1844, hit:0.8887, ndcg:0.6227, topn:10.
2021-03-02 09:57:53,843 - root - INFO - Checkpointing ...
2021-03-02 09:58:15,497 - root - INFO - train loss:0.1441!
2021-03-02 09:58:16,930 - root - INFO - f1:0.1643, p:0.1899, r:0.2047, hit:0.7519, ndcg:0.4834, topn:10.
2021-03-02 09:58:18,139 - root - INFO - f1:0.1936, p:0.3090, r:0.1871, hit:0.8950, ndcg:0.6254, topn:10.
2021-03-02 09:58:18,144 - root - INFO - Checkpointing ...
2021-03-02 09:58:38,306 - root - INFO - train loss:0.1415!
2021-03-02 09:58:39,505 - root - INFO - f1:0.1660, p:0.1917, r:0.2071, hit:0.7529, ndcg:0.4871, topn:10.
2021-03-02 09:58:40,785 - root - INFO - f1:0.1953, p:0.3116, r:0.1886, hit:0.8918, ndcg:0.6288, topn:10.
2021-03-02 09:58:40,788 - root - INFO - Checkpointing ...
2021-03-02 09:59:02,253 - root - INFO - train loss:0.1394!
2021-03-02 09:59:03,509 - root - INFO - f1:0.1665, p:0.1925, r:0.2071, hit:0.7476, ndcg:0.4887, topn:10.
2021-03-02 09:59:04,728 - root - INFO - f1:0.1979, p:0.3158, r:0.1911, hit:0.8929, ndcg:0.6307, topn:10.
2021-03-02 09:59:04,733 - root - INFO - Checkpointing ...
2021-03-02 09:59:26,333 - root - INFO - train loss:0.1368!
2021-03-02 09:59:27,605 - root - INFO - f1:0.1684, p:0.1946, r:0.2098, hit:0.7561, ndcg:0.4943, topn:10.
2021-03-02 09:59:28,895 - root - INFO - f1:0.2002, p:0.3191, r:0.1933, hit:0.8950, ndcg:0.6357, topn:10.
2021-03-02 09:59:28,898 - root - INFO - Checkpointing ...
2021-03-02 09:59:49,662 - root - INFO - train loss:0.1355!
2021-03-02 09:59:50,894 - root - INFO - f1:0.1699, p:0.1964, r:0.2104, hit:0.7593, ndcg:0.4994, topn:10.
2021-03-02 09:59:52,109 - root - INFO - f1:0.2017, p:0.3215, r:0.1949, hit:0.8961, ndcg:0.6382, topn:10.
2021-03-02 09:59:52,113 - root - INFO - Checkpointing ...
2021-03-02 10:00:12,938 - root - INFO - train loss:0.1338!
2021-03-02 10:00:14,165 - root - INFO - f1:0.1715, p:0.1987, r:0.2117, hit:0.7614, ndcg:0.5022, topn:10.
2021-03-02 10:00:15,360 - root - INFO - f1:0.2036, p:0.3242, r:0.1978, hit:0.8950, ndcg:0.6389, topn:10.
2021-03-02 10:00:15,364 - root - INFO - Checkpointing ...
2021-03-02 10:00:35,760 - root - INFO - train loss:0.1322!
2021-03-02 10:00:36,978 - root - INFO - f1:0.1746, p:0.2018, r:0.2164, hit:0.7688, ndcg:0.5064, topn:10.
2021-03-02 10:00:38,271 - root - INFO - f1:0.2053, p:0.3266, r:0.1991, hit:0.9014, ndcg:0.6432, topn:10.
2021-03-02 10:00:38,275 - root - INFO - Checkpointing ...
2021-03-02 10:00:58,409 - root - INFO - train loss:0.1308!
2021-03-02 10:00:59,601 - root - INFO - f1:0.1760, p:0.2033, r:0.2181, hit:0.7709, ndcg:0.5096, topn:10.
2021-03-02 10:01:00,846 - root - INFO - f1:0.2066, p:0.3293, r:0.2001, hit:0.8993, ndcg:0.6431, topn:10.
2021-03-02 10:01:00,850 - root - INFO - Checkpointing ...
2021-03-02 10:01:21,769 - root - INFO - train loss:0.1293!
2021-03-02 10:01:23,039 - root - INFO - f1:0.1760, p:0.2034, r:0.2178, hit:0.7699, ndcg:0.5103, topn:10.
2021-03-02 10:01:24,321 - root - INFO - f1:0.2079, p:0.3305, r:0.2019, hit:0.9035, ndcg:0.6442, topn:10.
2021-03-02 10:01:24,325 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 10:01:44,141 - root - INFO - train loss:0.1323!
2021-03-02 10:01:45,268 - root - INFO - f1:0.1858, p:0.2127, r:0.2357, hit:0.7890, ndcg:0.5419, topn:10.
2021-03-02 10:01:46,461 - root - INFO - f1:0.2174, p:0.3435, r:0.2091, hit:0.9003, ndcg:0.6680, topn:10.
2021-03-02 10:01:46,466 - root - INFO - Checkpointing ...
2021-03-02 10:02:07,119 - root - INFO - train loss:0.1246!
2021-03-02 10:02:08,338 - root - INFO - f1:0.1902, p:0.2178, r:0.2411, hit:0.7900, ndcg:0.5458, topn:10.
2021-03-02 10:02:09,609 - root - INFO - f1:0.2189, p:0.3459, r:0.2109, hit:0.9046, ndcg:0.6756, topn:10.
2021-03-02 10:02:09,612 - root - INFO - Checkpointing ...
2021-03-02 10:02:29,623 - root - INFO - train loss:0.1220!
2021-03-02 10:02:30,879 - root - INFO - f1:0.1914, p:0.2195, r:0.2419, hit:0.7900, ndcg:0.5479, topn:10.
2021-03-02 10:02:32,088 - root - INFO - f1:0.2229, p:0.3520, r:0.2147, hit:0.9077, ndcg:0.6819, topn:10.
2021-03-02 10:02:32,092 - root - INFO - Checkpointing ...
2021-03-02 10:02:52,746 - root - INFO - train loss:0.1195!
2021-03-02 10:02:53,991 - root - INFO - f1:0.1924, p:0.2204, r:0.2442, hit:0.7900, ndcg:0.5512, topn:10.
2021-03-02 10:02:55,225 - root - INFO - f1:0.2243, p:0.3547, r:0.2151, hit:0.9088, ndcg:0.6815, topn:10.
2021-03-02 10:02:55,229 - root - INFO - Checkpointing ...
2021-03-02 10:03:15,433 - root - INFO - train loss:0.1186!
2021-03-02 10:03:16,839 - root - INFO - f1:0.1943, p:0.2227, r:0.2458, hit:0.7932, ndcg:0.5537, topn:10.
2021-03-02 10:03:18,045 - root - INFO - f1:0.2251, p:0.3559, r:0.2162, hit:0.9077, ndcg:0.6823, topn:10.
2021-03-02 10:03:18,050 - root - INFO - Checkpointing ...
2021-03-02 10:03:40,112 - root - INFO - train loss:0.1172!
2021-03-02 10:03:41,343 - root - INFO - f1:0.1957, p:0.2238, r:0.2480, hit:0.7996, ndcg:0.5580, topn:10.
2021-03-02 10:03:42,641 - root - INFO - f1:0.2261, p:0.3574, r:0.2170, hit:0.9067, ndcg:0.6845, topn:10.
2021-03-02 10:03:42,645 - root - INFO - Checkpointing ...
2021-03-02 10:04:03,872 - root - INFO - train loss:0.1161!
2021-03-02 10:04:05,092 - root - INFO - f1:0.1968, p:0.2251, r:0.2496, hit:0.8006, ndcg:0.5593, topn:10.
2021-03-02 10:04:06,331 - root - INFO - f1:0.2279, p:0.3607, r:0.2192, hit:0.9077, ndcg:0.6849, topn:10.
2021-03-02 10:04:06,336 - root - INFO - Checkpointing ...
2021-03-02 10:04:27,393 - root - INFO - train loss:0.1152!
2021-03-02 10:04:28,676 - root - INFO - f1:0.1974, p:0.2257, r:0.2506, hit:0.8006, ndcg:0.5612, topn:10.
2021-03-02 10:04:29,949 - root - INFO - f1:0.2285, p:0.3607, r:0.2205, hit:0.9099, ndcg:0.6884, topn:10.
2021-03-02 10:04:29,954 - root - INFO - Checkpointing ...
2021-03-02 10:04:50,711 - root - INFO - train loss:0.1136!
2021-03-02 10:04:51,945 - root - INFO - f1:0.1974, p:0.2260, r:0.2500, hit:0.7964, ndcg:0.5630, topn:10.
2021-03-02 10:04:53,210 - root - INFO - f1:0.2288, p:0.3614, r:0.2197, hit:0.9088, ndcg:0.6904, topn:10.
2021-03-02 10:04:53,214 - root - INFO - Checkpointing ...
2021-03-02 10:05:14,360 - root - INFO - train loss:0.1140!
2021-03-02 10:05:15,517 - root - INFO - f1:0.1982, p:0.2265, r:0.2523, hit:0.8028, ndcg:0.5666, topn:10.
2021-03-02 10:05:16,792 - root - INFO - f1:0.2291, p:0.3621, r:0.2198, hit:0.9088, ndcg:0.6928, topn:10.
2021-03-02 10:05:16,796 - root - INFO - Checkpointing ...
2021-03-02 10:05:38,872 - root - INFO - train loss:0.1134!
2021-03-02 10:05:40,145 - root - INFO - f1:0.1979, p:0.2266, r:0.2515, hit:0.8038, ndcg:0.5690, topn:10.
2021-03-02 10:05:41,433 - root - INFO - f1:0.2292, p:0.3626, r:0.2206, hit:0.9088, ndcg:0.6941, topn:10.
2021-03-02 10:05:41,438 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 10:06:03,260 - root - INFO - train loss:0.1148!
2021-03-02 10:06:04,512 - root - INFO - f1:0.1984, p:0.2273, r:0.2520, hit:0.8017, ndcg:0.5700, topn:10.
2021-03-02 10:06:05,804 - root - INFO - f1:0.2311, p:0.3660, r:0.2220, hit:0.9141, ndcg:0.6972, topn:10.
2021-03-02 10:06:05,808 - root - INFO - Checkpointing ...
2021-03-02 10:06:25,576 - root - INFO - train loss:0.1121!
2021-03-02 10:06:26,800 - root - INFO - f1:0.2003, p:0.2295, r:0.2537, hit:0.8091, ndcg:0.5740, topn:10.
2021-03-02 10:06:28,037 - root - INFO - f1:0.2335, p:0.3689, r:0.2245, hit:0.9162, ndcg:0.6989, topn:10.
2021-03-02 10:06:28,041 - root - INFO - Checkpointing ...
2021-03-02 10:06:48,915 - root - INFO - train loss:0.1110!
2021-03-02 10:06:50,166 - root - INFO - f1:0.2004, p:0.2297, r:0.2538, hit:0.8081, ndcg:0.5750, topn:10.
2021-03-02 10:06:51,445 - root - INFO - f1:0.2347, p:0.3709, r:0.2254, hit:0.9162, ndcg:0.7032, topn:10.
2021-03-02 10:06:51,449 - root - INFO - Checkpointing ...
2021-03-02 10:07:12,312 - root - INFO - train loss:0.1100!
2021-03-02 10:07:13,542 - root - INFO - f1:0.2012, p:0.2306, r:0.2548, hit:0.8091, ndcg:0.5772, topn:10.
2021-03-02 10:07:14,864 - root - INFO - f1:0.2347, p:0.3713, r:0.2251, hit:0.9130, ndcg:0.7026, topn:10.
2021-03-02 10:07:14,868 - root - INFO - Checkpointing ...
2021-03-02 10:07:34,759 - root - INFO - train loss:0.1089!
2021-03-02 10:07:36,003 - root - INFO - f1:0.2018, p:0.2316, r:0.2550, hit:0.8112, ndcg:0.5790, topn:10.
2021-03-02 10:07:37,302 - root - INFO - f1:0.2351, p:0.3717, r:0.2257, hit:0.9130, ndcg:0.7063, topn:10.
2021-03-02 10:07:37,307 - root - INFO - Checkpointing ...
2021-03-02 10:07:59,388 - root - INFO - train loss:0.1085!
2021-03-02 10:08:00,585 - root - INFO - f1:0.2024, p:0.2320, r:0.2559, hit:0.8134, ndcg:0.5795, topn:10.
2021-03-02 10:08:01,856 - root - INFO - f1:0.2352, p:0.3719, r:0.2254, hit:0.9120, ndcg:0.7073, topn:10.
2021-03-02 10:08:01,859 - root - INFO - Checkpointing ...
2021-03-02 10:08:22,990 - root - INFO - train loss:0.1081!
2021-03-02 10:08:24,296 - root - INFO - f1:0.2028, p:0.2324, r:0.2565, hit:0.8155, ndcg:0.5815, topn:10.
2021-03-02 10:08:25,738 - root - INFO - f1:0.2369, p:0.3744, r:0.2268, hit:0.9120, ndcg:0.7058, topn:10.
2021-03-02 10:08:25,741 - root - INFO - Checkpointing ...
2021-03-02 10:08:46,257 - root - INFO - train loss:0.1077!
2021-03-02 10:08:47,492 - root - INFO - f1:0.2023, p:0.2321, r:0.2556, hit:0.8134, ndcg:0.5810, topn:10.
2021-03-02 10:08:48,754 - root - INFO - f1:0.2368, p:0.3739, r:0.2270, hit:0.9120, ndcg:0.7066, topn:10.
2021-03-02 10:08:48,759 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 10:09:09,974 - root - INFO - train loss:0.1089!
2021-03-02 10:09:11,222 - root - INFO - f1:0.2022, p:0.2323, r:0.2556, hit:0.8102, ndcg:0.5807, topn:10.
2021-03-02 10:09:12,464 - root - INFO - f1:0.2369, p:0.3743, r:0.2267, hit:0.9173, ndcg:0.7095, topn:10.
2021-03-02 10:09:12,468 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 10:09:33,008 - root - INFO - train loss:0.1081!
2021-03-02 10:09:34,292 - root - INFO - f1:0.2018, p:0.2320, r:0.2551, hit:0.8112, ndcg:0.5816, topn:10.
2021-03-02 10:09:35,550 - root - INFO - f1:0.2363, p:0.3730, r:0.2266, hit:0.9152, ndcg:0.7104, topn:10.
2021-03-02 10:09:35,554 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 10:09:54,817 - root - INFO - train loss:0.1077!
2021-03-02 10:09:56,137 - root - INFO - f1:0.2026, p:0.2332, r:0.2559, hit:0.8091, ndcg:0.5825, topn:10.
2021-03-02 10:09:57,337 - root - INFO - f1:0.2366, p:0.3734, r:0.2268, hit:0.9152, ndcg:0.7099, topn:10.
2021-03-02 10:09:57,342 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 10:10:16,811 - root - INFO - train loss:0.1074!
2021-03-02 10:10:18,065 - root - INFO - f1:0.2027, p:0.2331, r:0.2562, hit:0.8102, ndcg:0.5827, topn:10.
2021-03-02 10:10:19,311 - root - INFO - f1:0.2358, p:0.3729, r:0.2259, hit:0.9141, ndcg:0.7107, topn:10.
2021-03-02 10:10:19,315 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 10:10:19,369 - root - INFO - No improvement after 13317 steps. Stopping training.
2021-03-02 10:10:20,996 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.233086, 'RECALL@10': 0.256141, 'NDCG@10': 0.583113, 'MAP@10': 0.477707, 'MAP': 0.477707}.
2021-03-02 10:10:21,196 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.470926, 'GENRE_REDUNDANCY@10': 0.428504, 'ILD_GENRE@10': 0.809357}.
2021-03-02 10:10:22,951 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.373065, 'RECALL@10': 0.225973, 'NDCG@10': 0.710857, 'MAP@10': 0.611887, 'MAP': 0.611887}.
2021-03-02 10:10:23,153 - root - INFO - From kg-summ-rec diversity evaluator: {'GENRE_COVERAGE@10': 0.466905, 'GENRE_REDUNDANCY@10': 0.423322, 'ILD_GENRE@10': 0.807075}.
