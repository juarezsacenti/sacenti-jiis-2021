2021-03-02 09:40:33,619 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 256,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 24363,
    "embedding_size": 100,
    "eval_interval_steps": 4873,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transh-1614688833",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/ml1m-transe-pretrained.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transh",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": null,
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 487300,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-03-02 09:40:33,675 - root - INFO - Totally 6832 train triples, 821,1625 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/cao-format/ml1m/kg/test.dat!
2021-03-02 09:40:33,680 - root - INFO - successfully load 3860 entities and 3 relations!
2021-03-02 09:40:33,691 - root - INFO - Building model.
2021-03-02 09:40:34,990 - root - INFO - Architecture: TransHModel(
  (ent_embeddings): Embedding(3860, 100)
  (rel_embeddings): Embedding(3, 100)
  (norm_embeddings): Embedding(3, 100)
)
2021-03-02 09:40:34,990 - root - INFO - Total params: 386600.0
2021-03-02 09:40:34,990 - root - INFO - One epoch is 27 steps.
2021-03-02 09:40:34,991 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-03-02 09:40:34,995 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp1/ml-sun_ho_sKG_ig-mv-complex-50/ml1m-transe-pretrained.ckpt.
2021-03-02 09:40:34,995 - root - INFO - Training.
2021-03-02 09:40:34,995 - root - INFO - train loss:0.0000!
2021-03-02 09:40:36,622 - root - INFO - head hit:0.1559, head mean rank:730.0840, topn:10.
2021-03-02 09:40:36,623 - root - INFO - tail hit:0.4080, tail mean rank:391.1547, topn:10.
2021-03-02 09:40:36,623 - root - INFO - avg hit:0.2820, avg mean rank:560.6194, topn:10.
2021-03-02 09:40:39,528 - root - INFO - head hit:0.1637, head mean rank:699.1828, topn:10.
2021-03-02 09:40:39,528 - root - INFO - tail hit:0.4203, tail mean rank:366.3120, topn:10.
2021-03-02 09:40:39,528 - root - INFO - avg hit:0.2920, avg mean rank:532.7474, topn:10.
2021-03-02 09:41:11,271 - root - INFO - train loss:0.0268!
2021-03-02 09:41:12,957 - root - INFO - head hit:0.1157, head mean rank:717.2351, topn:10.
2021-03-02 09:41:12,957 - root - INFO - tail hit:0.3337, tail mean rank:408.2180, topn:10.
2021-03-02 09:41:12,958 - root - INFO - avg hit:0.2247, avg mean rank:562.7266, topn:10.
2021-03-02 09:41:15,989 - root - INFO - head hit:0.1126, head mean rank:702.6388, topn:10.
2021-03-02 09:41:15,989 - root - INFO - tail hit:0.3446, tail mean rank:395.4683, topn:10.
2021-03-02 09:41:15,990 - root - INFO - avg hit:0.2286, avg mean rank:549.0535, topn:10.
2021-03-02 09:41:15,991 - root - INFO - Checkpointing ...
2021-03-02 09:41:47,655 - root - INFO - train loss:0.0846!
2021-03-02 09:41:49,200 - root - INFO - head hit:0.1084, head mean rank:722.4117, topn:10.
2021-03-02 09:41:49,201 - root - INFO - tail hit:0.3374, tail mean rank:427.0195, topn:10.
2021-03-02 09:41:49,201 - root - INFO - avg hit:0.2229, avg mean rank:574.7156, topn:10.
2021-03-02 09:41:52,092 - root - INFO - head hit:0.1046, head mean rank:711.9440, topn:10.
2021-03-02 09:41:52,093 - root - INFO - tail hit:0.3452, tail mean rank:395.4665, topn:10.
2021-03-02 09:41:52,093 - root - INFO - avg hit:0.2249, avg mean rank:553.7052, topn:10.
2021-03-02 09:41:52,095 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 09:42:26,393 - root - INFO - train loss:0.0342!
2021-03-02 09:42:28,000 - root - INFO - head hit:0.1437, head mean rank:697.0987, topn:10.
2021-03-02 09:42:28,000 - root - INFO - tail hit:0.3496, tail mean rank:411.3971, topn:10.
2021-03-02 09:42:28,000 - root - INFO - avg hit:0.2467, avg mean rank:554.2479, topn:10.
2021-03-02 09:42:30,852 - root - INFO - head hit:0.1403, head mean rank:692.3138, topn:10.
2021-03-02 09:42:30,852 - root - INFO - tail hit:0.3618, tail mean rank:377.3391, topn:10.
2021-03-02 09:42:30,853 - root - INFO - avg hit:0.2511, avg mean rank:534.8265, topn:10.
2021-03-02 09:42:30,854 - root - INFO - Checkpointing ...
2021-03-02 09:43:03,525 - root - INFO - train loss:0.0173!
2021-03-02 09:43:05,175 - root - INFO - head hit:0.1328, head mean rank:706.6492, topn:10.
2021-03-02 09:43:05,176 - root - INFO - tail hit:0.3691, tail mean rank:390.0962, topn:10.
2021-03-02 09:43:05,176 - root - INFO - avg hit:0.2509, avg mean rank:548.3727, topn:10.
2021-03-02 09:43:08,060 - root - INFO - head hit:0.1440, head mean rank:694.8763, topn:10.
2021-03-02 09:43:08,061 - root - INFO - tail hit:0.3717, tail mean rank:368.7428, topn:10.
2021-03-02 09:43:08,061 - root - INFO - avg hit:0.2578, avg mean rank:531.8095, topn:10.
2021-03-02 09:43:08,063 - root - INFO - Checkpointing ...
2021-03-02 09:43:41,754 - root - INFO - train loss:0.0133!
2021-03-02 09:43:43,360 - root - INFO - head hit:0.1547, head mean rank:693.5262, topn:10.
2021-03-02 09:43:43,361 - root - INFO - tail hit:0.3764, tail mean rank:393.1973, topn:10.
2021-03-02 09:43:43,361 - root - INFO - avg hit:0.2655, avg mean rank:543.3618, topn:10.
2021-03-02 09:43:46,099 - root - INFO - head hit:0.1477, head mean rank:683.0683, topn:10.
2021-03-02 09:43:46,099 - root - INFO - tail hit:0.3735, tail mean rank:373.8258, topn:10.
2021-03-02 09:43:46,099 - root - INFO - avg hit:0.2606, avg mean rank:528.4471, topn:10.
2021-03-02 09:43:46,100 - root - INFO - Checkpointing ...
2021-03-02 09:44:19,793 - root - INFO - train loss:0.0112!
2021-03-02 09:44:21,454 - root - INFO - head hit:0.1474, head mean rank:683.9927, topn:10.
2021-03-02 09:44:21,455 - root - INFO - tail hit:0.3788, tail mean rank:377.2071, topn:10.
2021-03-02 09:44:21,455 - root - INFO - avg hit:0.2631, avg mean rank:530.5999, topn:10.
2021-03-02 09:44:24,418 - root - INFO - head hit:0.1551, head mean rank:672.1028, topn:10.
2021-03-02 09:44:24,418 - root - INFO - tail hit:0.3858, tail mean rank:368.4745, topn:10.
2021-03-02 09:44:24,419 - root - INFO - avg hit:0.2705, avg mean rank:520.2886, topn:10.
2021-03-02 09:44:24,420 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 09:44:57,045 - root - INFO - train loss:0.0059!
2021-03-02 09:44:58,692 - root - INFO - head hit:0.1583, head mean rank:697.1255, topn:10.
2021-03-02 09:44:58,692 - root - INFO - tail hit:0.3983, tail mean rank:375.6200, topn:10.
2021-03-02 09:44:58,692 - root - INFO - avg hit:0.2783, avg mean rank:536.3727, topn:10.
2021-03-02 09:45:01,540 - root - INFO - head hit:0.1686, head mean rank:676.4166, topn:10.
2021-03-02 09:45:01,540 - root - INFO - tail hit:0.4111, tail mean rank:363.1785, topn:10.
2021-03-02 09:45:01,540 - root - INFO - avg hit:0.2898, avg mean rank:519.7975, topn:10.
2021-03-02 09:45:01,541 - root - INFO - Checkpointing ...
2021-03-02 09:45:33,268 - root - INFO - train loss:0.0031!
2021-03-02 09:45:34,837 - root - INFO - head hit:0.1571, head mean rank:696.0353, topn:10.
2021-03-02 09:45:34,837 - root - INFO - tail hit:0.3971, tail mean rank:369.5518, topn:10.
2021-03-02 09:45:34,837 - root - INFO - avg hit:0.2771, avg mean rank:532.7935, topn:10.
2021-03-02 09:45:37,689 - root - INFO - head hit:0.1637, head mean rank:673.1557, topn:10.
2021-03-02 09:45:37,689 - root - INFO - tail hit:0.4086, tail mean rank:359.0972, topn:10.
2021-03-02 09:45:37,689 - root - INFO - avg hit:0.2862, avg mean rank:516.1265, topn:10.
2021-03-02 09:45:37,691 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 09:46:08,678 - root - INFO - train loss:0.0029!
2021-03-02 09:46:10,304 - root - INFO - head hit:0.1681, head mean rank:699.9074, topn:10.
2021-03-02 09:46:10,304 - root - INFO - tail hit:0.4032, tail mean rank:374.5493, topn:10.
2021-03-02 09:46:10,305 - root - INFO - avg hit:0.2856, avg mean rank:537.2284, topn:10.
2021-03-02 09:46:13,123 - root - INFO - head hit:0.1698, head mean rank:675.9668, topn:10.
2021-03-02 09:46:13,124 - root - INFO - tail hit:0.4006, tail mean rank:362.5225, topn:10.
2021-03-02 09:46:13,124 - root - INFO - avg hit:0.2852, avg mean rank:519.2446, topn:10.
2021-03-02 09:46:13,125 - root - INFO - Checkpointing ...
2021-03-02 09:46:44,463 - root - INFO - train loss:0.0020!
2021-03-02 09:46:46,046 - root - INFO - head hit:0.1657, head mean rank:694.0499, topn:10.
2021-03-02 09:46:46,046 - root - INFO - tail hit:0.3995, tail mean rank:372.0378, topn:10.
2021-03-02 09:46:46,046 - root - INFO - avg hit:0.2826, avg mean rank:533.0438, topn:10.
2021-03-02 09:46:48,982 - root - INFO - head hit:0.1680, head mean rank:675.5754, topn:10.
2021-03-02 09:46:48,982 - root - INFO - tail hit:0.4049, tail mean rank:358.8006, topn:10.
2021-03-02 09:46:48,982 - root - INFO - avg hit:0.2865, avg mean rank:517.1880, topn:10.
2021-03-02 09:46:48,983 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 09:47:20,928 - root - INFO - train loss:0.0015!
2021-03-02 09:47:22,556 - root - INFO - head hit:0.1620, head mean rank:691.2533, topn:10.
2021-03-02 09:47:22,556 - root - INFO - tail hit:0.4044, tail mean rank:370.1133, topn:10.
2021-03-02 09:47:22,557 - root - INFO - avg hit:0.2832, avg mean rank:530.6833, topn:10.
2021-03-02 09:47:25,417 - root - INFO - head hit:0.1662, head mean rank:673.7563, topn:10.
2021-03-02 09:47:25,417 - root - INFO - tail hit:0.4043, tail mean rank:357.3938, topn:10.
2021-03-02 09:47:25,417 - root - INFO - avg hit:0.2852, avg mean rank:515.5751, topn:10.
2021-03-02 09:47:25,419 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 09:47:57,273 - root - INFO - train loss:0.0011!
2021-03-02 09:47:58,970 - root - INFO - head hit:0.1632, head mean rank:692.4702, topn:10.
2021-03-02 09:47:58,970 - root - INFO - tail hit:0.4044, tail mean rank:371.3471, topn:10.
2021-03-02 09:47:58,970 - root - INFO - avg hit:0.2838, avg mean rank:531.9086, topn:10.
2021-03-02 09:48:01,940 - root - INFO - head hit:0.1674, head mean rank:675.5052, topn:10.
2021-03-02 09:48:01,941 - root - INFO - tail hit:0.4080, tail mean rank:358.1218, topn:10.
2021-03-02 09:48:01,941 - root - INFO - avg hit:0.2877, avg mean rank:516.8135, topn:10.
2021-03-02 09:48:01,943 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 09:48:35,846 - root - INFO - train loss:0.0011!
2021-03-02 09:48:37,411 - root - INFO - head hit:0.1644, head mean rank:692.8855, topn:10.
2021-03-02 09:48:37,411 - root - INFO - tail hit:0.4044, tail mean rank:371.8928, topn:10.
2021-03-02 09:48:37,411 - root - INFO - avg hit:0.2844, avg mean rank:532.3892, topn:10.
2021-03-02 09:48:40,271 - root - INFO - head hit:0.1686, head mean rank:675.3514, topn:10.
2021-03-02 09:48:40,271 - root - INFO - tail hit:0.4074, tail mean rank:358.1243, topn:10.
2021-03-02 09:48:40,272 - root - INFO - avg hit:0.2880, avg mean rank:516.7378, topn:10.
2021-03-02 09:48:40,273 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-03-02 09:49:11,507 - root - INFO - No improvement after 24363 steps. Stopping training.
