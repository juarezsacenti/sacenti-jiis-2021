2021-04-25 04:31:18,805 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 400,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 1052701,
    "embedding_size": 100,
    "eval_interval_steps": 1052699,
    "eval_only_mode": false,
    "experiment_name": "ml1m-cfkg-1619335878",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/ml1m-bprmf-pretrained2.ckpt:/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/ml1m-transe-pretrained2.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "cfkg",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 3,
    "share_embeddings": true,
    "topn": 10,
    "training_steps": 1052700,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-04-25 04:31:20,611 - root - INFO - Totally 599124 train ratings, 199708,199707 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/cao-format/ml1m/test.dat!
2021-04-25 04:31:20,618 - root - INFO - successfully load 6040 users and 3260 items!
2021-04-25 04:31:22,156 - root - INFO - Totally 218397 train triples, 31184,62378 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/cao-format/ml1m/kg/test.dat!
2021-04-25 04:31:22,164 - root - INFO - successfully load 7498 entities and 20 relations!
2021-04-25 04:31:22,379 - root - INFO - Find 2933 aligned items and entities!
2021-04-25 04:31:22,380 - root - INFO - Building model.
2021-04-25 04:31:23,807 - root - INFO - Architecture: CFKG(
  (user_embeddings): Embedding(6040, 100)
  (ent_embeddings): Embedding(7825, 100)
  (rel_embeddings): Embedding(21, 100)
  (item_embeddings): Embedding(7825, 100)
)
2021-04-25 04:31:23,807 - root - INFO - Total params: 1388600.0
2021-04-25 04:31:23,807 - root - INFO - One epoch is 2996 steps.
2021-04-25 04:31:23,808 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-04-25 04:31:23,879 - root - INFO - Restored 7498 entities from checkpoint.
2021-04-25 04:31:23,909 - root - INFO - Restored 3260 items from checkpoint.
2021-04-25 04:31:23,910 - root - INFO - Load Embeddings of user_embeddings.weight, item_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/ml1m-bprmf-pretrained2.ckpt.
2021-04-25 04:31:23,910 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-04-25 04:31:23,914 - root - INFO - Restored 20 relations from checkpoint.
2021-04-25 04:31:23,981 - root - INFO - Restored 7498 entities from checkpoint.
2021-04-25 04:31:24,010 - root - INFO - Restored 3260 items from checkpoint.
2021-04-25 04:31:24,010 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-mv-complex-25/ml1m-transe-pretrained2.ckpt.
2021-04-25 04:31:24,010 - root - INFO - Training.
2021-04-25 04:31:24,011 - root - INFO - rec train loss:0.0000, kg train loss:0.0000!
2021-04-25 04:31:32,625 - root - INFO - f1:0.0052, p:0.0141, r:0.0040, hit:0.1214, ndcg:0.0642, topn:10.
2021-04-25 04:31:40,888 - root - INFO - f1:0.0047, p:0.0130, r:0.0037, hit:0.1126, ndcg:0.0602, topn:10.
2021-04-25 04:32:14,792 - root - INFO - head hit:0.0089, head mean rank:2791.6825, topn:10.
2021-04-25 04:32:14,792 - root - INFO - tail hit:0.0320, tail mean rank:2146.3138, topn:10.
2021-04-25 04:32:14,792 - root - INFO - avg hit:0.0204, avg mean rank:2468.9982, topn:10.
2021-04-25 04:33:02,777 - root - INFO - head hit:0.0087, head mean rank:2815.5164, topn:10.
2021-04-25 04:33:02,777 - root - INFO - tail hit:0.0306, tail mean rank:2155.1177, topn:10.
2021-04-25 04:33:02,777 - root - INFO - avg hit:0.0197, avg mean rank:2485.3171, topn:10.
2021-04-25 08:01:22,552 - root - INFO - rec train loss:6.2423, kg train loss:24.3237!
2021-04-25 08:01:30,776 - root - INFO - f1:0.1095, p:0.2439, r:0.0911, hit:0.7705, ndcg:0.5371, topn:10.
2021-04-25 08:01:39,932 - root - INFO - f1:0.1056, p:0.2407, r:0.0891, hit:0.7500, ndcg:0.5238, topn:10.
2021-04-25 08:02:10,896 - root - INFO - head hit:0.1145, head mean rank:564.6247, topn:10.
2021-04-25 08:02:10,897 - root - INFO - tail hit:0.1952, tail mean rank:474.8828, topn:10.
2021-04-25 08:02:10,897 - root - INFO - avg hit:0.1549, avg mean rank:519.7538, topn:10.
2021-04-25 08:02:54,587 - root - INFO - head hit:0.1170, head mean rank:559.3585, topn:10.
2021-04-25 08:02:54,587 - root - INFO - tail hit:0.1967, tail mean rank:465.4250, topn:10.
2021-04-25 08:02:54,587 - root - INFO - avg hit:0.1568, avg mean rank:512.3917, topn:10.
2021-04-25 08:02:54,617 - root - INFO - Checkpointing ...
2021-04-25 08:03:07,976 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.243791, 'RECALL@10': 0.090967, 'NDCG@10': 0.537195, 'MAP@10': 0.427923, 'MAP': 0.427923}.
2021-04-25 08:03:20,719 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.240756, 'RECALL@10': 0.089059, 'NDCG@10': 0.524172, 'MAP@10': 0.414752, 'MAP': 0.414752}.
