2021-04-22 09:48:45,960 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 1024,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_oKG/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_oKG/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 137201,
    "embedding_size": 100,
    "eval_interval_steps": 137199,
    "eval_only_mode": false,
    "experiment_name": "ml1m-transup-1619095725",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 0.5,
    "kg_test_files": null,
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_oKG/ml1m-bprmf-pretrained2.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_oKG/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transup",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 20,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 3,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 137200,
    "use_st_gumbel": true,
    "visualization_port": 8097
}
2021-04-22 09:48:47,640 - root - INFO - Totally 599124 train ratings, 199708,199707 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_oKG/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_oKG/cao-format/ml1m/test.dat!
2021-04-22 09:48:47,648 - root - INFO - successfully load 6040 users and 3260 items!
2021-04-22 09:48:48,145 - root - INFO - Building model.
2021-04-22 09:48:49,637 - root - INFO - Architecture: TransUPModel(
  (user_embeddings): Embedding(6040, 100)
  (item_embeddings): Embedding(3260, 100)
  (pref_embeddings): Embedding(20, 100)
  (pref_norm_embeddings): Embedding(20, 100)
)
2021-04-22 09:48:49,637 - root - INFO - Total params: 934000.0
2021-04-22 09:48:49,637 - root - INFO - One epoch is 586 steps.
2021-04-22 09:48:49,638 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-04-22 09:48:49,643 - root - INFO - Load Embeddings of user_embeddings.weight, item_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_oKG/ml1m-bprmf-pretrained2.ckpt.
2021-04-22 09:48:49,644 - root - INFO - Training.
2021-04-22 09:48:49,644 - root - INFO - train loss:0.0000!
2021-04-22 09:49:00,067 - root - INFO - f1:0.0321, p:0.1032, r:0.0221, hit:0.4056, ndcg:0.2511, topn:10.
2021-04-22 09:49:10,112 - root - INFO - f1:0.0316, p:0.1032, r:0.0218, hit:0.4028, ndcg:0.2488, topn:10.
2021-04-22 11:03:49,104 - root - INFO - train loss:7.4288!
2021-04-22 11:03:59,515 - root - INFO - f1:0.1607, p:0.3304, r:0.1379, hit:0.8727, ndcg:0.6228, topn:10.
2021-04-22 11:04:09,162 - root - INFO - f1:0.1562, p:0.3252, r:0.1378, hit:0.8564, ndcg:0.6119, topn:10.
2021-04-22 11:04:09,186 - root - INFO - Checkpointing ...
2021-04-22 11:04:22,940 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.32952, 'RECALL@10': 0.13641, 'NDCG@10': 0.620781, 'MAP@10': 0.502591, 'MAP': 0.502591}.
2021-04-22 11:04:37,075 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.324573, 'RECALL@10': 0.137326, 'NDCG@10': 0.611425, 'MAP@10': 0.497731, 'MAP': 0.497731}.
