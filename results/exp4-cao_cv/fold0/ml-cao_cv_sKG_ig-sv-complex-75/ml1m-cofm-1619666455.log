2021-04-29 00:20:55,484 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 400,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 1052701,
    "embedding_size": 100,
    "eval_interval_steps": 1052699,
    "eval_only_mode": false,
    "experiment_name": "ml1m-cofm-1619666455",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/ml1m-fm-pretrained.ckpt:/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/ml1m-transe-pretrained2.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "cofm",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 3,
    "share_embeddings": true,
    "topn": 10,
    "training_steps": 1052700,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-04-29 00:20:57,247 - root - INFO - Totally 599124 train ratings, 199708,199707 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/ml1m/test.dat!
2021-04-29 00:20:57,254 - root - INFO - successfully load 6040 users and 3260 items!
2021-04-29 00:20:59,109 - root - INFO - Totally 251181 train triples, 35882,71761 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/ml1m/kg/test.dat!
2021-04-29 00:20:59,121 - root - INFO - successfully load 11843 entities and 20 relations!
2021-04-29 00:20:59,372 - root - INFO - Find 2931 aligned items and entities!
2021-04-29 00:20:59,373 - root - INFO - Building model.
2021-04-29 00:21:01,097 - root - INFO - Architecture: coFM(
  (user_embeddings): Embedding(6040, 100)
  (user_bias): Embedding(6040, 1)
  (item_bias): Embedding(12172, 1)
  (rel_embeddings): Embedding(20, 100)
  (ent_embeddings): Embedding(12172, 100)
  (item_embeddings): Embedding(12172, 100)
)
2021-04-29 00:21:01,098 - root - INFO - Total params: 1841413.0
2021-04-29 00:21:01,098 - root - INFO - One epoch is 2996 steps.
2021-04-29 00:21:01,099 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-04-29 00:21:01,225 - root - INFO - Restored 11843 entities from checkpoint.
2021-04-29 00:21:01,254 - root - INFO - Restored 3260 items from checkpoint.
2021-04-29 00:21:01,324 - root - INFO - Restored 3260 items bias from checkpoint.
2021-04-29 00:21:01,324 - root - INFO - Load Embeddings of bias, user_embeddings.weight, item_embeddings.weight, user_bias.weight, item_bias.weight from /home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/ml1m-fm-pretrained.ckpt.
2021-04-29 00:21:01,324 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-04-29 00:21:01,439 - root - INFO - Restored 11843 entities from checkpoint.
2021-04-29 00:21:01,468 - root - INFO - Restored 3260 items from checkpoint.
2021-04-29 00:21:01,469 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/ml1m-transe-pretrained2.ckpt.
2021-04-29 00:21:01,469 - root - INFO - Training.
2021-04-29 00:21:01,469 - root - INFO - rec train loss:0.0000, kg train loss:0.0000!
2021-04-29 00:21:10,061 - root - INFO - f1:0.0739, p:0.1568, r:0.0635, hit:0.6753, ndcg:0.4235, topn:10.
2021-04-29 00:21:17,802 - root - INFO - f1:0.0712, p:0.1531, r:0.0630, hit:0.6515, ndcg:0.4077, topn:10.
2021-04-29 00:22:17,706 - root - INFO - head hit:0.0119, head mean rank:4789.7332, topn:10.
2021-04-29 00:22:17,707 - root - INFO - tail hit:0.0294, tail mean rank:3876.0374, topn:10.
2021-04-29 00:22:17,707 - root - INFO - avg hit:0.0206, avg mean rank:4332.8853, topn:10.
2021-04-29 00:23:44,074 - root - INFO - head hit:0.0112, head mean rank:4765.0806, topn:10.
2021-04-29 00:23:44,074 - root - INFO - tail hit:0.0301, tail mean rank:3876.7643, topn:10.
2021-04-29 00:23:44,074 - root - INFO - avg hit:0.0207, avg mean rank:4320.9224, topn:10.
2021-04-29 03:53:36,131 - root - INFO - rec train loss:4.6689, kg train loss:18.2646!
2021-04-29 03:53:43,931 - root - INFO - f1:0.1299, p:0.2889, r:0.1072, hit:0.8061, ndcg:0.5559, topn:10.
2021-04-29 03:53:52,196 - root - INFO - f1:0.1254, p:0.2842, r:0.1048, hit:0.7831, ndcg:0.5441, topn:10.
2021-04-29 03:54:43,236 - root - INFO - head hit:0.1569, head mean rank:730.3348, topn:10.
2021-04-29 03:54:43,236 - root - INFO - tail hit:0.2215, tail mean rank:706.7306, topn:10.
2021-04-29 03:54:43,237 - root - INFO - avg hit:0.1892, avg mean rank:718.5327, topn:10.
2021-04-29 03:55:53,735 - root - INFO - head hit:0.1566, head mean rank:711.5419, topn:10.
2021-04-29 03:55:53,735 - root - INFO - tail hit:0.2245, tail mean rank:677.2574, topn:10.
2021-04-29 03:55:53,735 - root - INFO - avg hit:0.1905, avg mean rank:694.3997, topn:10.
2021-04-29 03:55:53,773 - root - INFO - Checkpointing ...
2021-04-29 03:56:05,395 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.28894, 'RECALL@10': 0.107256, 'NDCG@10': 0.555921, 'MAP@10': 0.441368, 'MAP': 0.441368}.
2021-04-29 03:56:17,831 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.284082, 'RECALL@10': 0.10474, 'NDCG@10': 0.544118, 'MAP@10': 0.434419, 'MAP': 0.434419}.
