2021-04-28 12:39:34,298 - root - INFO - Flag Values:
{
    "L1_flag": true,
    "batch_size": 400,
    "ckpt_path": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/",
    "clipping_max_value": 5.0,
    "data_path": "/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/",
    "dataset": "ml1m",
    "early_stopping_steps_to_wait": 1052701,
    "embedding_size": 100,
    "eval_interval_steps": 1052699,
    "eval_only_mode": false,
    "experiment_name": "ml1m-cfkg-1619624374",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 0.0,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/ml1m-bprmf-pretrained2.ckpt:/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/ml1m-transe-pretrained2.ckpt",
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "/home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "cfkg",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 4,
    "num_processes": 4,
    "optimizer_type": "Adam",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 3,
    "share_embeddings": true,
    "topn": 10,
    "training_steps": 1052700,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-04-28 12:39:36,083 - root - INFO - Totally 599124 train ratings, 199708,199707 eval ratings in files: /home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/ml1m/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/ml1m/test.dat!
2021-04-28 12:39:36,090 - root - INFO - successfully load 6040 users and 3260 items!
2021-04-28 12:39:37,901 - root - INFO - Totally 251181 train triples, 35882,71761 eval triples in files: /home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/ml1m/kg/valid.dat;/home/juarez/git/datasets/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/cao-format/ml1m/kg/test.dat!
2021-04-28 12:39:37,913 - root - INFO - successfully load 11843 entities and 20 relations!
2021-04-28 12:39:38,166 - root - INFO - Find 2931 aligned items and entities!
2021-04-28 12:39:38,166 - root - INFO - Building model.
2021-04-28 12:39:39,694 - root - INFO - Architecture: CFKG(
  (user_embeddings): Embedding(6040, 100)
  (ent_embeddings): Embedding(12172, 100)
  (rel_embeddings): Embedding(21, 100)
  (item_embeddings): Embedding(12172, 100)
)
2021-04-28 12:39:39,694 - root - INFO - Total params: 1823300.0
2021-04-28 12:39:39,694 - root - INFO - One epoch is 2996 steps.
2021-04-28 12:39:39,695 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-04-28 12:39:39,808 - root - INFO - Restored 11843 entities from checkpoint.
2021-04-28 12:39:39,837 - root - INFO - Restored 3260 items from checkpoint.
2021-04-28 12:39:39,838 - root - INFO - Load Embeddings of user_embeddings.weight, item_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/ml1m-bprmf-pretrained2.ckpt.
2021-04-28 12:39:39,838 - root - INFO - Found checkpoint, restoring pre-trained embeddings.
2021-04-28 12:39:39,845 - root - INFO - Restored 20 relations from checkpoint.
2021-04-28 12:39:39,954 - root - INFO - Restored 11843 entities from checkpoint.
2021-04-28 12:39:39,984 - root - INFO - Restored 3260 items from checkpoint.
2021-04-28 12:39:39,984 - root - INFO - Load Embeddings of ent_embeddings.weight, rel_embeddings.weight from /home/juarez/git/results/JIIS-revised-exp4/fold0/ml-cao_cv_sKG_ig-sv-complex-75/ml1m-transe-pretrained2.ckpt.
2021-04-28 12:39:39,984 - root - INFO - Training.
2021-04-28 12:39:39,984 - root - INFO - rec train loss:0.0000, kg train loss:0.0000!
2021-04-28 12:39:48,685 - root - INFO - f1:0.0042, p:0.0114, r:0.0035, hit:0.0997, ndcg:0.0486, topn:10.
2021-04-28 12:39:56,475 - root - INFO - f1:0.0038, p:0.0107, r:0.0031, hit:0.0947, ndcg:0.0463, topn:10.
2021-04-28 12:40:56,034 - root - INFO - head hit:0.0119, head mean rank:4789.7332, topn:10.
2021-04-28 12:40:56,035 - root - INFO - tail hit:0.0294, tail mean rank:3876.0374, topn:10.
2021-04-28 12:40:56,035 - root - INFO - avg hit:0.0206, avg mean rank:4332.8853, topn:10.
2021-04-28 12:42:19,954 - root - INFO - head hit:0.0112, head mean rank:4765.0806, topn:10.
2021-04-28 12:42:19,954 - root - INFO - tail hit:0.0301, tail mean rank:3876.7643, topn:10.
2021-04-28 12:42:19,954 - root - INFO - avg hit:0.0207, avg mean rank:4320.9224, topn:10.
2021-04-28 16:04:56,676 - root - INFO - rec train loss:4.8197, kg train loss:18.6696!
2021-04-28 16:05:04,946 - root - INFO - f1:0.1123, p:0.2499, r:0.0932, hit:0.7773, ndcg:0.5382, topn:10.
2021-04-28 16:05:13,739 - root - INFO - f1:0.1096, p:0.2470, r:0.0931, hit:0.7596, ndcg:0.5276, topn:10.
2021-04-28 16:06:02,853 - root - INFO - head hit:0.1509, head mean rank:719.7427, topn:10.
2021-04-28 16:06:02,853 - root - INFO - tail hit:0.2191, tail mean rank:700.3158, topn:10.
2021-04-28 16:06:02,853 - root - INFO - avg hit:0.1850, avg mean rank:710.0292, topn:10.
2021-04-28 16:07:12,816 - root - INFO - head hit:0.1537, head mean rank:701.6646, topn:10.
2021-04-28 16:07:12,816 - root - INFO - tail hit:0.2212, tail mean rank:679.0126, topn:10.
2021-04-28 16:07:12,816 - root - INFO - avg hit:0.1875, avg mean rank:690.3386, topn:10.
2021-04-28 16:07:12,851 - root - INFO - Checkpointing ...
2021-04-28 16:07:25,188 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.250033, 'RECALL@10': 0.093127, 'NDCG@10': 0.538525, 'MAP@10': 0.425439, 'MAP': 0.425439}.
2021-04-28 16:07:37,534 - root - INFO - From CaseRecommender evaluator: {'PREC@10': 0.247024, 'RECALL@10': 0.093148, 'NDCG@10': 0.527502, 'MAP@10': 0.416432, 'MAP': 0.416432}.
